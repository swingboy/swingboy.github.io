<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>swing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="æè¿°">
<meta property="og:type" content="website">
<meta property="og:title" content="swing">
<meta property="og:url" content="http://swingboy.github.io/page/2/index.html">
<meta property="og:site_name" content="swing">
<meta property="og:description" content="æè¿°">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="swing">
<meta name="twitter:description" content="æè¿°">
  
    <link rel="alternate" href="/atom.xml" title="swing" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">swing</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://swingboy.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-React-v16-4-0-äº‹ä»¶åŸç†" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/26/React-v16-4-0-äº‹ä»¶åŸç†/" class="article-date">
  <time datetime="2018-07-26T10:54:20.000Z" itemprop="datePublished">2018-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/26/React-v16-4-0-äº‹ä»¶åŸç†/">React v16.4.0 äº‹ä»¶åŸç†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ï¼ˆé’ˆå¯¹v16.4.0ï¼‰</p>
<h3 id="åŸç”Ÿäº‹ä»¶ç³»ç»Ÿ"><a href="#åŸç”Ÿäº‹ä»¶ç³»ç»Ÿ" class="headerlink" title="åŸç”Ÿäº‹ä»¶ç³»ç»Ÿ"></a>åŸç”Ÿäº‹ä»¶ç³»ç»Ÿ</h3><p>æˆ‘ä»¬é€šå¸¸ç›‘å¬çœŸå®DOMã€‚ä¸¾ğŸŒ°æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³ç›‘å¬æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æŒ‰é’®DOMä¸Šç»‘å®šäº‹ä»¶å’Œå¯¹åº”çš„å›è°ƒå‡½æ•°å³å¯ã€‚</p>
<blockquote>
<p>é—æ†¾çš„æ˜¯è‹¥é¡µé¢å¤æ‚ä¸”äº‹ä»¶å¤„ç†é¢‘ç‡é«˜ï¼Œé‚£ä¹ˆå¯¹ç½‘é¡µæ€§èƒ½æ˜¯ä¸ªè€ƒéªŒã€‚</p>
</blockquote>
<h3 id="Reactäº‹ä»¶ç³»ç»Ÿ"><a href="#Reactäº‹ä»¶ç³»ç»Ÿ" class="headerlink" title="Reactäº‹ä»¶ç³»ç»Ÿ"></a>Reactäº‹ä»¶ç³»ç»Ÿ</h3><p>reactçš„äº‹ä»¶å¤„ç†å†çœ¼èŠ±ç¼­ä¹±ç»ˆç©¶è¿˜æ˜¯è¦å›å½’åŸç”Ÿçš„äº‹ä»¶ç³»ç»Ÿã€‚</p>
<h3 id="reactäº‹ä»¶ç»‘å®š"><a href="#reactäº‹ä»¶ç»‘å®š" class="headerlink" title="reactäº‹ä»¶ç»‘å®š"></a>reactäº‹ä»¶ç»‘å®š</h3><p>react ä¸­çš„äº‹ä»¶æ˜¯æ ¹æ® nativeEvent å¯¹è±¡ä¿®æ”¹åçš„åˆæˆå¯¹è±¡ï¼Œå¯¹äºäº‹ä»¶é‡‡ç”¨äº‹ä»¶å§”æ‰˜ï¼Œå°†äº‹ä»¶ç»‘å®šåœ¨é¡¶å±‚ document å¯¹è±¡ä¸Šã€‚å¯¹äºå…¨å±€ dom å…ƒç´ ä¸­æ‰€æ¶‰åŠçš„äº‹ä»¶ï¼Œ react éƒ½ä¼šå¤„ç†ã€‚å¯¹äºå†’æ³¡äº‹ä»¶ï¼Œæ˜¯åœ¨ document å¯¹è±¡çš„å†’æ³¡é˜¶æ®µè§¦å‘ã€‚å¯¹äºéå†’æ³¡äº‹ä»¶ï¼Œæ˜¯åœ¨ document å¯¹è±¡çš„æ•è·é˜¶æ®µè§¦å‘ã€‚æœ€ååœ¨ dispatchEvent ä¸­å†³å®šçœŸæ­£å›è°ƒå‡½æ•°çš„æ‰§è¡Œã€‚</p>
<h3 id="åˆæˆäº‹ä»¶"><a href="#åˆæˆäº‹ä»¶" class="headerlink" title="åˆæˆäº‹ä»¶"></a>åˆæˆäº‹ä»¶</h3><p>äº‹ä»¶å¤„ç†ç¨‹åºé€šè¿‡ åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰çš„å®ä¾‹ä¼ é€’ï¼ŒSyntheticEvent æ˜¯æµè§ˆå™¨åŸç”Ÿäº‹ä»¶è·¨æµè§ˆå™¨çš„å°è£…ã€‚SyntheticEvent å’Œæµè§ˆå™¨åŸç”Ÿäº‹ä»¶ä¸€æ ·æœ‰ stopPropagation()ã€preventDefault() æ¥å£ï¼Œè€Œä¸”è¿™äº›æ¥å£å¤¸æµè§ˆå™¨å…¼å®¹ã€‚</p>
<p>å¦‚æœå‡ºäºæŸäº›åŸå› æƒ³ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ nativeEvent å±æ€§è·å–ã€‚æ¯ä¸ªå’Œæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰å¯¹è±¡éƒ½æœ‰ä»¥ä¸‹å±æ€§ï¼š</p>
<p>boolean bubbles<br>boolean cancelable<br>DOMEventTarget currentTarget<br>boolean defaultPrevented<br>Number eventPhase<br>boolean isTrusted<br>DOMEvent nativeEvent<br>void preventDefault()<br>void stopPropagation()<br>DOMEventTarget target<br>Date timeStamp<br>String type</p>
<p>Reactå®ç°äº†SyntheticEventå±‚å¤„ç†äº‹ä»¶</p>
<p>è¯¦ç»†æ¥è¯´ï¼ŒReactå¹¶ä¸åƒåŸç”Ÿäº‹ä»¶ä¸€æ ·å°†äº‹ä»¶å’ŒDOMä¸€ä¸€å¯¹åº”ï¼Œè€Œæ˜¯å°†æ‰€æœ‰çš„äº‹ä»¶éƒ½ç»‘å®šåœ¨ç½‘é¡µçš„documentï¼Œé€šè¿‡ç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬å™¨å¤„ç†å¹¶åˆ†å‘ï¼Œæ‰¾åˆ°å¯¹åº”çš„å›è°ƒå‡½æ•°å¹¶æ‰§è¡Œã€‚æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºå°†ä¼ é€’SyntheticEventçš„å®ä¾‹ã€‚</p>
<h3 id="reactæå‡ºç»Ÿä¸€äº‹ä»¶å¤„ç†çš„ç›®çš„ä¸»è¦æ˜¯ï¼š"><a href="#reactæå‡ºç»Ÿä¸€äº‹ä»¶å¤„ç†çš„ç›®çš„ä¸»è¦æ˜¯ï¼š" class="headerlink" title="reactæå‡ºç»Ÿä¸€äº‹ä»¶å¤„ç†çš„ç›®çš„ä¸»è¦æ˜¯ï¼š"></a>reactæå‡ºç»Ÿä¸€äº‹ä»¶å¤„ç†çš„ç›®çš„ä¸»è¦æ˜¯ï¼š</h3><p>1.æµè§ˆå™¨å…¼å®¹æ€§<br>2.æ”¹å–„æ€§èƒ½<br>åœ¨å¤æ‚çš„UIç³»ç»Ÿä¸­ï¼Œè¶Šå¤šçš„äº‹ä»¶å¤„ç†æ„å‘³ç€åº”ç”¨éœ€è¦æ¶ˆè€—çš„å†…å­˜è¶Šå¤šã€‚æ‰‹åŠ¨è§£å†³è¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯å¾ˆéº»çƒ¦ï¼Œä½†æ˜¯åœ¨å†—é•¿çš„è¿‡ç¨‹ä¸­ï¼Œä½ éœ€è¦å°è¯•å»ç»™åœ¨æ¥æºäºåŒä¸€ä¸ªçˆ¶èŠ‚ç‚¹çš„äº‹ä»¶è¿›è¡Œåˆ†ç»„ã€‚å¾ˆéš¾æƒè¡¡ã€‚è€ŒReactå°±å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚<br>Reactä¸æ˜¯ç›´æ¥çš„å°†äº‹ä»¶æŒ‚åœ¨domä¸Šï¼Œå®ƒåœ¨documentçš„æ ¹éƒ¨ç”¨ä¸€ä¸ªäº‹ä»¶å¤„ç†å»ç›‘å¬å’Œè°ƒç”¨ç›¸åº”çš„äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * Overview of React and the event system:</span><br><span class="line"> *</span><br><span class="line"> * +------------+    .</span><br><span class="line"> * |    DOM     |    .</span><br><span class="line"> * +------------+    .</span><br><span class="line"> *       |           .</span><br><span class="line"> *       v           .</span><br><span class="line"> * +------------+    .</span><br><span class="line"> * | ReactEvent |    .</span><br><span class="line"> * |  Listener  |    .</span><br><span class="line"> * +------------+    .                         +-----------+</span><br><span class="line"> *       |           .               +--------+|SimpleEvent|</span><br><span class="line"> *       |           .               |         |Plugin     |</span><br><span class="line"> * +-----|------+    .               v         +-----------+</span><br><span class="line"> * |     |      |    .    +--------------+                    +------------+</span><br><span class="line"> * |     +-----------.---&gt;|EventPluginHub|                    |    Event   |</span><br><span class="line"> * |            |    .    |              |     +-----------+  | Propagators|</span><br><span class="line"> * | ReactEvent |    .    |              |     |TapEvent   |  |------------|</span><br><span class="line"> * |  Emitter   |    .    |              |&lt;---+|Plugin     |  |other plugin|</span><br><span class="line"> * |            |    .    |              |     +-----------+  |  utilities |</span><br><span class="line"> * |     +-----------.---&gt;|              |                    +------------+</span><br><span class="line"> * |     |      |    .    +--------------+</span><br><span class="line"> * +-----|------+    .                ^        +-----------+</span><br><span class="line"> *       |           .                |        |Enter/Leave|</span><br><span class="line"> *       +           .                +-------+|Plugin     |</span><br><span class="line"> * +-------------+   .                         +-----------+</span><br><span class="line"> * | application |   .</span><br><span class="line"> * |-------------|   .</span><br><span class="line"> * |             |   .</span><br><span class="line"> * |             |   .</span><br><span class="line"> * +-------------+   .</span><br><span class="line"> *                   .</span><br><span class="line"> *    React Core     .  General Purpose Event Plugin System</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<h4 id="SyntheticEvent"><a href="#SyntheticEvent" class="headerlink" title="SyntheticEvent"></a>SyntheticEvent</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * @param &#123;object&#125; dispatchConfig Configuration used to dispatch this event.</span><br><span class="line"> * @param &#123;*&#125; targetInst Marker identifying the event target.</span><br><span class="line"> * @param &#123;object&#125; nativeEvent Native browser event.</span><br><span class="line"> * @param &#123;DOMEventTarget&#125; nativeEventTarget Target node.</span><br><span class="line">* /</span><br><span class="line">function SyntheticEvent(dispatchConfig, targetInst, nativeEvent, nativeEventTarget) &#123;</span><br><span class="line"></span><br><span class="line">  this.dispatchConfig = dispatchConfig;</span><br><span class="line">  this._targetInst = targetInst;</span><br><span class="line">  this.nativeEvent = nativeEvent;</span><br><span class="line"></span><br><span class="line">  var Interface = this.constructor.Interface;</span><br><span class="line">  for (var propName in Interface) &#123;</span><br><span class="line">    if (!Interface.hasOwnProperty(propName)) &#123;</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line">    var normalize = Interface[propName];</span><br><span class="line">    if (normalize) &#123;</span><br><span class="line">      this[propName] = normalize(nativeEvent);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      if (propName === &apos;target&apos;) &#123;</span><br><span class="line">        this.target = nativeEventTarget;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this[propName] = nativeEvent[propName];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var defaultPrevented = nativeEvent.defaultPrevented != null ? nativeEvent.defaultPrevented : nativeEvent.returnValue === false;</span><br><span class="line">  if (defaultPrevented) &#123;</span><br><span class="line">    this.isDefaultPrevented = emptyFunction.thatReturnsTrue;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    this.isDefaultPrevented = emptyFunction.thatReturnsFalse;</span><br><span class="line">  &#125;</span><br><span class="line">  this.isPropagationStopped = emptyFunction.thatReturnsFalse;</span><br><span class="line">  return this;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_assign(SyntheticEvent.prototype, &#123;</span><br><span class="line">  preventDefault: function () &#123;</span><br><span class="line">    this.defaultPrevented = true;</span><br><span class="line">    var event = this.nativeEvent;</span><br><span class="line">    if (!event) &#123;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (event.preventDefault) &#123;</span><br><span class="line">      event.preventDefault();</span><br><span class="line">    &#125; else if (typeof event.returnValue !== &apos;unknown&apos;) &#123;</span><br><span class="line">      event.returnValue = false;</span><br><span class="line">    &#125;</span><br><span class="line">    this.isDefaultPrevented = emptyFunction.thatReturnsTrue;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  stopPropagation: function () &#123;</span><br><span class="line">    var event = this.nativeEvent;</span><br><span class="line">    if (!event) &#123;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (event.stopPropagation) &#123;</span><br><span class="line">      event.stopPropagation();</span><br><span class="line">    &#125; else if (typeof event.cancelBubble !== &apos;unknown&apos;) &#123;</span><br><span class="line">      event.cancelBubble = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    this.isPropagationStopped = emptyFunction.thatReturnsTrue;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  destructor: function () &#123;</span><br><span class="line">    var Interface = this.constructor.Interface;</span><br><span class="line">    for (var propName in Interface) &#123;</span><br><span class="line">      &#123;</span><br><span class="line">        Object.defineProperty(this, propName, getPooledWarningPropertyDefinition(propName, Interface[propName]));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for (var i = 0; i &lt; shouldBeReleasedProperties.length; i++) &#123;</span><br><span class="line">      this[shouldBeReleasedProperties[i]] = null;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">SyntheticEvent.Interface = EventInterface;</span><br><span class="line"></span><br><span class="line">æ–°å»ºäº‹ä»¶å¯¹è±¡æ—¶ï¼Œä¼šé‡å†™stopPropagationï¼ˆé˜»æ­¢å†’æ³¡ï¼‰ å’Œ preventDefaultï¼ˆé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼‰è¿™æ ·çš„åŸç”Ÿäº‹ä»¶ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//æˆ‘ä»¬æ‰€ç†ŸçŸ¥äº‹ä»¶æ¥å£ ï¼ŒnativeEventå¯¹è±¡å±æ€§</span><br><span class="line">var EventInterface = &#123;</span><br><span class="line">  type: null,</span><br><span class="line">  target: null,</span><br><span class="line">  currentTarget: emptyFunction.thatReturnsNull,</span><br><span class="line">  eventPhase: null,</span><br><span class="line">  bubbles: null,</span><br><span class="line">  cancelable: null,</span><br><span class="line">  timeStamp: function (event) &#123;</span><br><span class="line">    return event.timeStamp || Date.now();</span><br><span class="line">  &#125;,</span><br><span class="line">  defaultPrevented: null,</span><br><span class="line">  isTrusted: null</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸‹é¢çš„è¿™äº›åˆæˆå¯¹è±¡ï¼Œè¿™äº›å¯¹äºäº‹ä»¶ç±»åˆ«ä¸åŒï¼Œè€Œæœ‰ä¸åŒçš„å±æ€§<br>MouseEvent,AnimationEvent, UIEvent, InputEvent, CompositionEvent, ClipboardEvent, FocusEvent, KeyboardEvent, DragEvent, TouchEvent, TransitionEvent, WheelEventä¸Šè¿°çš„EventInterfaceåŸºç¡€ä¸Šå†æ·»åŠ </p>
<h3 id="ç®€å•çœ‹ä¸‹è¿‡ç¨‹"><a href="#ç®€å•çœ‹ä¸‹è¿‡ç¨‹" class="headerlink" title="ç®€å•çœ‹ä¸‹è¿‡ç¨‹"></a>ç®€å•çœ‹ä¸‹è¿‡ç¨‹</h3><p><img src=".ç»‘å®š/imgs/.png" alt></p>
<p><img src="./imgs/è§¦å‘.png" alt></p>
<h4 id="äº‹ä»¶æ³¨å†Œ"><a href="#äº‹ä»¶æ³¨å†Œ" class="headerlink" title="äº‹ä»¶æ³¨å†Œ"></a>äº‹ä»¶æ³¨å†Œ</h4><p>äº‹ä»¶çš„ç»‘å®šåœ¨completeWorké˜¶æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">function completeWork(current, workInProgress, renderExpirationTime) &#123;</span><br><span class="line">    // ...</span><br><span class="line">    var _instance = createInstance(type, newProps, rootContainerInstance, _currentHostContext, workInProgress);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //æ¥ç€</span><br><span class="line">    if (finalizeInitialChildren(_instance, type, newProps, rootContainerInstance, _currentHostContext)) &#123;</span><br><span class="line">              markUpdate(workInProgress);</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">    //.....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function createInstance(type, props, rootContainerInstance, hostContext, internalInstanceHandle) &#123;</span><br><span class="line">  var parentNamespace = void 0;</span><br><span class="line">  &#123;</span><br><span class="line">    var hostContextDev = hostContext;</span><br><span class="line">    validateDOMNesting$1(type, null, hostContextDev.ancestorInfo);</span><br><span class="line">    if (typeof props.children === &apos;string&apos; || typeof props.children === &apos;number&apos;) &#123;</span><br><span class="line">      var string = &apos;&apos; + props.children;</span><br><span class="line">      var ownAncestorInfo = updatedAncestorInfo(hostContextDev.ancestorInfo, type, null);</span><br><span class="line">      validateDOMNesting$1(null, string, ownAncestorInfo);</span><br><span class="line">    &#125;</span><br><span class="line">    parentNamespace = hostContextDev.namespace;</span><br><span class="line">  &#125;</span><br><span class="line">  debugger;</span><br><span class="line">  var domElement = createElement(type, props, rootContainerInstance, parentNamespace);</span><br><span class="line">  precacheFiberNode$1(internalInstanceHandle, domElement);</span><br><span class="line">  updateFiberProps$1(domElement, props);</span><br><span class="line">  return domElement;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">domElementç­‰äºçœŸå®åˆ›å»ºçš„domï¼Œé‡Œé¢è°ƒç”¨çš„å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„createElementã€‚è€ŒprecacheFiberNodeå’ŒupdateFiberPropsä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«ç»™domElement(çœŸå®dom)æ·»åŠ äº†ä¸¤ä¸ªå±æ€§ã€‚æ‰€æœ‰react16é¡¹ç›®ä¸­çš„doméƒ½ä¼šæ‹¥æœ‰è¿™ä¸¤ä¸ªå±æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªä¸¤ä¸ªå±æ€§çš„å±æ€§ååœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­æ˜¯ä¸€è‡´çš„ã€‚</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">//ä¿®æ”¹å±æ€§</span><br><span class="line">function getFiberCurrentPropsFromNode$1(node) &#123;</span><br><span class="line">  return node[internalEventHandlersKey] || null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//sck æ›´æ–°å±æ€§ </span><br><span class="line">//è¿™é‡Œçš„propså°±æ˜¯ æ‰€ç»‘å®šå…ƒç´ çš„å±æ€§props</span><br><span class="line">function updateFiberProps(node, props) &#123;</span><br><span class="line">  // debugger;</span><br><span class="line">  node[internalEventHandlersKey] = props;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå‘¢ï¼Œå°±æ˜¯ç›‘å¬documentæˆ–è€…fragmentä¸Šçš„äº‹ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function ensureListeningTo(rootContainerElement, registrationName) &#123;</span><br><span class="line">  var isDocumentOrFragment = rootContainerElement.nodeType === DOCUMENT_NODE || rootContainerElement.nodeType === DOCUMENT_FRAGMENT_NODE;</span><br><span class="line">  //å°±æ˜¯document</span><br><span class="line">  var doc = isDocumentOrFragment ? rootContainerElement : rootContainerElement.ownerDocument;</span><br><span class="line">  listenTo(registrationName, doc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ensureListeningToé‡Œè°ƒç”¨listenToæ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">function listenTo(registrationName, mountAt) &#123;</span><br><span class="line">  debugger;</span><br><span class="line">  var isListening = getListeningForDocument(mountAt);</span><br><span class="line">  var dependencies = registrationNameDependencies[registrationName];</span><br><span class="line"></span><br><span class="line">  for (var i = 0; i &lt; dependencies.length; i++) &#123;</span><br><span class="line">    var dependency = dependencies[i];</span><br><span class="line">    if (!(isListening.hasOwnProperty(dependency) &amp;&amp; isListening[dependency])) &#123;</span><br><span class="line">      switch (dependency) &#123;</span><br><span class="line">        case TOP_SCROLL:</span><br><span class="line">          trapCapturedEvent(TOP_SCROLL, mountAt);</span><br><span class="line">          break;</span><br><span class="line">        case TOP_FOCUS:</span><br><span class="line">        case TOP_BLUR:</span><br><span class="line">          trapCapturedEvent(TOP_FOCUS, mountAt);</span><br><span class="line">          trapCapturedEvent(TOP_BLUR, mountAt);</span><br><span class="line">          // We set the flag for a single dependency later in this function,</span><br><span class="line">          // but this ensures we mark both as attached rather than just one.</span><br><span class="line">          isListening[TOP_BLUR] = true;</span><br><span class="line">          isListening[TOP_FOCUS] = true;</span><br><span class="line">          break;</span><br><span class="line">        case TOP_CANCEL:</span><br><span class="line">        case TOP_CLOSE:</span><br><span class="line">          if (isEventSupported(getRawEventName(dependency), true)) &#123;</span><br><span class="line">            trapCapturedEvent(dependency, mountAt);</span><br><span class="line">          &#125;</span><br><span class="line">          break;</span><br><span class="line">        case TOP_INVALID:</span><br><span class="line">        case TOP_SUBMIT:</span><br><span class="line">        case TOP_RESET:</span><br><span class="line">          break;</span><br><span class="line">        default:</span><br><span class="line">          var isMediaEvent = mediaEventTypes.indexOf(dependency) !== -1;</span><br><span class="line">          if (!isMediaEvent) &#123;</span><br><span class="line">            trapBubbledEvent(dependency, mountAt);</span><br><span class="line">          &#125;</span><br><span class="line">          break;</span><br><span class="line">      &#125;</span><br><span class="line">      isListening[dependency] = true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">åœ¨listenToä¸­è°ƒtrapBubbledEventã€‚ å…¶å®åŸ‹ç‚¹çš„ç›‘å¬çš„è¿‡ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function trapBubbledEvent(topLevelType, element) &#123;</span><br><span class="line">  if (!element) &#123;</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">  var dispatch = isInteractiveTopLevelEventType(topLevelType) ? dispatchInteractiveEvent : dispatchEvent;</span><br><span class="line"></span><br><span class="line">  // æ­¤æ—¶çš„listennerè¿˜æ˜¯åŸæ¥çš„</span><br><span class="line">  addEventBubbleListener(element, getRawEventName(topLevelType),</span><br><span class="line">  // Check if interactive and wrap in interactiveUpdates</span><br><span class="line">  dispatch.bind(null, topLevelType));</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function addEventBubbleListener(element, eventType, listener) &#123;</span><br><span class="line">  debugger;</span><br><span class="line">  element.addEventListener(eventType, listener, false);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼šcompleteWork-&gt;createInstance(æ›´æ–°å±æ€§ç­‰ç­‰)-&gt;setInitialDOMProperties-&gt;ensureListeningTo<br>-&gt;listenTo-&gt;trapBubbledEvent-&gt;addEventBubbleListenerï¼ˆè¿›è¡Œæˆ‘ä»¬ç†Ÿæ‚‰çš„addEventListenerï¼‰-&gt; commitAllHostEffects æœ€åæ¸²æŸ“å®Œæˆ</p>
<h4 id="äºŒ-äº‹ä»¶åˆæˆ"><a href="#äºŒ-äº‹ä»¶åˆæˆ" class="headerlink" title="äºŒ äº‹ä»¶åˆæˆ"></a>äºŒ äº‹ä»¶åˆæˆ</h4><p>æœ‰ç‚¹é‡åˆï¼Œé€»è¾‘æœ‰ç‚¹é‡åˆã€‚å…¶å®æ˜¯å‰åè„šçš„å…³ç³»ã€‚</p>
<p>äº‹ä»¶åˆæˆçš„è¿‡ç¨‹ï¼Œé¦–å…ˆæ ¹æ®è§¦å‘äº‹ä»¶çš„targetå¾—åˆ°instï¼Œç„¶åéå†ä»–çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹,å­˜å‚¨åœ¨å±€éƒ¨éå†pathä¸­ï¼Œè®°ä½è¿™ä¸ªpathæ˜¯æœ‰é¡ºåºå…³ç³»çš„ï¼ˆåé¢å¯ä»¥è§£é‡Šreactäº‹ä»¶æ˜¯å¦‚ä½•é˜»æ­¢å†’æ³¡çš„ï¼‰ã€‚å¾—åˆ°pathåè¿›è¡Œéå†ï¼Œå‡è®¾éå†çš„ç»„ä»¶åŒæ ·æ³¨å†Œäº†å¯¹åº”äº‹ä»¶çš„listenerï¼Œé‚£ä¹ˆå°±æŒ‚è½½åˆ°eventçš„_dispatchListenerså’Œ_dispatchInstancesä¸­å»,è¿™ä¸¤ä¸ªå±æ€§è‡³å…³é‡è¦ï¼Œåç»­çš„äº‹ä»¶æ´¾å‘å°±æ˜¯æ ¹æ®è¿™ä¸¤ä¸ªå±æ€§è¿›è¡Œçš„ã€‚ æ³¨æ„åªæœ‰æ³¨å†Œäº†å¯¹åº”äº‹ä»¶çš„listenerï¼Œæ‰ä¼šæŒ‚è½½åˆ°eventé‡Œé¢å»ã€‚æ¯”å¦‚åˆšåˆšæˆ‘ä»¬çš„ABCéƒ½ç»‘å®šäº†Clickï¼Œè‡ªç„¶éƒ½ä¼špushåˆ°_dispatchListenersä¸­å»ã€‚</p>
<h4 id="ä¸‰-äº‹ä»¶æ´¾å‘"><a href="#ä¸‰-äº‹ä»¶æ´¾å‘" class="headerlink" title="ä¸‰ äº‹ä»¶æ´¾å‘"></a>ä¸‰ äº‹ä»¶æ´¾å‘</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//callback is this func æ³¨å†Œäº‹ä»¶çš„æ—¶å€™æ˜¯listençš„è¿™ä¸ªæ–¹æ³• </span><br><span class="line">function dispatchInteractiveEvent(topLevelType, nativeEvent) &#123;</span><br><span class="line">  interactiveUpdates(dispatchEvent, topLevelType, nativeEvent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">function runExtractedEventsInBatch(topLevelType, targetInst, nativeEvent, nativeEventTarget) &#123;</span><br><span class="line">  debugger;</span><br><span class="line">  //è·å¾—æ‰€æœ‰ç»‘å®šçš„äº‹ä»¶ çœ‹ä¸‹é¢ä»£ç </span><br><span class="line">  var events = extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget);</span><br><span class="line">  runEventsInBatch(events, false);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function runEventsInBatch(events, simulated) &#123;</span><br><span class="line">  //(&apos;runEventsInBatch&apos;);</span><br><span class="line">  if (events !== null) &#123;</span><br><span class="line">    eventQueue = accumulateInto(eventQueue, events);</span><br><span class="line">  &#125;</span><br><span class="line">  .....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget) &#123;</span><br><span class="line">  var events = null;</span><br><span class="line">  for (var i = 0; i &lt; plugins.length; i++) &#123;</span><br><span class="line">    // Not every plugin in the ordering may be loaded at runtime.</span><br><span class="line">    var possiblePlugin = plugins[i];</span><br><span class="line">    if (possiblePlugin) &#123;</span><br><span class="line">      var extractedEvents = possiblePlugin.extractEvents(topLevelType, targetInst, nativeEvent, nativeEventTarget);</span><br><span class="line">      if (extractedEvents) &#123;</span><br><span class="line">        events = accumulateInto(events, extractedEvents);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  //æ­¤æ—¶çš„ event å«æœ‰_dispatchListeners å±æ€§ã€‚ã€‚ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢æœ‰ç»‘å®šçš„å›è°ƒå‡½æ•°</span><br><span class="line">  return events;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">åœ¨ runEventsInBatchè¿™é‡Œé¢å…ˆå¾—åˆ° eventQueueï¼Œä¹Ÿå°±æ˜¯ target ä¸ºåˆæˆäº‹ä»¶å¯¹è±¡çš„ proxy å¯¹è±¡ã€‚ç„¶åå¯¹æ•°ç»„å…ƒç´ æŒ¨ä¸ªè¿›è¡Œ executeDispatchesInOrderï¼Œä¹Ÿå°±æ˜¯å¯¹åˆæˆäº‹ä»¶å¯¹è±¡çš„ _dispatchListeners æŒ‰åºæ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç´§æ¥ç€~~~~~ </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//æ¥ä¸‹æ¥å°±æ˜¯è¿™ä¸€æ®µäº†</span><br><span class="line">// Create a fake event type.</span><br><span class="line">var evtType = &apos;react-&apos; + (name ? name : &apos;invokeguardedcallback&apos;);</span><br><span class="line"></span><br><span class="line">// Attach our event handlers</span><br><span class="line">window.addEventListener(&apos;error&apos;, onError);</span><br><span class="line">//sck äº‹ä»¶åˆ›å»ºäºè§¦å‘</span><br><span class="line">console.log(&apos;sck--&apos;, evtType);</span><br><span class="line">//ä¸ºç”šå¥½å¤šæ¬¡ï¼Ÿ </span><br><span class="line">// sck-- react-invokeguardedcallback</span><br><span class="line">debugger</span><br><span class="line">fakeNode.addEventListener(evtType, callCallback, false);</span><br><span class="line"></span><br><span class="line">// Synchronously dispatch our fake event. If the user-provided function</span><br><span class="line">// errors, it will trigger our global error handler.</span><br><span class="line">evt.initEvent(evtType, false, false);</span><br><span class="line">fakeNode.dispatchEvent(evt);</span><br></pre></td></tr></table></figure>
<p>dispatchInteractiveEvent-&gt;interactiveUpdates-&gt;runExtractedEventsInBatch-&gt;runEventsInBatch-&gt;å¾ªç¯æ‰§è¡Œæ‰€æœ‰ç»‘å®šçš„äº‹ä»¶</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Reactäº‹ä»¶ç³»ç»Ÿä¸ºäº†å…¼å®¹å„ç§ç‰ˆæœ¬çš„æµè§ˆå™¨è€Œåšäº†å¤§é‡å·¥ä½œï¼Œä¸åŸç”Ÿäº‹ä»¶ä¸åŒçš„ç‚¹ï¼Œåªåœ¨äºReactå¯¹äº‹ä»¶è¿›è¡Œç»Ÿä¸€è€Œä¸æ˜¯åˆ†æ•£çš„å­˜å‚¨ä¸ç®¡ç†ï¼Œæ•è·äº‹ä»¶åå†…éƒ¨ç”Ÿæˆåˆæˆäº‹ä»¶æé«˜æµè§ˆå™¨çš„å…¼å®¹åº¦ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°åå†è¿›è¡Œé”€æ¯é‡Šæ”¾å†…å­˜ï¼Œä»è€Œå¤§å¤§æé«˜ç½‘é¡µçš„å“åº”æ€§èƒ½ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/07/26/React-v16-4-0-äº‹ä»¶åŸç†/" data-id="cka3kmlcq000r7zo7747dyvvy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-å…³äºjsæ¨¡å—åŒ–" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/14/å…³äºjsæ¨¡å—åŒ–/" class="article-date">
  <time datetime="2018-07-14T13:52:22.000Z" itemprop="datePublished">2018-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/14/å…³äºjsæ¨¡å—åŒ–/">å…³äºjsæ¨¡å—åŒ–</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ABOUT-JSæ¨¡å—"><a href="#ABOUT-JSæ¨¡å—" class="headerlink" title="ABOUT JSæ¨¡å—"></a>ABOUT JSæ¨¡å—</h1><h2 id="1ã€å¼•è¨€-èƒŒæ™¯"><a href="#1ã€å¼•è¨€-èƒŒæ™¯" class="headerlink" title="1ã€å¼•è¨€-èƒŒæ™¯"></a>1ã€å¼•è¨€-èƒŒæ™¯</h2><p>æ¨¡å—åŒ–è¿™ä¸ªé—®é¢˜å¹¶éä¸€å¼€å§‹å°±å­˜åœ¨ï¼ŒWWWåˆšåˆšé—®ä¸–çš„æ—¶å€™ï¼Œhtmlï¼ŒJavaScriptï¼ŒCSSéƒ½æ˜¯æå…¶ç®€å•çš„å­˜åœ¨ï¼Œå¹¶ä¸éœ€è¦æ¨¡å—åŒ–ã€‚</p>
<h4 id="1-1-æ¨¡å—åŒ–çš„éœ€æ±‚æ˜¯è§„æ¨¡çš„äº§ç‰©"><a href="#1-1-æ¨¡å—åŒ–çš„éœ€æ±‚æ˜¯è§„æ¨¡çš„äº§ç‰©" class="headerlink" title="1.1 æ¨¡å—åŒ–çš„éœ€æ±‚æ˜¯è§„æ¨¡çš„äº§ç‰©"></a>1.1 æ¨¡å—åŒ–çš„éœ€æ±‚æ˜¯è§„æ¨¡çš„äº§ç‰©</h4><p>å½“web pageè¿›åŒ–åˆ°web applicationï¼Œæµè§ˆå™¨ç«¯å¤„ç†çš„é€»è¾‘è¶Šæ¥è¶Šå¤æ‚ï¼Œå±•ç°çš„æ ·å¼å’ŒåŠ¨ç”»è¶Šæ¥è¶Šå¤šï¼Œä¸šåŠ¡é€»è¾‘ä¹Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œå¯¹äºå·¥ç¨‹çš„è¦æ±‚ä¹Ÿå°±è¶Šæ¥è¶Šé«˜ã€‚äºæ˜¯æ¨¡å—åŒ–çš„éœ€æ±‚ä¹Ÿå°±äº§ç”Ÿäº†ã€‚</p>
<h4 id="1-2-ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–-ï¼Ÿ"><a href="#1-2-ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–-ï¼Ÿ" class="headerlink" title="1.2 ä»€ä¹ˆæ˜¯æ¨¡å—åŒ– ï¼Ÿ"></a>1.2 ä»€ä¹ˆæ˜¯æ¨¡å—åŒ– ï¼Ÿ</h4><p>æ¨¡å—åŒ–æ˜¯ä¸€ç§å°†ç³»ç»Ÿåˆ†ç¦»æˆç‹¬ç«‹åŠŸèƒ½éƒ¨åˆ†çš„æ–¹æ³•ï¼Œå¯å°†ç³»ç»Ÿåˆ†å‰²æˆç‹¬ç«‹çš„åŠŸèƒ½éƒ¨åˆ†ï¼Œä¸¥æ ¼å®šä¹‰æ¨¡å—æ¥å£ã€æ¨¡å—é—´å…·æœ‰é€æ˜æ€§ã€‚</p>
<h4 id="1-3-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å—"><a href="#1-3-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å—" class="headerlink" title="1.3 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å— ?"></a>1.3 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å— ?</h4><p>æ¨¡å—åŒ–å¯ä»¥ä½¿ä½ çš„ä»£ç ä½è€¦åˆï¼ŒåŠŸèƒ½æ¨¡å—ç›´æ¥ä¸ç›¸äº’å½±å“ã€‚<br>æ¨¡å—åŒ–æ˜¯å·¥ç¨‹åŒ–çš„éœ€æ±‚ï¼Œæ˜¯ä¸ºäº†æ›´å¥½çš„ç®¡ç†ä»£ç </p>
<h2 id="2ã€å†ç¨‹ï¼ˆè¿›åŒ–ä¸ç±»ä¸¾ï¼‰"><a href="#2ã€å†ç¨‹ï¼ˆè¿›åŒ–ä¸ç±»ä¸¾ï¼‰" class="headerlink" title="2ã€å†ç¨‹ï¼ˆè¿›åŒ–ä¸ç±»ä¸¾ï¼‰"></a>2ã€å†ç¨‹ï¼ˆè¿›åŒ–ä¸ç±»ä¸¾ï¼‰</h2><h4 id="æ— æ¨¡å—"><a href="#æ— æ¨¡å—" class="headerlink" title="æ— æ¨¡å—"></a>æ— æ¨¡å—</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if(xx)&#123;</span><br><span class="line">     //.......</span><br><span class="line">&#125;else&#123;</span><br><span class="line">     //xxxxxxxxxxx</span><br><span class="line">&#125;</span><br><span class="line">for(var i=0; i&lt;10; i++)&#123;</span><br><span class="line">     //todo</span><br><span class="line">&#125;</span><br><span class="line">element.onclick = function()&#123;</span><br><span class="line">     //todo</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç‰¹ç‚¹ï¼šä»£ç ç®€å•çš„å †åœ¨ä¸€èµ·ï¼Œåªè¦èƒ½ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ‰§è¡Œå°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<h4 id="æ¨¡å—èŒèŠ½"><a href="#æ¨¡å—èŒèŠ½" class="headerlink" title="æ¨¡å—èŒèŠ½"></a>æ¨¡å—èŒèŠ½</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function m1()&#123; </span><br><span class="line">ã€€ã€€//... </span><br><span class="line">&#125; </span><br><span class="line">function m2()&#123; </span><br><span class="line">    //... </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ—¶çš„æ¨¡å—å°±æ˜¯å®ç°ç‰¹å®šåŠŸèƒ½çš„ä¸€ç»„æ–¹æ³•ã€‚æŠŠä¸åŒçš„å‡½æ•°ï¼ˆä»¥åŠè®°å½•çŠ¶æ€çš„å˜é‡ï¼‰ç®€å•åœ°æ”¾åœ¨ä¸€èµ·ï¼Œå°±ç®—æ˜¯ä¸€ä¸ªæ¨¡å—ã€‚ </p>
</blockquote>
<blockquote>
<p>ä¸Šé¢çš„å‡½æ•°m1()å’Œm2()ï¼Œç»„æˆä¸€ä¸ªæ¨¡å—ã€‚ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥è°ƒç”¨å°±è¡Œäº†ã€‚<br>ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼šâ€æ±¡æŸ“â€äº†å…¨å±€å˜é‡ï¼Œæ— æ³•ä¿è¯ä¸ä¸å…¶ä»–æ¨¡å—å‘ç”Ÿå˜é‡åå†²çªï¼Œè€Œä¸”æ¨¡å—æˆå‘˜ä¹‹é—´çœ‹ä¸å‡ºç›´æ¥å…³ç³»ã€‚ </p>
</blockquote>
<h4 id="å¯¹è±¡å†™æ³•"><a href="#å¯¹è±¡å†™æ³•" class="headerlink" title="å¯¹è±¡å†™æ³•"></a>å¯¹è±¡å†™æ³•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var module1 = new Object(&#123; </span><br><span class="line">	_count : 0, </span><br><span class="line">ã€€ã€€m1 : function ()&#123; </span><br><span class="line">ã€€ã€€	//... </span><br><span class="line">ã€€ã€€&#125;, </span><br><span class="line">ã€€ã€€m2 : function ()&#123; </span><br><span class="line">ã€€ã€€	//... </span><br><span class="line">ã€€ã€€&#125; </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šé¢çš„å‡½æ•°m1()å’Œm2(ï¼‰ï¼Œéƒ½å°è£…åœ¨module1å¯¹è±¡é‡Œã€‚ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±æ˜¯è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„å±æ€§ã€‚<br>ä½†æ˜¯ï¼Œè¿™æ ·çš„å†™æ³•ä¼šæš´éœ²æ‰€æœ‰æ¨¡å—æˆå‘˜ï¼Œå†…éƒ¨çŠ¶æ€å¯ä»¥è¢«å¤–éƒ¨æ”¹å†™(_count ++ æ“ä½œ)ï¼ˆå½“ç„¶ä¹ŸåŒ…æ‹¬å†…éƒ¨çš„æ–¹æ³•ï¼‰ã€‚</p>
</blockquote>
<h4 id="ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•"><a href="#ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•" class="headerlink" title="ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•"></a>ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•</h4><p>ä½¿ç”¨â€ç«‹å³æ‰§è¡Œå‡½æ•°â€ï¼Œå¯ä»¥è¾¾åˆ°ä¸æš´éœ²ç§æœ‰æˆå‘˜çš„ç›®çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var module1 = (function()&#123; </span><br><span class="line">ã€€ã€€var _count = 0; </span><br><span class="line">ã€€ã€€var m1 = function()&#123; </span><br><span class="line">ã€€ã€€	//... </span><br><span class="line">ã€€ã€€&#125;; </span><br><span class="line">ã€€ã€€var m2 = function()&#123; </span><br><span class="line">ã€€ã€€	//... </span><br><span class="line">	&#125;; </span><br><span class="line">ã€€ã€€return &#123; </span><br><span class="line">ã€€ã€€	m1 : m1, </span><br><span class="line">ã€€ã€€	m2 : m2 </span><br><span class="line">ã€€ã€€&#125;; </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é—®é¢˜ï¼šä½¿ç”¨ä¸Šé¢çš„å†™æ³•ï¼Œå¤–éƒ¨ä»£ç æ— æ³•è¯»å–å†…éƒ¨çš„_countå˜é‡ã€‚<br>module1å°±æ˜¯Javascriptæ¨¡å—çš„åŸºæœ¬å†™æ³•ã€‚ç­‰ä¸‹ï¼Œå†å¯¹è¿™ç§å†™æ³•è¿›è¡ŒåŠ å·¥ã€‚<br>æ­¤æ—¶çš„æ¨¡å—åŒ–æ€æƒ³å·²ç»æˆå‹</p>
</blockquote>
<h3 id="è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å†™æ³•-å¦‚ï¼š"><a href="#è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å†™æ³•-å¦‚ï¼š" class="headerlink" title="è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å†™æ³•, å¦‚ï¼š"></a>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å†™æ³•, å¦‚ï¼š</h3><h4 id="æ”¾å¤§æ¨¡å¼"><a href="#æ”¾å¤§æ¨¡å¼" class="headerlink" title="æ”¾å¤§æ¨¡å¼"></a>æ”¾å¤§æ¨¡å¼</h4><p>å¦‚æœä¸€ä¸ªæ¨¡å—å¾ˆå¤§ï¼Œå¿…é¡»åˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼Œæˆ–è€…ä¸€ä¸ªæ¨¡å—éœ€è¦ç»§æ‰¿å¦ä¸€ä¸ªæ¨¡å—ï¼Œè¿™æ—¶å°±æœ‰å¿…è¦é‡‡ç”¨â€æ”¾å¤§æ¨¡å¼â€ï¼ˆaugmentationï¼‰ã€‚ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var module1New = (function (mod)&#123; </span><br><span class="line">	mod.m3 = function () &#123; </span><br><span class="line">ã€€ã€€	//... </span><br><span class="line">ã€€ã€€&#125;; </span><br><span class="line">ã€€ã€€return mod; </span><br><span class="line">&#125;)(module1);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šé¢çš„ä»£ç ä¸ºmodule1æ¨¡å—æ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•m3()ï¼Œç„¶åè¿”å›æ–°çš„module1æ¨¡å—ã€‚ </p>
</blockquote>
<h4 id="å®½æ”¾å¤§æ¨¡å¼"><a href="#å®½æ”¾å¤§æ¨¡å¼" class="headerlink" title="å®½æ”¾å¤§æ¨¡å¼"></a>å®½æ”¾å¤§æ¨¡å¼</h4><blockquote>
<p>åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œæ¨¡å—çš„å„ä¸ªéƒ¨åˆ†é€šå¸¸éƒ½æ˜¯ä»ç½‘ç»œä¸Šè·å–çš„ï¼Œæœ‰æ—¶æ— æ³•çŸ¥é“å“ªä¸ªéƒ¨åˆ†ä¼šå…ˆåŠ è½½ã€‚å¦‚æœé‡‡ç”¨ä¸Šä¸€èŠ‚çš„å†™æ³•ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œçš„éƒ¨åˆ†æœ‰å¯èƒ½åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨ç©ºå¯¹è±¡ï¼Œè¿™æ—¶å°±è¦é‡‡ç”¨â€å®½æ”¾å¤§æ¨¡å¼â€ã€‚ </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var module1 = ( function (mod)&#123; </span><br><span class="line">	//... </span><br><span class="line">ã€€ã€€return mod; </span><br><span class="line">&#125;)(window.module1 || &#123;&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸â€æ”¾å¤§æ¨¡å¼â€ç›¸æ¯”ï¼Œï¼‚å®½æ”¾å¤§æ¨¡å¼ï¼‚å°±æ˜¯â€ç«‹å³æ‰§è¡Œå‡½æ•°â€çš„å‚æ•°å¯ä»¥æ˜¯ç©ºå¯¹è±¡ã€‚ </p>
</blockquote>
<h4 id="è¾“å…¥å…¨å±€å˜é‡"><a href="#è¾“å…¥å…¨å±€å˜é‡" class="headerlink" title="è¾“å…¥å…¨å±€å˜é‡"></a>è¾“å…¥å…¨å±€å˜é‡</h4><p>ç‹¬ç«‹æ€§æ˜¯æ¨¡å—çš„é‡è¦ç‰¹ç‚¹ï¼Œæ¨¡å—å†…éƒ¨æœ€å¥½ä¸ä¸ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ç›´æ¥äº¤äº’ã€‚<br>ä¸ºäº†åœ¨æ¨¡å—å†…éƒ¨è°ƒç”¨å…¨å±€å˜é‡ï¼Œå¿…é¡»æ˜¾å¼åœ°å°†å…¶ä»–å˜é‡è¾“å…¥æ¨¡å—ã€‚ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var module1 = (function ($, Tatami) &#123; </span><br><span class="line">	//... </span><br><span class="line">&#125;)(jQuery, Ttm);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šé¢çš„module1æ¨¡å—éœ€è¦ä½¿ç”¨jQueryå’ŒTtmï¼Œå°±æŠŠè¿™ä¸¤ä¸ªåº“ï¼ˆå…¶å®æ˜¯ä¸¤ä¸ªæ¨¡å—ï¼‰å½“ä½œå‚æ•°è¾“å…¥module1ã€‚è¿™æ ·åšé™¤äº†ä¿è¯æ¨¡å—çš„ç‹¬ç«‹æ€§ï¼Œè¿˜ä½¿å¾—æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å˜å¾—æ˜æ˜¾ã€‚</p>
</blockquote>
<h3 id="3ã€æ¨¡å—åŒ–çš„æ¨è¿›ä¸ç¹è£"><a href="#3ã€æ¨¡å—åŒ–çš„æ¨è¿›ä¸ç¹è£" class="headerlink" title="3ã€æ¨¡å—åŒ–çš„æ¨è¿›ä¸ç¹è£"></a>3ã€æ¨¡å—åŒ–çš„æ¨è¿›ä¸ç¹è£</h3><p><a href="https://blog.csdn.net/Real_Bird/article/details/54869066" target="_blank" rel="noopener">å„ç§ç°ä»£æ¨¡å—æ¨æ¼”</a></p>
<p>jsæ¨¡å—åŒ–ç¼–ç¨‹ï¼Œå·²ç»æˆä¸ºä¸€ä¸ªè¿«åˆ‡çš„éœ€æ±‚ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¼€å‘è€…åªéœ€è¦å®ç°æ ¸å¿ƒçš„ä¸šåŠ¡é€»è¾‘ï¼Œå…¶ä»–éƒ½å¯ä»¥åŠ è½½åˆ«äººå·²ç»å†™å¥½çš„æ¨¡å—ã€‚</p>
<h4 id="å„ç§æ ‡å‡†å‡ºç°äº†ï¼ˆCommonJSã€AMDã€CMDã€UMDã€ES6ï¼‰"><a href="#å„ç§æ ‡å‡†å‡ºç°äº†ï¼ˆCommonJSã€AMDã€CMDã€UMDã€ES6ï¼‰" class="headerlink" title="å„ç§æ ‡å‡†å‡ºç°äº†ï¼ˆCommonJSã€AMDã€CMDã€UMDã€ES6ï¼‰"></a>å„ç§æ ‡å‡†å‡ºç°äº†ï¼ˆCommonJSã€AMDã€CMDã€UMDã€ES6ï¼‰</h4><p><img src="/imgs/å…³äºjsæ¨¡å—åŒ–/module_pic.png" alt></p>
<h4 id="3-1-commonJS-Node"><a href="#3-1-commonJS-Node" class="headerlink" title="3.1 commonJS(Node)"></a>3.1 commonJS(Node)</h4><p><a href="http://javascript.ruanyifeng.com/nodejs/module.html" target="_blank" rel="noopener">é˜®è€å¸ˆ commonJS module</a></p>
<p>CommonJSæ˜¯ä¸€ä¸ªæ›´åå‘äºæœåŠ¡å™¨ç«¯çš„è§„èŒƒã€‚CommonJSçš„ä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ã€‚requireå‘½ä»¤ç¬¬ä¸€æ¬¡åŠ è½½è¯¥è„šæœ¬æ—¶å°±ä¼šæ‰§è¡Œæ•´ä¸ªè„šæœ¬ï¼Œç„¶ååœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªå¯¹è±¡(å¦‚ä¸‹)ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  id: &apos;...&apos;,</span><br><span class="line">  exports: &#123; ... &#125;,</span><br><span class="line">  loaded: true,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä»¥åéœ€è¦ç”¨åˆ°è¿™ä¸ªæ¨¡å—æ—¶ï¼Œå°±ä¼šåˆ°exportså±æ€§ä¸Šå–å€¼ã€‚å³ä½¿å†æ¬¡æ‰§è¡Œrequireå‘½ä»¤ï¼Œä¹Ÿä¸ä¼šå†æ¬¡æ‰§è¡Œè¯¥æ¨¡å—ï¼Œè€Œæ˜¯åˆ°ç¼“å­˜ä¸­å–å€¼ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//math.js</span><br><span class="line">exports.add = function() &#123;</span><br><span class="line">    var sum = 0, i = 0, args = arguments, l = args.length;</span><br><span class="line">    while (i &lt; l) &#123;</span><br><span class="line">        sum += args[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    return sum;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//increment.js</span><br><span class="line">var add = require(&apos;math&apos;).add;</span><br><span class="line">exports.increment = function(val) &#123;</span><br><span class="line">    return add(val, 1);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç”±äºCommonJSæ˜¯åŒæ­¥åŠ è½½æ¨¡å—ï¼Œè¿™å¯¹äºæœåŠ¡å™¨ç«¯ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰çš„æ¨¡å—éƒ½æ”¾åœ¨æœ¬åœ°ç¡¬ç›˜ã€‚ç­‰å¾…æ¨¡å—æ—¶é—´å°±æ˜¯ç¡¬ç›˜è¯»å–æ–‡ä»¶æ—¶é—´ï¼Œå¾ˆå°ã€‚ä½†æ˜¯ï¼Œå¯¹äºæµè§ˆå™¨è€Œè¨€ï¼Œå®ƒéœ€è¦ä»æœåŠ¡å™¨åŠ è½½æ¨¡å—ï¼Œæ¶‰åŠåˆ°ç½‘é€Ÿï¼Œä»£ç†ç­‰åŸå› ï¼Œä¸€æ—¦ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œæµè§ˆå™¨å¤„äºâ€å‡æ­»â€çŠ¶æ€ã€‚</p>
<p>æ‰€ä»¥åœ¨æµè§ˆå™¨ç«¯ï¼Œä¸é€‚åˆäºCommonJSè§„èŒƒã€‚æ‰€ä»¥åœ¨æµè§ˆå™¨ç«¯åˆå‡ºç°äº†ä¸€ä¸ªè§„èŒƒâ€”â€”AMDã€‚</p>
<h4 id="3-2-AMD-requireJs"><a href="#3-2-AMD-requireJs" class="headerlink" title="3.2 AMD(requireJs)"></a>3.2 AMD(requireJs)</h4><p>AMD(Asynchronous Module Definition)å¼‚æ­¥æ¨¡å—å®šä¹‰ã€‚å¼‚æ­¥å¼ºè°ƒçš„æ˜¯ï¼Œåœ¨åŠ è½½æ¨¡å—ä»¥åŠæ¨¡å—æ‰€ä¾èµ–çš„å…¶å®ƒæ¨¡å—æ—¶ï¼Œéƒ½é‡‡ç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼ï¼Œé¿å…æ¨¡å—åŠ è½½é˜»å¡äº†ç½‘é¡µçš„æ¸²æŸ“è¿›åº¦ã€‚</p>
<p>æ¨¡å—å®šä¹‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define([module-name?], [array-of-dependencies?], [module-factory-or-object]);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>idï¼šæ¨¡å—çš„åå­—ï¼Œå¦‚æœæ²¡æœ‰æä¾›è¯¥å‚æ•°ï¼Œæ¨¡å—çš„åå­—åº”è¯¥é»˜è®¤ä¸ºæ¨¡å—åŠ è½½å™¨è¯·æ±‚çš„æŒ‡å®šè„šæœ¬çš„åå­—ï¼›<br>dependenciesï¼šæ¨¡å—çš„ä¾èµ–ï¼Œå·²è¢«æ¨¡å—å®šä¹‰çš„æ¨¡å—æ ‡è¯†çš„æ•°ç»„å­—é¢é‡ã€‚<br>factoryï¼šæ¨¡å—çš„å·¥å‚å‡½æ•°ï¼Œæ¨¡å—åˆå§‹åŒ–è¦æ‰§è¡Œçš„å‡½æ•°æˆ–å¯¹è±¡ã€‚  </p>
</blockquote>
<p>AMDä¹Ÿé‡‡ç”¨requireå‘½ä»¤åŠ è½½æ¨¡å—ï¼Œä½†æ˜¯ä¸åŒäºCommonJSï¼Œå®ƒè¦æ±‚ä¸¤ä¸ªå‚æ•°ï¼š</p>
<p>require([module], callback);</p>
<blockquote>
<p>ç¬¬ä¸€ä¸ªå‚æ•°[module]ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢çš„æˆå‘˜æ˜¯è¦åŠ è½½çš„æ¨¡å—ï¼Œcallbackæ˜¯åŠ è½½å®Œæˆåçš„å›è°ƒå‡½æ•°ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// math.js</span><br><span class="line">define(function() &#123;</span><br><span class="line">  var add = function(x, y) &#123;</span><br><span class="line">    return x + y;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return  &#123;</span><br><span class="line">    add: add</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// main.js</span><br><span class="line">require([&apos;math&apos;], function(math) &#123;</span><br><span class="line">  //</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“require()åŠ è½½mathæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šå…ˆåŠ è½½å®ƒä¾èµ–çš„æ¨¡å—ã€‚å½“æœ‰å¤šä¸ªä¾èµ–æ—¶ï¼Œå°±å°†æ‰€æœ‰çš„ä¾èµ–éƒ½å†™åœ¨define()å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ•°ç»„ä¸­ï¼Œæ‰€ä»¥è¯´AMDæ˜¯ä¾èµ–å‰ç½®çš„ã€‚è¿™ä¸åŒäºCMDè§„èŒƒï¼Œå®ƒæ˜¯ä¾èµ–å°±è¿‘çš„ã€‚</p>
</blockquote>
<p><a href="https://github.com/creeperyang/amd-loader" target="_blank" rel="noopener">AMDåŠ è½½çš„å®ç°</a></p>
<h4 id="3-3-CMD-seaJS"><a href="#3-3-CMD-seaJS" class="headerlink" title="3.3 CMD(seaJS)"></a>3.3 CMD(seaJS)</h4><p>CMDï¼ˆå³Common Module Definitioné€šç”¨æ¨¡å—å®šä¹‰ï¼‰</p>
<p>CMDæ¨å´‡ä¾èµ–å°±è¿‘ï¼Œå»¶è¿Ÿæ‰§è¡Œã€‚å¯ä»¥æŠŠä½ çš„ä¾èµ–å†™è¿›ä»£ç çš„ä»»æ„ä¸€è¡Œï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define(factory)</span><br></pre></td></tr></table></figure>
<p>factoryä¸ºå‡½æ•°æ—¶ï¼Œè¡¨ç¤ºæ˜¯æ¨¡å—çš„æ„é€ æ–¹æ³•ã€‚æ‰§è¡Œè¯¥æ„é€ æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°æ¨¡å—å‘å¤–æä¾›çš„æ¥å£ã€‚factory æ–¹æ³•åœ¨æ‰§è¡Œæ—¶ï¼Œé»˜è®¤ä¼šä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šrequireã€exports å’Œ module.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">define(function(require, exports, module) &#123;</span><br><span class="line">  var a = require(&apos;./a&apos;);</span><br><span class="line">  a.doSomething();</span><br><span class="line">  var b = require(&apos;./b&apos;);</span><br><span class="line">  b.doSomething();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å› ä¸ºCMDæ¨å´‡ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ¨¡å—ï¼Œæ‰€ä»¥ç»å¸¸å°±ç”¨æ–‡ä»¶åä½œä¸ºæ¨¡å—id<br>CMDæ¨å´‡ä¾èµ–å°±è¿‘ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸åœ¨defineçš„å‚æ•°ä¸­å†™ä¾èµ–ï¼Œåœ¨factoryä¸­å†™ã€‚<br>sea.jsé€šè¿‡sea.use()æ¥åŠ è½½æ¨¡å—ã€‚ seajs.use(id, callback?)</p>
</blockquote>
<h5 id="AMDä¸CMD-åŒºåˆ«è”ç³»"><a href="#AMDä¸CMD-åŒºåˆ«è”ç³»" class="headerlink" title="AMDä¸CMD åŒºåˆ«è”ç³»"></a>AMDä¸CMD åŒºåˆ«è”ç³»</h5><p>SeaJSè¦è§£å†³çš„é—®é¢˜å’ŒrequireJSä¸€æ ·ï¼Œåªä¸è¿‡åœ¨æ¨¡å—å®šä¹‰æ–¹å¼å’Œæ¨¡å—åŠ è½½ï¼ˆå¯ä»¥è¯´è¿è¡Œã€è§£æï¼‰æ—¶æœºä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<p>AMDå’ŒCMDéƒ½æ˜¯ç”¨defineå’Œrequireã€‚</p>
<p>CMDæ ‡å‡†å€¾å‘äºåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æå‡ºä¾èµ–ï¼Œå°±æ˜¯ä¸ç®¡ä»£ç å†™åˆ°å“ªçªç„¶å‘ç°éœ€è¦ä¾èµ–å¦ä¸€ä¸ªæ¨¡å—ï¼Œé‚£å°±åœ¨å½“å‰ä»£ç ç”¨requireå¼•å…¥å°±å¯ä»¥äº†ï¼Œè§„èŒƒä¼šå¸®ä½ æå®šé¢„åŠ è½½ï¼Œä½ éšä¾¿å†™å°±å¯ä»¥äº†ã€‚ä½†æ˜¯AMDæ ‡å‡†è®©ä½ å¿…é¡»æå‰åœ¨å¤´éƒ¨ä¾èµ–å‚æ•°éƒ¨åˆ†å†™å¥½ã€‚</p>
<p>è™½ç„¶éƒ½æ˜¯å¹¶è¡ŒåŠ è½½jsæ–‡ä»¶ï¼Œä½†è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«ï¼ŒAMDæ˜¯é¢„åŠ è½½ï¼Œåœ¨å¹¶è¡ŒåŠ è½½jsæ–‡ä»¶åŒæ—¶ï¼Œè¿˜ä¼šè§£ææ‰§è¡Œè¯¥æ¨¡å—ï¼ˆå› ä¸ºè¿˜éœ€è¦æ‰§è¡Œï¼Œæ‰€ä»¥åœ¨åŠ è½½æŸä¸ªæ¨¡å—å‰ï¼Œè¿™ä¸ªæ¨¡å—çš„ä¾èµ–æ¨¡å—éœ€è¦å…ˆåŠ è½½å®Œæˆï¼‰ï¼›è€ŒCMDæ˜¯æ‡’åŠ è½½ï¼Œè™½ç„¶ä¼šä¸€å¼€å§‹å°±å¹¶è¡ŒåŠ è½½jsæ–‡ä»¶ï¼Œä½†æ˜¯ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰æ‰§è¡Œã€‚</p>
<p>AMDä¼˜ç‚¹ï¼šåŠ è½½å¿«é€Ÿï¼Œå°¤å…¶é‡åˆ°å¤šä¸ªå¤§æ–‡ä»¶ï¼Œå› ä¸ºå¹¶è¡Œè§£æï¼Œæ‰€ä»¥åŒä¸€æ—¶é—´å¯ä»¥è§£æå¤šä¸ªæ–‡ä»¶ã€‚</p>
<p>AMDç¼ºç‚¹ï¼šå¹¶è¡ŒåŠ è½½ï¼Œå¼‚æ­¥å¤„ç†ï¼ŒåŠ è½½é¡ºåºä¸ä¸€å®šï¼Œå¯èƒ½ä¼šé€ æˆä¸€äº›å›°æ‰°ï¼Œç”šè‡³ä¸ºç¨‹åºåŸ‹ä¸‹å¤§å‘ã€‚</p>
<p>CMDä¼˜ç‚¹ï¼šå› ä¸ºåªæœ‰åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šè§£ææ‰§è¡Œjsæ–‡ä»¶ï¼Œå› æ­¤ï¼Œæ¯ä¸ªJSæ–‡ä»¶çš„æ‰§è¡Œé¡ºåºåœ¨ä»£ç ä¸­æ˜¯æœ‰ä½“ç°çš„ï¼Œæ˜¯å¯æ§çš„ã€‚</p>
<p>CMDç¼ºç‚¹ï¼šæ‰§è¡Œç­‰å¾…æ—¶é—´ä¼šå åŠ ã€‚å› ä¸ºæ¯ä¸ªæ–‡ä»¶æ‰§è¡Œæ—¶æ˜¯åŒæ­¥æ‰§è¡Œï¼ˆä¸²è¡Œæ‰§è¡Œï¼‰ï¼Œå› æ­¤æ—¶é—´æ˜¯æ‰€æœ‰æ–‡ä»¶è§£ææ‰§è¡Œæ—¶é—´ä¹‹å’Œï¼Œå°¤å…¶åœ¨æ–‡ä»¶è¾ƒå¤šè¾ƒå¤§æ—¶ï¼Œè¿™ç§ç¼ºç‚¹å°¤ä¸ºæ˜æ˜¾ã€‚</p>
<h4 id="3-4-UMD-Universal-Module-Definition-é€šç”¨æ¨¡å—å®šä¹‰"><a href="#3-4-UMD-Universal-Module-Definition-é€šç”¨æ¨¡å—å®šä¹‰" class="headerlink" title="3.4 UMD (Universal Module Definition é€šç”¨æ¨¡å—å®šä¹‰)"></a>3.4 UMD (Universal Module Definition é€šç”¨æ¨¡å—å®šä¹‰)</h4><p>æ—¢ç„¶CommonJså’ŒAMDé£æ ¼ä¸€æ ·æµè¡Œï¼Œä¼¼ä¹ç¼ºå°‘ä¸€ä¸ªç»Ÿä¸€çš„è§„èŒƒã€‚æ‰€ä»¥äº§ç”Ÿäº†è¿™æ ·çš„éœ€æ±‚ï¼Œå¸Œæœ›æœ‰æ”¯æŒä¸¤ç§é£æ ¼çš„â€œé€šç”¨â€æ¨¡å¼ï¼Œäºæ˜¯é€šç”¨æ¨¡å—è§„èŒƒï¼ˆUMDï¼‰è¯ç”Ÿäº†ã€‚</p>
<blockquote>
<p>UMDå¸Œæœ›æä¾›ä¸€ä¸ªå‰åç«¯è·¨å¹³å°çš„è§£å†³æ–¹æ¡ˆ(æ”¯æŒAMDä¸CommonJSæ¨¡å—æ–¹å¼)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(function (root, factory) &#123;</span><br><span class="line">    if (typeof define === &apos;function&apos; &amp;&amp; define.amd) &#123;</span><br><span class="line">        // AMD</span><br><span class="line">        define([&apos;jquery&apos;, &apos;underscore&apos;], factory);</span><br><span class="line">    &#125; else if (typeof exports === &apos;object&apos;) &#123;</span><br><span class="line">        // Node, CommonJSä¹‹ç±»çš„</span><br><span class="line">        module.exports = factory(require(&apos;jquery&apos;), require(&apos;underscore&apos;));</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // æµè§ˆå™¨å…¨å±€å˜é‡(root å³ window)</span><br><span class="line">        root.returnExports = factory(root.jQuery, root._);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(this, function ($, _) &#123;</span><br><span class="line">    function a()&#123;&#125;; </span><br><span class="line">    function b()&#123;&#125;; </span><br><span class="line">    function c()&#123;&#125;;</span><br><span class="line">    return &#123;</span><br><span class="line">        b: b,</span><br><span class="line">        c: c</span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å…ˆåˆ¤æ–­æ˜¯å¦æ”¯æŒNode.jsæ¨¡å—æ ¼å¼ï¼ˆexportsæ˜¯å¦å­˜åœ¨ï¼‰ï¼Œå­˜åœ¨åˆ™ä½¿ç”¨Node.jsæ¨¡å—æ ¼å¼ã€‚<br>å†åˆ¤æ–­æ˜¯å¦æ”¯æŒAMDï¼ˆdefineæ˜¯å¦å­˜åœ¨ï¼‰ï¼Œå­˜åœ¨åˆ™ä½¿ç”¨AMDæ–¹å¼åŠ è½½æ¨¡å—ã€‚<br>å‰ä¸¤ä¸ªéƒ½ä¸å­˜åœ¨ï¼Œåˆ™å°†æ¨¡å—å…¬å¼€åˆ°å…¨å±€ï¼ˆwindowæˆ–globalï¼‰ã€‚  </p>
</blockquote>
<p>æ›´å¤šæœ‰å…³UMDçš„ä¾‹å­åœ¨Githubä¸Šçš„<a href="https://github.com/umdjs/umd" target="_blank" rel="noopener">å®˜æ–¹repo</a></p>
<h4 id="3-5-ES6-ç»ˆæboss"><a href="#3-5-ES6-ç»ˆæboss" class="headerlink" title="3.5 ES6 ç»ˆæboss"></a>3.5 ES6 ç»ˆæboss</h4><p>æ–°çš„ã€æˆ‘ä»¬åœ¨ç”¨çš„ä¸œè¥¿ã€æ–°è§„èŒƒã€ä»£è¡¨æœªæ¥ã€ç‰›é€¼ã€‚</p>
<blockquote>
<p>es6 æ¨¡å—æ–°çš„æ ‡å‡†åœ¨è®¾è®¡ä¸Šæ˜¯å…¼å®¹å·²ç»å­˜åœ¨çš„CommonJSå’ŒAMDæ¨¡å—çš„ã€‚</p>
</blockquote>
<p>es6é€šè¿‡importã€exportå®ç°æ¨¡å—çš„è¾“å…¥è¾“å‡ºã€‚importå‘½ä»¤ç”¨äºè¾“å…¥å…¶ä»–æ¨¡å—æä¾›çš„åŠŸèƒ½ï¼Œexportå‘½ä»¤ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//a.js</span><br><span class="line">export &#123;a, b, c&#125;;</span><br><span class="line"></span><br><span class="line">//b.js</span><br><span class="line">import &#123;a, b, c &#125; from &apos;a.js&apos;;</span><br><span class="line"></span><br><span class="line">//expt.js</span><br><span class="line">export function abc()&#123;&#125;//export ä¸€ä¸ªå‘½åçš„function  </span><br><span class="line">export default function()&#123;&#125; //export default function  </span><br><span class="line">export num = 123 //export ä¸€ä¸ªæ•°å€¼  </span><br><span class="line">export obj = &#123;&#125;  </span><br><span class="line">export &#123; obj as default &#125;;</span><br><span class="line"></span><br><span class="line">//import</span><br><span class="line">import expt from &apos;expt&apos;//default export  </span><br><span class="line">import &#123;default as myModule&#125; from &apos;expt&apos; //rename  </span><br><span class="line">import &#123;abc,num,obj&#125; from &apos;expt&apos;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯èƒ½è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ul>
<li>æ‰€æœ‰çš„importå’Œexportåªèƒ½å†™åœ¨é¡¶çº§ä½œç”¨åŸŸä¸­ã€‚ä½ ä¸èƒ½åœ¨æ¡ä»¶åˆ¤æ–­è¯­å¥å’Œå‡½æ•°ä½œç”¨åŸŸå†…ä½¿ç”¨importã€‚</li>
<li>æ‰€æœ‰å¯¼å‡ºçš„å˜é‡åå¿…é¡»æ˜¯æ˜¾å¼çš„ï¼Œä½ ä¸èƒ½é€šè¿‡éå†ä¸€ä¸ªæ•°ç»„ï¼ŒåŠ¨æ€ç”Ÿæˆä¸€ç»„å¯¼å‡ºåè¿›è¡Œå¯¼å‡ºã€‚</li>
<li>æ¨¡å—å¯¹è±¡éƒ½æ˜¯è¢«å†»ç»“çš„ï¼Œä¸èƒ½é€šè¿‡polyfillä¸ºå®ƒæ·»åŠ æ–°çš„ç‰¹æ€§ã€‚</li>
<li>å¯¹äºimportçš„é”™è¯¯ï¼Œæ— æ³•è¿›è¡Œrecoveryã€‚ä¸€ä¸ªåº”ç”¨å¯èƒ½ä¾èµ–è®¸å¤šçš„æ¨¡å—ï¼Œä¸€æ—¦æœ‰ä¸€ä¸ªæ¨¡å—åŠ è½½å¤±è´¥ï¼Œè¿™ä¸ªåº”ç”¨éƒ½ä¸ä¼šè¿è¡Œã€‚ä½ ä¸èƒ½åœ¨try/catchä¸­ä½¿ç”¨importã€‚æ­£æ˜¯å› ä¸ºes6çš„æ¨¡å—è¡¨ç°å¾—å¦‚æ­¤é™æ€ï¼Œwebpackæ‰èƒ½åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æµ‹å‡ºä»£ç ä¸­çš„é”™è¯¯ã€‚</li>
<li>ä½ æ²¡æ³•ä¸ºä¸€ä¸ªæ¨¡å—åœ¨åŠ è½½æ‰€æœ‰ä¾èµ–é¡¹ä¹‹å‰æ·»åŠ é’©å­ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªæ¨¡å—æ²¡æœ‰åŠæ³•æ§åˆ¶å…¶ä¾èµ–é¡¹çš„åŠ è½½æ–¹å¼</li>
</ul>
<p>åªä¸¾ä¸€ä¸ªä¾‹å­  like â€¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    import es6 from &apos;./es6.js&apos;;</span><br><span class="line">&#125; catch (error) &#123;</span><br><span class="line">    console.log(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener">é˜®è€å¸ˆå…³äºmodule</a>  </p>
<h5 id="å†çœ‹ä¸€æŠŠes6ä¸commonjsåŒºåˆ«"><a href="#å†çœ‹ä¸€æŠŠes6ä¸commonjsåŒºåˆ«" class="headerlink" title="å†çœ‹ä¸€æŠŠes6ä¸commonjsåŒºåˆ«"></a>å†çœ‹ä¸€æŠŠes6ä¸commonjsåŒºåˆ«</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">es6 &#123;</span><br><span class="line">ã€€ã€€export: &apos;å¯ä»¥è¾“å‡ºå¤šä¸ªï¼Œè¾“å‡ºæ–¹å¼ä¸º &#123;&#125;&apos; ï¼Œ</span><br><span class="line">ã€€ã€€export  default : &apos; åªèƒ½è¾“å‡ºä¸€ä¸ª ï¼Œå¯ä»¥ä¸export åŒæ—¶è¾“å‡ºï¼Œä½†æ˜¯ä¸å»ºè®®è¿™ä¹ˆåš&apos;ï¼Œ</span><br><span class="line">ã€€ã€€è§£æé˜¶æ®µç¡®å®šå¯¹å¤–è¾“å‡ºçš„æ¥å£ï¼Œè§£æé˜¶æ®µç”Ÿæˆæ¥å£ï¼Œ</span><br><span class="line">ã€€ã€€æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼ŒåŠ è½½çš„ä¸æ˜¯å¯¹è±¡ï¼Œ</span><br><span class="line">ã€€ã€€å¯ä»¥å•ç‹¬åŠ è½½å…¶ä¸­çš„æŸä¸ªæ¥å£ï¼ˆæ–¹æ³•ï¼‰ï¼Œ</span><br><span class="line">ã€€ã€€é™æ€åˆ†æï¼ŒåŠ¨æ€å¼•ç”¨ï¼Œè¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œå€¼æ”¹å˜ï¼Œå¼•ç”¨ä¹Ÿæ”¹å˜ï¼Œå³åŸæ¥æ¨¡å—ä¸­çš„å€¼æ”¹å˜åˆ™è¯¥åŠ è½½çš„å€¼ä¹Ÿæ”¹å˜ï¼Œ</span><br><span class="line">ã€€ã€€this æŒ‡å‘undefined</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">commonJS &#123;</span><br><span class="line">ã€€ã€€module.exports =  xxx : &apos;åªèƒ½è¾“å‡ºä¸€ä¸ªï¼Œä¸”åé¢çš„ä¼šè¦†ç›–ä¸Šé¢çš„&apos; ï¼Œ</span><br><span class="line">ã€€ã€€exports.  xxx : &apos; å¯ä»¥è¾“å‡ºå¤šä¸ª&apos;ï¼Œ</span><br><span class="line">ã€€ã€€è¿è¡Œé˜¶æ®µç¡®å®šæ¥å£ï¼Œè¿è¡Œæ—¶æ‰ä¼šåŠ è½½æ¨¡å—ï¼Œ</span><br><span class="line">ã€€ã€€æ¨¡å—æ˜¯å¯¹è±¡ï¼ŒåŠ è½½çš„æ˜¯è¯¥å¯¹è±¡ï¼Œ</span><br><span class="line">ã€€ã€€åŠ è½½çš„æ˜¯æ•´ä¸ªæ¨¡å—ï¼Œå³å°†æ‰€æœ‰çš„æ¥å£å…¨éƒ¨åŠ è½½è¿›æ¥ï¼Œ</span><br><span class="line">ã€€ã€€è¾“å‡ºæ˜¯å€¼çš„æ‹·è´ï¼Œå³åŸæ¥æ¨¡å—ä¸­çš„å€¼æ”¹å˜ä¸ä¼šå½±å“å·²ç»åŠ è½½çš„è¯¥å€¼ï¼Œ</span><br><span class="line">ã€€ã€€this æŒ‡å‘å½“å‰æ¨¡å—</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://caibaojian.com/es6/module.html" target="_blank" rel="noopener">commonjsä¸es6åŒºåˆ«</a></p>
<blockquote>
<p>åœ¨ç»“åˆes6æ¨¡å—å’ŒcommonJSæ¨¡å—çš„åŒºåˆ«ä¹‹åï¼Œæˆ‘ä»¬çŸ¥é“es6çš„ç‰¹ç‚¹æ˜¯é™æ€è§£æï¼Œè€ŒcommonJSæ¨¡å—çš„ç‰¹ç‚¹æ˜¯åŠ¨æ€è§£æçš„ï¼Œå› æ­¤ï¼Œå€Ÿäºes6æ¨¡å—çš„é™æ€è§£æï¼Œtree-shakingçš„å®ç°æ‰èƒ½æˆä¸ºå¯èƒ½ã€‚</p>
</blockquote>
<h4 id="3-6-ç›®å‰çš„æˆ‘ä»¬â€”-å°‘ä¸äº†webpack"><a href="#3-6-ç›®å‰çš„æˆ‘ä»¬â€”-å°‘ä¸äº†webpack" class="headerlink" title="3.6 ç›®å‰çš„æˆ‘ä»¬â€”-å°‘ä¸äº†webpack"></a>3.6 ç›®å‰çš„æˆ‘ä»¬â€”-å°‘ä¸äº†webpack</h4><p>è™½ç„¶ä¸ç®—æ˜¯æ¨¡å—åŒ–è§„èŒƒï¼Œä½†æ˜¯ä¸ºæˆ‘ä»¬è§£å†³æ¨¡å—é—®é¢˜æä¾›äº†æå¤§å¸®åŠ©ã€‚</p>
<p><a href>webpackæ¨¡å—åŒ–åŸç† è§ä¸‹æ–‡</a></p>
<h3 id="4ã€æ‹¨å¼€äº‘é›¾"><a href="#4ã€æ‹¨å¼€äº‘é›¾" class="headerlink" title="4ã€æ‹¨å¼€äº‘é›¾"></a>4ã€æ‹¨å¼€äº‘é›¾</h3><p>æ¨¡å—çš„æœ¬è´¨ï¼šæ¨¡å—åŒ–ç›¸å½“äºé—­åŒ…å¼€å‘ï¼Œ æ¥å£å¯¼å‡ºå°±ç›¸å½“äºå°†çˆ¶å‡½æ•°ï¼ˆæ¨¡å—ï¼‰å†…çš„å­å‡½æ•°ç»™æš´æ¼åˆ°çˆ¶å‡½æ•°å¤–ã€‚</p>
<h3 id="5ã€æ€»ç»“å¿…å¤‡"><a href="#5ã€æ€»ç»“å¿…å¤‡" class="headerlink" title="5ã€æ€»ç»“å¿…å¤‡"></a>5ã€æ€»ç»“å¿…å¤‡</h3><h4 id="5-1-æ¨¡å—åŒ–çš„ä¼˜ç¼ºç‚¹ï¼š"><a href="#5-1-æ¨¡å—åŒ–çš„ä¼˜ç¼ºç‚¹ï¼š" class="headerlink" title="5.1 æ¨¡å—åŒ–çš„ä¼˜ç¼ºç‚¹ï¼š"></a>5.1 æ¨¡å—åŒ–çš„ä¼˜ç¼ºç‚¹ï¼š</h4><h5 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h5><p>(1)å¯ç»´æŠ¤æ€§  </p>
<ul>
<li>çµæ´»æ¶æ„ï¼Œç„¦ç‚¹åˆ†ç¦»  </li>
<li>æ–¹ä¾¿æ¨¡å—é—´ç»„åˆã€åˆ†è§£   </li>
<li>æ–¹ä¾¿å•ä¸ªæ¨¡å—åŠŸèƒ½è°ƒè¯•ã€å‡çº§  </li>
<li>å¤šäººåä½œäº’ä¸å¹²æ‰°  </li>
</ul>
<p>(2)å¯æµ‹è¯•æ€§  </p>
<ul>
<li>å¯åˆ†å•å…ƒæµ‹è¯•  </li>
</ul>
<h5 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h5><p>æ€§èƒ½æŸè€—  </p>
<ul>
<li>ç³»ç»Ÿåˆ†å±‚ï¼Œè°ƒç”¨é“¾ä¼šå¾ˆé•¿  </li>
<li>æ¨¡å—é—´é€šä¿¡,æ¨¡å—é—´å‘é€æ¶ˆæ¯ä¼šå¾ˆè€—æ€§èƒ½  </li>
</ul>
<h4 id="5-2-æ¨¡å—åŒ–çš„æ„ä¹‰"><a href="#5-2-æ¨¡å—åŒ–çš„æ„ä¹‰" class="headerlink" title="5.2 æ¨¡å—åŒ–çš„æ„ä¹‰"></a>5.2 æ¨¡å—åŒ–çš„æ„ä¹‰</h4><ul>
<li>ç»„ä»¶çš„å¤ç”¨ï¼Œé™ä½å¼€å‘æˆæœ¬å’Œç»´æŠ¤æˆæœ¬</li>
<li>ç»„ä»¶å•ç‹¬å¼€å‘ï¼Œæ–¹ä¾¿åˆ†å·¥åˆä½œ</li>
<li>æ¨¡å—åŒ–éµå¾ªæ ‡å‡†ï¼Œæ–¹ä¾¿è‡ªåŠ¨åŒ–ä¾èµ–ç®¡ç†ï¼Œä»£ç ä¼˜åŒ–ï¼Œéƒ¨ç½²</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/07/14/å…³äºjsæ¨¡å—åŒ–/" data-id="cka3kmlcz00157zo7osvlxhdf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-node requireä¸webpackæ¨¡å—åŒ–åŸç†" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/18/node requireä¸webpackæ¨¡å—åŒ–åŸç†/" class="article-date">
  <time datetime="2018-06-18T13:57:29.000Z" itemprop="datePublished">2018-06-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/18/node requireä¸webpackæ¨¡å—åŒ–åŸç†/">node requireä¸webpackæ¨¡å—åŒ–åŸç†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="about-node-require"><a href="#about-node-require" class="headerlink" title="about node require"></a>about node require</h2><p>é¦–å…ˆï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//node æ¨¡å—ä»£ç </span><br><span class="line">var a = &#123;&#125;;</span><br><span class="line">module.exports = a;</span><br></pre></td></tr></table></figure>
<p>é—®é¢˜ï¼šåœ¨nodeæ‰§è¡Œçš„æ—¶å€™ä¼šå‘ç°ï¼Œä»£ç å˜æˆäº†è¿™æ ·å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(function (exports, require, module, __filename, __dirname) &#123;</span><br><span class="line">    var a = &#123;&#125;;</span><br><span class="line">    module.exports = a;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„æ¨¡å—ä»£ç åœ¨è¿è¡Œçš„æ—¶å€™æ˜¯è¢«åŒ…è£¹äº†ä¸€å±‚çš„ï¼Œè€Œä¸Šé¢åˆ—çš„è¿™äº›å˜é‡æ­£æ˜¯åœ¨è¿™ä¸ªåŒ…è£¹å‡½æ•°ä¸­ä½œä¸ºå½¢å‚ä¼ å…¥çš„ã€‚<br>å…¶ä¸­moduleæŒ‡å‘æ¨¡å—æœ¬èº«ï¼Œmodule.exportså’Œexportsæ˜¯ç­‰ä»·çš„ï¼Œè¡¨ç¤ºæ¨¡å—è¦å¯¼å‡ºä¾›è°ƒç”¨çš„å†…å®¹</p>
</blockquote>
<h2 id="requireçš„å†…éƒ¨å¤„ç†æµç¨‹"><a href="#requireçš„å†…éƒ¨å¤„ç†æµç¨‹" class="headerlink" title="requireçš„å†…éƒ¨å¤„ç†æµç¨‹"></a>requireçš„å†…éƒ¨å¤„ç†æµç¨‹</h2><p>å…ˆä¸Š<a href="https://github.com/nodejs/node/blob/v5.x/lib/module.js" target="_blank" rel="noopener">ä»£ç </a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// Loads a module at the given file path. Returns that module&apos;s</span><br><span class="line">// `exports` property.</span><br><span class="line">Module.prototype.require = function (path) &#123;</span><br><span class="line">    assert(path, &apos;missing path&apos;);</span><br><span class="line">    assert(typeof path === &apos;string&apos;, &apos;path must be a string&apos;);</span><br><span class="line">    return Module._load(path, this, /* isMain */ false);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h3><p>requireå‘½ä»¤æ˜¯CommonJSè§„èŒƒä¹‹ä¸­ï¼Œç”¨æ¥åŠ è½½å…¶ä»–æ¨¡å—çš„å‘½ä»¤ã€‚å®ƒå…¶å®ä¸æ˜¯ä¸€ä¸ªå…¨å±€å‘½ä»¤ï¼Œè€Œæ˜¯æŒ‡å‘å½“å‰æ¨¡å—çš„module.requireå‘½ä»¤ï¼Œè€Œåè€…åˆè°ƒç”¨Nodeçš„å†…éƒ¨å‘½ä»¤Module._loadã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Module._load = function(request, parent, isMain) &#123;</span><br><span class="line">	// .....</span><br><span class="line">	</span><br><span class="line">	return module.exports;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Module._load = function(request, parent, isMain) &#123;</span><br><span class="line">  // 1. æ£€æŸ¥ Module._cacheï¼Œæ˜¯å¦ç¼“å­˜ä¹‹ä¸­æœ‰æŒ‡å®šæ¨¡å—</span><br><span class="line">  // 2. å¦‚æœç¼“å­˜ä¹‹ä¸­æ²¡æœ‰ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„Moduleå®ä¾‹</span><br><span class="line">  // 3. å°†å®ƒä¿å­˜åˆ°ç¼“å­˜</span><br><span class="line">  // 4. ä½¿ç”¨ module.load() åŠ è½½æŒ‡å®šçš„æ¨¡å—æ–‡ä»¶ï¼Œ</span><br><span class="line">  //    è¯»å–æ–‡ä»¶å†…å®¹ä¹‹åï¼Œä½¿ç”¨ module.compile() æ‰§è¡Œæ–‡ä»¶ä»£ç </span><br><span class="line">  // 5. å¦‚æœåŠ è½½/è§£æè¿‡ç¨‹æŠ¥é”™ï¼Œå°±ä»ç¼“å­˜åˆ é™¤è¯¥æ¨¡å—</span><br><span class="line">  // 6. è¿”å›è¯¥æ¨¡å—çš„ module.exports</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Given a file name, pass it to the proper extension handler.</span><br><span class="line">Module.prototype.load = function(filename) &#123;</span><br><span class="line">  debug(&apos;load %j for module %j&apos;, filename, this.id);</span><br><span class="line"></span><br><span class="line">  assert(!this.loaded);</span><br><span class="line">  this.filename = filename;</span><br><span class="line">  this.paths = Module._nodeModulePaths(path.dirname(filename));</span><br><span class="line">  </span><br><span class="line">  // .....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç¬¬4æ­¥ï¼Œé‡‡ç”¨module.compile()æ‰§è¡ŒæŒ‡å®šæ¨¡å—çš„è„šæœ¬ï¼Œé€»è¾‘å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// Run the file contents in the correct scope or sandbox. Expose</span><br><span class="line">// the correct helper variables (require, module, exports) to</span><br><span class="line">// the file.</span><br><span class="line">// Returns exception, if any.</span><br><span class="line">Module.prototype._compile = function(content, filename) &#123;</span><br><span class="line">	// .....</span><br><span class="line">	const dirname = path.dirname(filename);</span><br><span class="line">  	const require = internalModule.makeRequireFunction.call(this);</span><br><span class="line">  	const args = [this.exports, require, this, filename, dirname];</span><br><span class="line">  	const depth = internalModule.requireDepth;</span><br><span class="line">  	if (depth === 0) stat.cache = new Map();</span><br><span class="line">  	const result = compiledWrapper.apply(this.exports, args);</span><br><span class="line">  	if (depth === 0) stat.cache = null;</span><br><span class="line">  	return result;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Module.prototype._compile = function(content, filename) &#123;</span><br><span class="line">  // 1. ç”Ÿæˆä¸€ä¸ªrequireå‡½æ•°ï¼ŒæŒ‡å‘module.require</span><br><span class="line">  // 2. åŠ è½½å…¶ä»–è¾…åŠ©æ–¹æ³•åˆ°require</span><br><span class="line">  // 3. å°†æ–‡ä»¶å†…å®¹æ”¾åˆ°ä¸€ä¸ªå‡½æ•°ä¹‹ä¸­ï¼Œè¯¥å‡½æ•°å¯è°ƒç”¨ require</span><br><span class="line">  // 4. æ‰§è¡Œè¯¥å‡½æ•°</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç¬¬1æ­¥å’Œç¬¬2æ­¥ï¼Œrequireå‡½æ•°åŠå…¶è¾…åŠ©æ–¹æ³•ä¸»è¦å¦‚ä¸‹ã€‚</p>
<blockquote>
<p>require(): åŠ è½½å¤–éƒ¨æ¨¡å—<br>require.resolve()ï¼šå°†æ¨¡å—åè§£æåˆ°ä¸€ä¸ªç»å¯¹è·¯å¾„<br>require.cacheï¼šæŒ‡å‘æ‰€æœ‰ç¼“å­˜çš„æ¨¡å—<br>require.extensionsï¼šæ ¹æ®æ–‡ä»¶çš„åç¼€åï¼Œè°ƒç”¨ä¸åŒçš„æ‰§è¡Œå‡½æ•°  </p>
</blockquote>
<p>ä¸€æ—¦requireå‡½æ•°å‡†å¤‡å®Œæ¯•ï¼Œæ•´ä¸ªæ‰€è¦åŠ è½½çš„è„šæœ¬å†…å®¹ï¼Œå°±è¢«æ”¾åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¹‹ä¸­ï¼Œè¿™æ ·å¯ä»¥é¿å…æ±¡æŸ“å…¨å±€ç¯å¢ƒã€‚è¯¥å‡½æ•°çš„å‚æ•°åŒ…æ‹¬requireã€moduleã€exportsï¼Œä»¥åŠå…¶ä»–ä¸€äº›å‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(function (exports, require, module, __filename, __dirname) &#123;</span><br><span class="line">  // YOUR CODE INJECTED HERE!</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Module._compileæ–¹æ³•æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥Module._loadè¦ç­‰å®ƒæ‰§è¡Œå®Œæˆï¼Œæ‰ä¼šå‘ç”¨æˆ·è¿”å›module.exportsçš„å€¼ã€‚</p>
<p>åœ¨Module._complieä¸­æ˜¯ä¼šåœ¨æˆ‘ä»¬æ¨¡å—çš„ä»£ç å¤–é¢åŒ…è£¹ä¸€äº›å†…å®¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Module.prototype._compile = function(content, filename) &#123;</span><br><span class="line">  // remove shebang</span><br><span class="line">  content = content.replace(shebangRe, &apos;&apos;);</span><br><span class="line"></span><br><span class="line">  // create wrapper function</span><br><span class="line">  var wrapper = Module.wrap(content);</span><br><span class="line"></span><br><span class="line">  var compiledWrapper = runInThisContext(wrapper,</span><br><span class="line">                                      &#123; filename: filename, lineOffset: 0 &#125;);</span><br><span class="line">  ....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//Moduleçš„warp æ¥è‡ªNativeModule</span><br><span class="line"></span><br><span class="line">NativeModule.wrap = function(script) &#123;</span><br><span class="line">  return NativeModule.wrapper[0] + script + NativeModule.wrapper[1];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NativeModule.wrapper = [</span><br><span class="line">  &apos;(function (exports, require, module, __filename, __dirname) &#123; &apos;,</span><br><span class="line">  &apos;\n&#125;);&apos;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>è‡ªæ­¤æˆ‘ä»¬çš„æ¨¡å—å†…å®¹ç®—æ˜¯åŒ…è£…å®Œäº†ã€‚</p>
<p>AND <del>~</del>~</p>
<p>æˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼node requireçš„åŠæ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">function require(path) &#123;</span><br><span class="line">    function load()&#123;</span><br><span class="line">        return &apos;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    let code = load(path);</span><br><span class="line">    code = &apos;function add(a, b) &#123;return a+b&#125;; module.exports = add&apos;;</span><br><span class="line">    // å°è£…æˆé—­åŒ…</span><br><span class="line">    code = `(function(module) &#123; $&#123;code&#125; &#125;)(context)`;</span><br><span class="line">    // ç›¸å½“äº exportsï¼Œç”¨äºå¯¼å‡ºå¯¹è±¡</span><br><span class="line">    let context = &#123;&#125;;</span><br><span class="line">    // è¿è¡Œä»£ç ï¼Œä½¿å¾—ç»“æœå½±å“åˆ° context</span><br><span class="line">    const run = new Function(&apos;context&apos;, code);</span><br><span class="line">    </span><br><span class="line">    //å¤§æ¦‚å°±æ˜¯è¿™æ ·å­</span><br><span class="line">    &lt;!-- function(context)&#123;</span><br><span class="line">        (function(module) &#123;</span><br><span class="line">            function add(a, b) &#123;return a+b&#125;; </span><br><span class="line">            module.exports = add;</span><br><span class="line">        &#125;)(context)</span><br><span class="line">    &#125; --&gt;</span><br><span class="line"></span><br><span class="line">    run(context, code);</span><br><span class="line">    </span><br><span class="line">    //è¿”å›å¯¼å‡ºçš„ç»“æœ</span><br><span class="line">    return context.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var a = require(&apos;xxx&apos;).exports;</span><br></pre></td></tr></table></figure>
<p><a href="http://www.ruanyifeng.com/blog/2015/05/require.html" target="_blank" rel="noopener">é˜®è€å¸ˆrequire</a></p>
<h2 id="about-webpack-æ¨¡å—åŒ–"><a href="#about-webpack-æ¨¡å—åŒ–" class="headerlink" title="about webpack æ¨¡å—åŒ–"></a>about webpack æ¨¡å—åŒ–</h2><h5 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h5><p>webpackä½œä¸ºä¸€ä¸ªæ„å»ºå·¥å…·ï¼Œè§£å†³äº†å‰ç«¯ä»£ç ç¼ºå°‘æ¨¡å—åŒ–èƒ½åŠ›çš„é—®é¢˜ã€‚ä»£ç ç»è¿‡webpackæ„å»ºå’ŒåŒ…è£…ä¹‹åï¼Œèƒ½å¤Ÿåœ¨æµè§ˆå™¨ä»¥æ¨¡å—åŒ–çš„æ–¹å¼è¿è¡Œã€‚è¿™äº›èƒ½åŠ›ï¼Œéƒ½æ˜¯å› ä¸ºwebpackå¯¹æˆ‘ä»¬çš„ä»£ç è¿›è¡Œäº†ä¸€å±‚åŒ…è£…ã€‚</p>
<h4 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h4><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•å…¥å£æ¨¡å—index.jså’Œä¸€äº›ä¾èµ–æ¨¡å—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">let &#123;name, age, address&#125; = require(&apos;./common.js&apos;);</span><br><span class="line">import es6 from &apos;./es6.js&apos;;</span><br><span class="line"></span><br><span class="line">console.log(name, es6(10));</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//es6.js</span><br><span class="line">export default function(a)&#123;</span><br><span class="line">	return 1000 + a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function testfun(a)&#123;</span><br><span class="line">	return a + &apos;å“ˆå“ˆå“ˆ&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//common.js</span><br><span class="line">module.exports = &#123;</span><br><span class="line">	age: 10,</span><br><span class="line">	name: &apos;zhangsan&apos;,</span><br><span class="line">	address: function()&#123;</span><br><span class="line">		return &apos;dddd&apos;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>webpack é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: path.join(__dirname, &apos;index.js&apos;),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, &apos;outs&apos;),</span><br><span class="line">        filename: &apos;index.js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„é…ç½®ï¼ŒåªæŒ‡å®šäº†æ¨¡å—å…¥å£å’Œè¾“å‡ºè·¯å¾„ã€‚</p>
</blockquote>
<p>æ‰§è¡Œwebpackï¼Œå¾—åˆ°ç»è¿‡webpackæ‰“åŒ…çš„ä»£ç å¦‚ä¸‹ï¼ˆå»æ‰äº†ä¸å¿…è¦çš„æ³¨é‡Šï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">/******/ (function(modules) &#123; // webpackBootstrap</span><br><span class="line">/******/ 	// The module cache</span><br><span class="line">/******/ 	var installedModules = &#123;&#125;;</span><br><span class="line">/******/ 	// The require function</span><br><span class="line">/******/ 	function __webpack_require__(moduleId) &#123;</span><br><span class="line">/******/ 		// Check if module is in cache</span><br><span class="line">/******/ 		if(installedModules[moduleId]) &#123;</span><br><span class="line">/******/ 			return installedModules[moduleId].exports;</span><br><span class="line">/******/ 		&#125;</span><br><span class="line">/******/ 		// Create a new module (and put it into the cache)</span><br><span class="line">/******/ 		var module = installedModules[moduleId] = &#123;</span><br><span class="line">/******/ 			i: moduleId,</span><br><span class="line">/******/ 			l: false,</span><br><span class="line">/******/ 			exports: &#123;&#125;</span><br><span class="line">/******/ 		&#125;;</span><br><span class="line">/******/ 		// Execute the module function</span><br><span class="line">/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);</span><br><span class="line">/******/ 		// Flag the module as loaded</span><br><span class="line">/******/ 		module.l = true;</span><br><span class="line">/******/ 		// Return the exports of the module</span><br><span class="line">/******/ 		return module.exports;</span><br><span class="line">/******/ 	&#125;</span><br><span class="line">/******/ 	// expose the modules object (__webpack_modules__)</span><br><span class="line">/******/ 	__webpack_require__.m = modules;</span><br><span class="line">/******/</span><br><span class="line">/******/ 	// expose the module cache</span><br><span class="line">/******/ 	__webpack_require__.c = installedModules;</span><br><span class="line">/******/</span><br><span class="line">/******/ 	// define getter function for harmony exports</span><br><span class="line">/******/ 	__webpack_require__.d = function(exports, name, getter) &#123;</span><br><span class="line">/******/ 		if(!__webpack_require__.o(exports, name)) &#123;</span><br><span class="line">/******/ 			Object.defineProperty(exports, name, &#123; enumerable: true, get: getter &#125;);</span><br><span class="line">/******/ 		&#125;</span><br><span class="line">/******/ 	&#125;;</span><br><span class="line">/******/ 	// define __esModule on exports</span><br><span class="line">/******/ 	__webpack_require__.r = function(exports) &#123;</span><br><span class="line">/******/ 		if(typeof Symbol !== &apos;undefined&apos; &amp;&amp; Symbol.toStringTag) &#123;</span><br><span class="line">/******/ 			Object.defineProperty(exports, Symbol.toStringTag, &#123; value: &apos;Module&apos; &#125;);</span><br><span class="line">/******/ 		&#125;</span><br><span class="line">/******/ 		Object.defineProperty(exports, &apos;__esModule&apos;, &#123; value: true &#125;);</span><br><span class="line">/******/ 	&#125;;</span><br><span class="line">/******/ 	__webpack_require__.t = function(value, mode) &#123;</span><br><span class="line">/******/ 		if(mode &amp; 1) value = __webpack_require__(value);</span><br><span class="line">/******/ 		if(mode &amp; 8) return value;</span><br><span class="line">/******/ 		if((mode &amp; 4) &amp;&amp; typeof value === &apos;object&apos; &amp;&amp; value &amp;&amp; value.__esModule) return value;</span><br><span class="line">/******/ 		var ns = Object.create(null);</span><br><span class="line">/******/ 		__webpack_require__.r(ns);</span><br><span class="line">/******/ 		Object.defineProperty(ns, &apos;default&apos;, &#123; enumerable: true, value: value &#125;);</span><br><span class="line">/******/ 		if(mode &amp; 2 &amp;&amp; typeof value != &apos;string&apos;) for(var key in value) __webpack_require__.d(ns, key, function(key) &#123; return value[key]; &#125;.bind(null, key));</span><br><span class="line">/******/ 		return ns;</span><br><span class="line">/******/ 	&#125;;</span><br><span class="line">/******/</span><br><span class="line">/******/ 	// getDefaultExport function for compatibility with non-harmony modules</span><br><span class="line">/******/ 	__webpack_require__.n = function(module) &#123;</span><br><span class="line">/******/ 		var getter = module &amp;&amp; module.__esModule ?</span><br><span class="line">/******/ 			function getDefault() &#123; return module[&apos;default&apos;]; &#125; :</span><br><span class="line">/******/ 			function getModuleExports() &#123; return module; &#125;;</span><br><span class="line">/******/ 		__webpack_require__.d(getter, &apos;a&apos;, getter);</span><br><span class="line">/******/ 		return getter;</span><br><span class="line">/******/ 	&#125;;</span><br><span class="line">/******/</span><br><span class="line">/******/ 	// Object.prototype.hasOwnProperty.call</span><br><span class="line">/******/ 	__webpack_require__.o = function(object, property) &#123; return Object.prototype.hasOwnProperty.call(object, property); &#125;;</span><br><span class="line">/******/</span><br><span class="line">/******/ 	// __webpack_public_path__</span><br><span class="line">/******/ 	__webpack_require__.p = &quot;&quot;;</span><br><span class="line">/******/</span><br><span class="line">/******/</span><br><span class="line">/******/ 	// Load entry module and return exports</span><br><span class="line">/******/ 	return __webpack_require__(__webpack_require__.s = &quot;./src/index.js&quot;);</span><br><span class="line">/******/ &#125;)</span><br><span class="line">/******/ (&#123;</span><br><span class="line"></span><br><span class="line">/***/ &quot;./src/common.js&quot;:</span><br><span class="line">/***/ (function(module, exports) &#123;</span><br><span class="line"></span><br><span class="line">  eval(&quot;module.exports = &#123;\n\tage: 10,\n\tname: &apos;zhangsan&apos;,\n\taddress: function()&#123;\n\t\treturn &apos;dddd&apos;\n\t&#125;\n&#125;\n\n//# sourceURL=webpack:///./src/common.js?&quot;);</span><br><span class="line">  /***/ &#125;),</span><br><span class="line">  </span><br><span class="line">  /***/ &quot;./src/es6.js&quot;:</span><br><span class="line">  /***/ (function(module, __webpack_exports__, __webpack_require__) &#123;</span><br><span class="line">  </span><br><span class="line">  &quot;use strict&quot;;</span><br><span class="line">  eval(&quot;__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \&quot;testfun\&quot;, function() &#123; return testfun; &#125;);\n/* harmony default export */ __webpack_exports__[\&quot;default\&quot;] = (function(a)&#123;\n\treturn 1000 + a;\n&#125;);\n\nfunction testfun(a)&#123;\n\treturn a + &apos;å“ˆå“ˆå“ˆ&apos;;\n&#125;\n\n//# sourceURL=webpack:///./src/es6.js?&quot;);</span><br><span class="line">  /***/ &#125;),</span><br><span class="line"></span><br><span class="line">  /***/ &quot;./src/index.js&quot;:</span><br><span class="line">  /***/ (function(module, __webpack_exports__, __webpack_require__) &#123;  </span><br><span class="line">  &quot;use strict&quot;;</span><br><span class="line">  eval(&quot;__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./es6.js */ \&quot;./src/es6.js\&quot;);\nlet &#123;name, age, address&#125; = __webpack_require__(/*! ./common.js */ \&quot;./src/common.js\&quot;);\n\n\nconsole.log(name, Object(_es6_js__WEBPACK_IMPORTED_MODULE_0__[\&quot;default\&quot;])(10));\n\n\n//# sourceURL=webpack:///./src/index.js?&quot;);</span><br><span class="line"></span><br><span class="line">  /***/ &#125;)</span><br><span class="line"></span><br><span class="line">  /******/ &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¸Šé¢webpackæ‰“åŒ…çš„ä»£ç ï¼Œæ•´ä½“å¯ä»¥ç®€åŒ–æˆä¸‹é¢çš„ç»“æ„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(function (modules) &#123;/* xxxx */&#125;)</span><br><span class="line">(&#123;</span><br><span class="line">    &apos;./src/common.js&apos;: (function(module, exports) &#123;</span><br><span class="line">                /* æ¨¡å—common.jsçš„ä»£ç  */</span><br><span class="line">                eval(&quot;module.exports = &#123;\n\tage: 10,\n\tname: &apos;zhangsan&apos;,\n\taddress: function()&#123;\n\t\treturn &apos;dddd&apos;\n\t&#125;\n&#125;\n\n//# sourceURL=webpack:///./src/common.js?&quot;);</span><br><span class="line">                &#125;),</span><br><span class="line">    &apos;./src/es6.js&apos;: f()&#123;&#125;, /* æ¨¡å—es6.jsçš„ä»£ç  */</span><br><span class="line">    &apos;./src/index.js&apos;: f()&#123;&#125;, /* æ¨¡å—index.jsçš„ä»£ç  */</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>å…¥å£å¤„æ–‡ä»¶æœ€åç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var str = `__webpack_require__.r(__webpack_exports__);</span><br><span class="line">var _es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\&quot;./src/es6.js\&quot;);</span><br><span class="line">var &#123;name, age, address&#125; = __webpack_require__(\&quot;./src/common.js\&quot;);</span><br><span class="line">console.log(name, Object(_es6_js__WEBPACK_IMPORTED_MODULE_0__[\&quot;default\&quot;])(10));`;</span><br><span class="line">eval(str);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªæ‰“åŒ…ç”Ÿæˆçš„ä»£ç æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ã€‚</p>
</blockquote>
<p>é¦–å…ˆï¼šå‡½æ•°å‚æ•°æ˜¯æˆ‘ä»¬å†™çš„å„ä¸ªæ¨¡å—ç»„æˆçš„æ•°ç»„ï¼Œåªä¸è¿‡æˆ‘ä»¬çš„ä»£ç ï¼Œè¢«webpackåŒ…è£…åœ¨äº†ä¸€ä¸ªå‡½æ•°çš„å†…éƒ¨ï¼ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„æ¨¡å—ï¼‰ï¼Œåœ¨è¿™é‡Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œæ˜¯å› ä¸ºæµè§ˆå™¨æœ¬èº«ä¸æ”¯æŒæ¨¡å—åŒ–ï¼Œé‚£ä¹ˆwebpackå°±ç”¨å‡½æ•°ä½œç”¨åŸŸæ¥hackæ¨¡å—åŒ–çš„æ•ˆæœã€‚</p>
<p>å¦‚æœä½ debugè¿‡nodeä»£ç ï¼Œä½ ä¼šå‘ç°ä¸€æ ·çš„hackæ–¹å¼ï¼Œnodeä¸­çš„æ¨¡å—ä¹Ÿæ˜¯å‡½æ•°ï¼Œè·Ÿæ¨¡å—ç›¸å…³çš„å‚æ•°exportsã€requireï¼Œæˆ–è€…å…¶ä»–å‚æ•°<strong>filenameå’Œ</strong>dirnameç­‰éƒ½æ˜¯é€šè¿‡å‡½æ•°ä¼ å€¼ä½œä¸ºæ¨¡å—ä¸­çš„å˜é‡ï¼Œæ¨¡å—ä¸å¤–éƒ¨æ¨¡å—çš„è®¿é—®å°±æ˜¯é€šè¿‡è¿™äº›å‚æ•°è¿›è¡Œçš„ï¼Œå½“ç„¶è¿™å¯¹å¼€å‘è€…æ¥è¯´æ˜¯é€æ˜çš„ã€‚</p>
<p>åŒæ ·çš„æ–¹å¼ï¼Œwebpackä¹Ÿæ§åˆ¶äº†æ¨¡å—çš„moduleã€exportså’Œrequireï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çœ‹çœ‹webpackæ˜¯å¦‚ä½•å®ç°è¿™äº›åŠŸèƒ½çš„ã€‚</p>
<p>ä¸‹é¢æ˜¯æ‘˜å–çš„å‡½æ•°å†…å®¹å’Œä¸€äº›æ³¨é‡Šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 1ã€æ¨¡å—ç¼“å­˜å¯¹è±¡</span><br><span class="line">var installedModules = &#123;&#125;;</span><br><span class="line">// 2ã€webpackå®ç°çš„require</span><br><span class="line">function __webpack_require__(moduleId) &#123;</span><br><span class="line">    // 3ã€åˆ¤æ–­æ˜¯å¦å·²ç¼“å­˜æ¨¡å—</span><br><span class="line">    if(installedModules[moduleId]) &#123;</span><br><span class="line">        return installedModules[moduleId].exports;</span><br><span class="line">    &#125;</span><br><span class="line">    // 4ã€ç¼“å­˜æ¨¡å—</span><br><span class="line">    var module = installedModules[moduleId] = &#123;</span><br><span class="line">        i: moduleId,</span><br><span class="line">        l: false,</span><br><span class="line">        exports: &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    // 5ã€è°ƒç”¨æ¨¡å—å‡½æ•°</span><br><span class="line">    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);</span><br><span class="line">    // 6ã€æ ‡è®°æ¨¡å—ä¸ºå·²åŠ è½½</span><br><span class="line">    module.l = true;</span><br><span class="line">    // 7ã€è¿”å›module.exports</span><br><span class="line">    return module.exports;</span><br><span class="line">&#125;</span><br><span class="line">// 8ã€requireç¬¬ä¸€ä¸ªæ¨¡å—</span><br><span class="line">return __webpack_require__(__webpack_require__.s = 0);</span><br></pre></td></tr></table></figure>
<p>webpackä¹‹å‰çš„ç‰ˆæœ¬æ‰“è¿‡çš„å†…å®¹ï¼Œæ˜¯è¿™æ ·å­çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(function(module) &#123;</span><br><span class="line">&#125;)([(function ()&#123;&#125;), function() &#123;&#125;])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ¨¡å—æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥IIFEå‡½æ•°åï¼ŒIIFEåšäº†ä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼š<br>IIFEé¦–å…ˆå®šä¹‰äº†installedModules ï¼Œè¿™ä¸ªå˜é‡è¢«ç”¨æ¥ç¼“å­˜å·²åŠ è½½çš„æ¨¡å—ã€‚</p>
</blockquote>
<blockquote>
<p>å®šä¹‰äº†<strong>webpack_require</strong> è¿™ä¸ªå‡½æ•°ï¼Œå‡½æ•°å‚æ•°ä¸ºæ¨¡å—çš„idã€‚è¿™ä¸ªå‡½æ•°ç”¨æ¥å®ç°æ¨¡å—çš„requireã€‚</p>
</blockquote>
<blockquote>
<p><strong>webpack_require</strong> å‡½æ•°é¦–å…ˆä¼šæ£€æŸ¥æ˜¯å¦ç¼“å­˜äº†å·²åŠ è½½çš„æ¨¡å—ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ç¼“å­˜æ¨¡å—çš„exportsã€‚å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡åŠ è½½ï¼Œåˆ™é¦–å…ˆåˆå§‹åŒ–æ¨¡å—ï¼Œå¹¶å°†æ¨¡å—è¿›è¡Œç¼“å­˜ã€‚</p>
</blockquote>
<blockquote>
<p>ç„¶åè°ƒç”¨æ¨¡å—å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å‰é¢webpackå¯¹æˆ‘ä»¬çš„æ¨¡å—çš„åŒ…è£…å‡½æ•°ï¼Œå°†moduleã€module.exportså’Œ<strong>webpack_require</strong>ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚æ³¨æ„è¿™é‡Œåšäº†ä¸€ä¸ªåŠ¨æ€ç»‘å®šï¼Œå°†æ¨¡å—å‡½æ•°çš„è°ƒç”¨å¯¹è±¡ç»‘å®šmodule.exportsï¼Œè¿™æ˜¯ä¸ºäº†ä¿è¯åœ¨æ¨¡å—ä¸­çš„thisæŒ‡å‘å½“å‰æ¨¡å—ã€‚</p>
</blockquote>
<blockquote>
<p>è°ƒç”¨å®Œæˆåï¼Œæ¨¡å—æ ‡è®°ä¸ºå·²åŠ è½½ã€‚</p>
</blockquote>
<blockquote>
<p>è¿”å›æ¨¡å—exportsçš„å†…å®¹ã€‚</p>
</blockquote>
<blockquote>
<p>åˆ©ç”¨å‰é¢å®šä¹‰çš„<strong>webpack_require</strong> å‡½æ•°ï¼Œrequireç¬¬0ä¸ªæ¨¡å—ï¼Œä¹Ÿå°±æ˜¯å…¥å£æ¨¡å—ã€‚</p>
</blockquote>
<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>æ‰“åŒ…è¿‡çš„æ¨¡å—ç”Ÿæˆäº†ä¸€äº›ä»¥è‡ªæ‰§è¡Œå‡½æ•°å½¢å¼çš„é—­åŒ…ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/06/18/node requireä¸webpackæ¨¡å—åŒ–åŸç†/" data-id="cka3kmlcw000x7zo70rlam5yd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-å‰ç«¯å¼‚å¸¸ç›‘æ§" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/15/å‰ç«¯å¼‚å¸¸ç›‘æ§/" class="article-date">
  <time datetime="2018-06-15T09:23:30.000Z" itemprop="datePublished">2018-06-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/15/å‰ç«¯å¼‚å¸¸ç›‘æ§/">å‰ç«¯å¼‚å¸¸ç›‘æ§</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###å‰è¨€: JSå¼‚å¸¸å¤„ç†ç®€ä»‹</p>
<p>æ¯å¤©è°ƒè¯•ä¼šçœ‹åˆ°æ§åˆ¶å°å„ç§å„å¼çš„çº¢è‰²é”™è¯¯ä»£ç ã€‚</p>
<p>JavaScripté”™è¯¯æ˜¯æ€ä¹ˆè¾“å‡ºåˆ°æ§åˆ¶å°çš„  â€”â€”  JavaScriptçš„é”™è¯¯å¤„ç†åŸç†ã€‚</p>
<p>å½“æŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒJavaScriptè§£é‡Šå™¨ä¼šç«‹å³åœä¸‹å½“å‰æ­£åœ¨æ‰§è¡Œçš„é€»è¾‘ï¼Œå¹¶ä¸”è·³åˆ°æœ€è¿‘çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼ˆå¯ä»¥å‚è€ƒå†’æ³¡ä¸å˜é‡ä½œç”¨åŸŸçš„ç›¸å…³æ¦‚å¿µã€‚ä¸€å¥è¯ç®€å•ç†è§£ï¼šå„¿å­çŠ¯äº†é”™è¯¯ï¼Œæ‰¾è€å­ï¼Œä¸€å±‚ä¸€å±‚å¾€ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°èƒ½å¤Ÿæ‰¿æ‹…é”™è¯¯çš„å¯¹è±¡ä¸ºæ­¢ï¼‰ã€‚å¦‚æœåœ¨æ‰€æœ‰çš„è¯æ³•ç»“æ„å’Œè°ƒç”¨æ ˆä¸Šé¢æ²¡æœ‰æ‰¾åˆ°é”™è¯¯å¤„ç†ç¨‹åºã€‚JavaScriptå°±ä¼šæŠŠå¼‚å¸¸å½“åšç¨‹åºé”™è¯¯å¤„ç†ï¼Œå¹¶æŠ¥å‘Šç»™ç”¨æˆ·ã€‚</p>
<blockquote>
<p>åªè¦æœ‰å¼‚å¸¸å¯¹è±¡æŠ›å‡ºï¼Œä¸ç®¡æ˜¯æµè§ˆå™¨æŠ›å‡ºçš„ï¼Œè¿˜æ˜¯ä»£ç ä¸»åŠ¨æŠ›å‡ºï¼Œéƒ½ä¼šè®©ç¨‹åºåœæ­¢æ‰§è¡Œã€‚å¦‚æœæƒ³è®©ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œåˆ™æœ‰ä¹Ÿå¯ä»¥ç”¨tryâ€¦catchæ¥æ•è·ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  error</span><br><span class="line">  console.log(&apos;æ°¸è¿œä¸ä¼šæ‰§è¡Œ&apos;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  console.log(&apos;æˆ‘ç»§ç»­æ‰§è¡Œ&apos;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å†è§£é‡Šä¸€ä¸‹ï¼š</p>
<blockquote>
<p>1.å½“å‰ä»£ç å—å°†ä½œä¸ºä¸€ä¸ªä»»åŠ¡å‹å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼ŒJavaScriptçº¿ç¨‹ä¼šä¸æ–­åœ°ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­æå–ä»»åŠ¡æ‰§è¡Œï¼›</p>
</blockquote>
<blockquote>
<p>2.å½“ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ¥å¼‚å¸¸ï¼Œä¸”å¼‚å¸¸æ²¡æœ‰æ•è·å¤„ç†ï¼Œåˆ™ä¼šä¸€è·¯æ²¿ç€è°ƒç”¨æ ˆä»é¡¶åˆ°åº•æŠ›å‡ºï¼Œæœ€ç»ˆç»ˆæ­¢å½“å‰ä»»åŠ¡çš„æ‰§è¡Œï¼›</p>
</blockquote>
<blockquote>
<p>3.JavaScriptçº¿ç¨‹ä¼šç»§ç»­ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­æå–ä¸‹ä¸€ä¸ªä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚</p>
</blockquote>
<h3 id="ä¸€ã€æ”¶é›†æ—¥å¿—çš„æ–¹æ³•"><a href="#ä¸€ã€æ”¶é›†æ—¥å¿—çš„æ–¹æ³•" class="headerlink" title="ä¸€ã€æ”¶é›†æ—¥å¿—çš„æ–¹æ³•"></a>ä¸€ã€æ”¶é›†æ—¥å¿—çš„æ–¹æ³•</h3><p>å¹³æ—¶æ”¶é›†æ—¥å¿—çš„æ‰‹æ®µï¼Œå¯ä»¥å½’ç±»ä¸ºä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯é€»è¾‘ä¸­çš„é”™è¯¯åˆ¤æ–­ï¼Œä¸ºä¸»åŠ¨åˆ¤æ–­ï¼›ä¸€ä¸ªæ˜¯åˆ©ç”¨è¯­è¨€ç»™æˆ‘ä»¬æä¾›çš„æ·å¾„ï¼Œæš´åŠ›å¼è·å–é”™è¯¯ä¿¡æ¯ï¼Œå¦‚ try..catch å’Œ window.onerrorç­‰</p>
<h5 id="1-ä¸»åŠ¨åˆ¤æ–­"><a href="#1-ä¸»åŠ¨åˆ¤æ–­" class="headerlink" title="1. ä¸»åŠ¨åˆ¤æ–­"></a>1. ä¸»åŠ¨åˆ¤æ–­</h5><p>æˆ‘ä»¬åœ¨ä¸€äº›è¿ç®—ä¹‹åï¼Œå¾—åˆ°ä¸€ä¸ªæœŸæœ›çš„ç»“æœï¼Œç„¶è€Œç»“æœä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// test.js</span><br><span class="line">function calc()&#123;</span><br><span class="line">  // sth code...</span><br><span class="line">  return val;</span><br><span class="line">&#125;</span><br><span class="line">if(calc() !== &quot;someVal&quot;)&#123;</span><br><span class="line">  Reporter.send(xxx);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§å±äºé€»è¾‘é”™è¯¯/çŠ¶æ€é”™è¯¯çš„åé¦ˆï¼Œåœ¨æ¥å£çŠ¶æ€åˆ¤æ–­ä¸­ç”¨çš„æ¯”è¾ƒå¤šã€‚</p>
<p>#####2. try..catch æ•è·<br>åˆ¤æ–­ä¸€ä¸ªä»£ç æ®µä¸­å­˜åœ¨çš„é”™è¯¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">  init();</span><br><span class="line">  // code...</span><br><span class="line">&#125; catch(e)&#123;</span><br><span class="line">  Reporter.send(format(e));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ init ä¸ºç¨‹åºçš„å…¥å£ï¼Œä»£ç ä¸­æ‰€æœ‰åŒæ­¥æ‰§è¡Œå‡ºç°çš„é”™è¯¯éƒ½ä¼šè¢«æ•è·ï¼Œè¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥å¾ˆå¥½çš„é¿å…ç¨‹åºåˆšè·‘èµ·æ¥å°±æŒ‚æ‰ã€‚</p>
<h5 id="3-window-onerror"><a href="#3-window-onerror" class="headerlink" title="3. window.onerror"></a>3. window.onerror</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">window.onerror = function() &#123;</span><br><span class="line">  var errInfo = format(arguments);</span><br><span class="line">  Reporter.send(errInfo);</span><br><span class="line">  return true;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>(ä¸Šæ–‡ä¸­è¿”å›trueæ—¶ï¼Œä¾¿ä¸ä¼šæŠŠé”™è¯¯æš´éœ²åœ¨æ§åˆ¶å°ä¸­)</p>
<h3 id="äºŒã€ä¼šå‡ºç°çš„é—®é¢˜æˆ–æ³¨æ„äº‹é¡¹æˆ–è§£å†³åŠæ³•"><a href="#äºŒã€ä¼šå‡ºç°çš„é—®é¢˜æˆ–æ³¨æ„äº‹é¡¹æˆ–è§£å†³åŠæ³•" class="headerlink" title="äºŒã€ä¼šå‡ºç°çš„é—®é¢˜æˆ–æ³¨æ„äº‹é¡¹æˆ–è§£å†³åŠæ³•"></a>äºŒã€ä¼šå‡ºç°çš„é—®é¢˜æˆ–æ³¨æ„äº‹é¡¹æˆ–è§£å†³åŠæ³•</h3><h5 id="å…³äºwindow-onerror-çš„ä½¿ç”¨"><a href="#å…³äºwindow-onerror-çš„ä½¿ç”¨" class="headerlink" title="å…³äºwindow.onerror çš„ä½¿ç”¨"></a>å…³äºwindow.onerror çš„ä½¿ç”¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// test.js</span><br><span class="line">throw new Error(&quot;SHOW ME&quot;);</span><br><span class="line">window.onerror = function()&#123;</span><br><span class="line">	console.log(arguments);</span><br><span class="line">	// é˜»æ­¢åœ¨æ§åˆ¶å°ä¸­æ‰“å°é”™è¯¯ä¿¡æ¯</span><br><span class="line">	return true;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ç›´æ¥æŠ¥é”™äº†ï¼Œæ²¡æœ‰ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚é¡µé¢ä¸­å¯èƒ½æœ‰å¥½å‡ ä¸ª script æ ‡ç­¾ï¼Œä½†æ˜¯ window.onerror è¿™ä¸ªé”™è¯¯ç›‘å¬ä¸€å®šè¦æ”¾åˆ°æœ€å‰å¤´ï¼</p>
<h5 id="å…³äº-try-catch-çš„ä½¿ç”¨"><a href="#å…³äº-try-catch-çš„ä½¿ç”¨" class="headerlink" title="å…³äº try..catch çš„ä½¿ç”¨"></a>å…³äº try..catch çš„ä½¿ç”¨</h5><p>å¯¹äº try..catch çš„ä½¿ç”¨ï¼Œä¸€èˆ¬å»ºè®®æ˜¯ï¼šèƒ½ä¸ç”¨ï¼Œå°½é‡ä¸è¦ç”¨ã€‚JSä»£ç éƒ½æ˜¯è‡ªå·±å†™å‡ºæ¥çš„ï¼Œå“ªé‡Œä¼šå‡ºç°é—®é¢˜ï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œå¿ƒä¸­åº”è¯¥éƒ½æœ‰ä¸ªè°±ï¼Œå¹³æ—¶ç”¨åˆ° try..catch çš„ä¸€èˆ¬åªæœ‰ä¸¤ä¸ªåœ°æ–¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// JSON æ ¼å¼ä¸å¯¹</span><br><span class="line">try&#123;</span><br><span class="line">  JSON.parse(JSONString);</span><br><span class="line">&#125;catch(e)&#123;&#125;</span><br><span class="line"></span><br><span class="line">// å­˜åœ¨ä¸å¯ decode çš„å­—ç¬¦</span><br><span class="line">try&#123;</span><br><span class="line">  decodeURIComponent(&quot;%111&quot;)</span><br><span class="line">&#125;catch(e)&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸èƒ½æ•è·å¼‚æ­¥çš„é”™è¯¯ï¼Œpromiseã€setTimeoutç­‰å¼‚å¸¸</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    console.log(1);</span><br><span class="line">    setTimeout(function () &#123;</span><br><span class="line">        console.log(2);</span><br><span class="line">        JSON.parse(&apos;&#123;&#123;&#125;&apos;);</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">    console.log(3);</span><br><span class="line">&#125; catch (err) &#123;</span><br><span class="line">    console.log(&apos;55&apos;); //æ˜¯æ•è·ä¸åˆ°çš„</span><br><span class="line">&#125;</span><br><span class="line">console.log(4);</span><br></pre></td></tr></table></figure>
<h4 id="å¦‚ä½•ç›‘å¬promiseé”™è¯¯"><a href="#å¦‚ä½•ç›‘å¬promiseé”™è¯¯" class="headerlink" title="å¦‚ä½•ç›‘å¬promiseé”™è¯¯"></a>å¦‚ä½•ç›‘å¬promiseé”™è¯¯</h4><p>ï¼ˆå…³äºäº‹ä»¶ unhandledrejectionã€rejectionhandledï¼‰</p>
<blockquote>
<p>h5æ–°å¢çš„äº‹ä»¶ï¼›</p>
</blockquote>
<h5 id="unhandledrejection"><a href="#unhandledrejection" class="headerlink" title="unhandledrejection"></a>unhandledrejection</h5><p>å½“Promise è¢«rejectå¹¶ä¸”æ²¡æœ‰å¾—åˆ°å¤„ç†çš„æ—¶å€™ï¼Œä¼šè§¦å‘unhandledrejectionäº‹ä»¶ã€‚<br>unhandledrejectionç»§æ‰¿è‡ªPromiseRejectionEventï¼ŒPromiseRejectionEventåˆç»§æ‰¿è‡ªEventã€‚å› æ­¤unhandledrejectionå«æœ‰PromiseRejectionEventå’ŒEventçš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<h5 id="rejectionhandled"><a href="#rejectionhandled" class="headerlink" title="rejectionhandled"></a>rejectionhandled</h5><p>å½“ä¸€ä¸ªPromiseé”™è¯¯æœ€åˆæœªè¢«å¤„ç†ï¼Œä½†æ˜¯ç¨ååˆå¾—åˆ°äº†å¤„ç†ï¼Œåˆ™ä¼šè§¦å‘rejectionhandledäº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&apos;error&apos;, error =&gt; &#123;</span><br><span class="line">    debugger;</span><br><span class="line">    console.log(&apos;error ç›‘å¬&apos;,error); // ä¸ä¼šè§¦å‘,è¿™é‡Œä¸ä¼š</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">window.addEventListener(&apos;unhandledrejection&apos;, event =&gt; &#123;</span><br><span class="line">    debugger;</span><br><span class="line">    console.log(event.reason); // æ‰“å°&quot;å•¦å•¦å•¦å•¦ reject&quot;</span><br><span class="line">&#125;);</span><br><span class="line">window.addEventListener(&apos;rejectionhandled&apos;, event =&gt; &#123;</span><br><span class="line">    debugger;</span><br><span class="line">    console.log(&apos;rejection handled&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">function foo() &#123;</span><br><span class="line">    return Promise.reject(&apos;å•¦å•¦å•¦å•¦ reject&apos;);</span><br><span class="line">&#125;</span><br><span class="line">var r = foo();</span><br><span class="line"></span><br><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line">    r.catch(e =&gt; &#123; &#125;);</span><br><span class="line">&#125;, 1000);</span><br></pre></td></tr></table></figure>
<h5 id="æ— å…·ä½“æŠ¥é”™ä¿¡æ¯ï¼Œåªæœ‰Script-error"><a href="#æ— å…·ä½“æŠ¥é”™ä¿¡æ¯ï¼Œåªæœ‰Script-error" class="headerlink" title="æ— å…·ä½“æŠ¥é”™ä¿¡æ¯ï¼Œåªæœ‰Script error"></a>æ— å…·ä½“æŠ¥é”™ä¿¡æ¯ï¼Œåªæœ‰Script error</h5><blockquote>
<p>éœ€è¦è®¾ç½® crossorigin å¹¶ä¸”æœåŠ¡å™¨è¦è®¾ç½® Access-Control-Allow-Origin çš„å“åº”å¤´(è¢«å¼•ç”¨çš„èµ„æºé“¾)ï¼š</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;http://localhost/test.js&quot; crossorigin&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™ç§ç®€å•æŠ¥é”™ï¼š Script errorï¼Œç›®çš„æ˜¯é¿å…æ•°æ®æ³„éœ²åˆ°ä¸å®‰å…¨çš„åŸŸä¸­</p>
</blockquote>
<blockquote>
<p>crossOriginå‚æ•° è·³è¿‡è·¨åŸŸé™åˆ¶<br>image å’Œ script æ ‡ç­¾éƒ½æœ‰æ­¤å‚æ•°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼Œæˆ‘è¦åŠ è½½ä¸€ä¸ªå¤–åŸŸçš„èµ„æºï¼Œå¹¶ä¸”æˆ‘ä¿¡ä»»è¿™ä¸ªèµ„æºã€‚</p>
</blockquote>
<h5 id="try-catch-æ‹¦æˆªéåŒåŸŸçš„è„šæœ¬é”™è¯¯ï¼ˆè·¨åŸŸè„šæœ¬é”™è¯¯ï¼‰"><a href="#try-catch-æ‹¦æˆªéåŒåŸŸçš„è„šæœ¬é”™è¯¯ï¼ˆè·¨åŸŸè„šæœ¬é”™è¯¯ï¼‰" class="headerlink" title="try catch æ‹¦æˆªéåŒåŸŸçš„è„šæœ¬é”™è¯¯ï¼ˆè·¨åŸŸè„šæœ¬é”™è¯¯ï¼‰"></a>try catch æ‹¦æˆªéåŒåŸŸçš„è„šæœ¬é”™è¯¯ï¼ˆè·¨åŸŸè„šæœ¬é”™è¯¯ï¼‰</h5><ul>
<li>é¦–å…ˆï¼šæµè§ˆå™¨ä¸ä¼šå¯¹try-catchèµ·æ¥çš„å¼‚å¸¸è¿›è¡Œæ‹¦æˆª</li>
</ul>
<p>æ‰€ä»¥ï¼ŒåŠ«æŒåŸç”Ÿæ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const nativeAddEventListener = EventTarget.prototype.addEventListener;</span><br><span class="line">EventTarget.prototype.addEventListener = function (type, func, options) &#123; // é‡å†™åŸç”Ÿæ–¹æ³•</span><br><span class="line">    const wrappedFunc = function (...args) &#123; // å°†å›è°ƒå‡½æ•°åŒ…è£¹ä¸€å±‚try catch</span><br><span class="line">        try &#123; </span><br><span class="line">            return func.apply(this, args);</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">            const errorObj = &#123;</span><br><span class="line">                ...</span><br><span class="line">                error_name: e.name || &apos;&apos;,</span><br><span class="line">                error_msg: e.message || &apos;&apos;,</span><br><span class="line">                error_stack: e.stack || (e.error &amp;amp;&amp;amp; e.error.stack),</span><br><span class="line">                error_native: e,</span><br><span class="line">                ...</span><br><span class="line">            &#125;;</span><br><span class="line">            // æ¥ä¸‹æ¥å¯ä»¥å°†errorObjç»Ÿä¸€è¿›è¡Œå¤„ç†ã€‚</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return nativeAddEventListener.call(this, type, wrappedFunc, options); // è°ƒç”¨åŸç”Ÿçš„æ–¹æ³•ï¼Œä¿è¯addEventListeneræ­£ç¡®æ‰§è¡Œ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="async-await-å’Œæ•è·å¼‚å¸¸"><a href="#async-await-å’Œæ•è·å¼‚å¸¸" class="headerlink" title="async/await å’Œæ•è·å¼‚å¸¸"></a>async/await å’Œæ•è·å¼‚å¸¸</h5><p>ä½œä¸ºå¼‚æ­¥çš„ä¸­çº§æ–¹æ¡ˆï¼Œcatchå¼‚å¸¸ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var sleep = function (time) &#123;</span><br><span class="line">    return new Promise(function (resolve, reject) &#123;</span><br><span class="line">        setTimeout(function () &#123;</span><br><span class="line">            reject(&apos;error&apos;);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var func = async function () &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        console.log(&apos;start&apos;);</span><br><span class="line">        await sleep(1000); // è¿™é‡Œå¾—åˆ°äº†ä¸€ä¸ªè¿”å›é”™è¯¯</span><br><span class="line">        </span><br><span class="line">        // æ‰€ä»¥ä»¥ä¸‹ä»£ç ä¸ä¼šè¢«æ‰§è¡Œäº†</span><br><span class="line">        console.log(&apos;end&apos;);</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">        console.log(&apos;catchå†…å®¹ï¼š&apos;, err); // è¿™é‡Œæ•æ‰åˆ°é”™è¯¯ `error`</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">func();</span><br></pre></td></tr></table></figure>
<p>#####æœ‰iframeçš„é¡µé¢æ€ä¹ˆç›‘å¬ï¼Ÿ</p>
<ul>
<li>åŒæº</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.frames[0].onerror = function (msg, url, row, col, error) &#123;</span><br><span class="line">    console.log(&#123;</span><br><span class="line">      msg,  url,  row, col, error</span><br><span class="line">    &#125;)</span><br><span class="line">    return true;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>éåŒæºï¼ˆåŒ…æ‹¬å¯æ§ä¸ä¸å¯æ§ï¼‰<br>å¯æ§çš„ç±»ä¼¼å¯ä»¥å®è¡Œè·¨åŸŸé‚£ä¸€å¥—ã€‚postMessageç­‰ç­‰ã€‚</li>
</ul>
<p>ç•¥</p>
<h4 id="å…³äºç½‘ç»œè¯·æ±‚çš„"><a href="#å…³äºç½‘ç»œè¯·æ±‚çš„" class="headerlink" title="å…³äºç½‘ç»œè¯·æ±‚çš„"></a>å…³äºç½‘ç»œè¯·æ±‚çš„</h4><p>ç”±äºç½‘ç»œè¯·æ±‚å¼‚å¸¸ä¸ä¼šå†’æ³¡ï¼Œå› æ­¤å¿…é¡»åœ¨captureé˜¶æ®µæ•è·æ‰å¯ä»¥ã€‚ä½†è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯è¿™ç§æ–¹å¼æ— æ³•ç²¾ç¡®åˆ¤æ–­å¼‚å¸¸çš„HTTPçŠ¶æ€æ˜¯404è¿˜æ˜¯500ç­‰ï¼Œå› æ­¤è¿˜æ˜¯è¦é…åˆæœåŠ¡ç«¯æ—¥å¿—æ¥æ’æŸ¥åˆ†ææ‰å¯ä»¥ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™ç§æƒ…å†µä¸‹onerror æ˜¯æ— æ³•å¸®åŠ©æˆ‘ä»¬æ•è·åˆ°å¼‚å¸¸çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  window.onerror = function (msg, url, row, col, error) &#123;</span><br><span class="line">    console.log(&apos;æˆ‘çŸ¥é“å¼‚æ­¥é”™è¯¯äº†&apos;);</span><br><span class="line">    console.log(&#123;</span><br><span class="line">      msg,  url,  row, col, error</span><br><span class="line">    &#125;)</span><br><span class="line">    return true;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">//html</span><br><span class="line">&lt;img src=&quot;./404.png&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>å¿…é¡»è¦ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&quot;error&quot;, function(e)&#123;</span><br><span class="line">    debugger;</span><br><span class="line">    console.log(&apos;æŠ¥é”™äº†å•¦å•¦&apos;, e.bubbles)</span><br><span class="line">&#125;,   true);</span><br><span class="line"></span><br><span class="line">//html</span><br><span class="line">&lt;img src=&quot;404.jpg&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="æ¡†æ¶é‡Œé¢çš„é—®é¢˜"><a href="#æ¡†æ¶é‡Œé¢çš„é—®é¢˜" class="headerlink" title="æ¡†æ¶é‡Œé¢çš„é—®é¢˜"></a>æ¡†æ¶é‡Œé¢çš„é—®é¢˜</h4><p>ç°åœ¨è¶Šæ¥è¶Šå¤šçš„é¡¹ç›®å¼€å§‹ä½¿ç”¨å‰ç«¯æ¡†æ¶ï¼Œåœ¨MVVMæ¡†æ¶ä¸­å¦‚æœä½ ä¸€å¦‚æ—¢å¾€çš„æƒ³ä½¿ç”¨window.onerroræ¥æ•è·å¼‚å¸¸ï¼Œå¾ˆå¯èƒ½ä¸å¥½ä½¿ï¼Œæˆ–è®¸æ ¹æœ¬æ•è·ä¸åˆ°ï¼Œå› ä¸ºä½ çš„å¼‚å¸¸ä¿¡æ¯è¢«æ¡†æ¶è‡ªèº«çš„å¼‚å¸¸æœºåˆ¶æ•è·äº†ã€‚<br>æ¯”å¦‚Vue ä¸­æˆ‘ä»¬åº”è¯¥è¿™æ ·æ•è·å…¨å±€å¼‚å¸¸ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.errorHandler = function (err, vm, info) &#123;</span><br><span class="line">    let &#123; </span><br><span class="line">        message, // å¼‚å¸¸ä¿¡æ¯</span><br><span class="line">        name, // å¼‚å¸¸åç§°</span><br><span class="line">        script,  // å¼‚å¸¸è„šæœ¬url</span><br><span class="line">        line,  // å¼‚å¸¸è¡Œå·</span><br><span class="line">        column,  // å¼‚å¸¸åˆ—å·</span><br><span class="line">        stack  // å¼‚å¸¸å †æ ˆä¿¡æ¯</span><br><span class="line">    &#125; = err;</span><br><span class="line"></span><br><span class="line">    // vmä¸ºæŠ›å‡ºå¼‚å¸¸çš„ Vue å®ä¾‹</span><br><span class="line">    // infoä¸º Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ï¼Œreact 16é‡Œé¢æä¾›äº†componentDidCatchæ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥æ•è·reactç»„ä»¶é‡Œé¢çš„å¼‚å¸¸æ¥ç›´æ¥ä¸ŠæŠ¥ã€‚è¿™æ ·å…¶å®å¯¹äºreactçš„åœºæ™¯å°±æ›´ç®€å•äº†ã€‚å®ƒèƒ½æ•è·åœ¨å­ç»„ä»¶æ ‘ä¸­ä»»ä½•åœ°æ–¹çš„ JavaScript å¼‚å¸¸ï¼Œå¹¶æ‰“å°è¿™äº›é”™è¯¯å’Œå±•ç¤ºå¤‡ç”¨UI, å°±åƒå°† children åŒ…è£¹åœ¨ä¸€ä¸ªå¤§çš„ try/catch è¯­å¥å—ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">let Com = function()&#123;</span><br><span class="line">    return (&lt;div&gt;        </span><br><span class="line">        &lt;ErrorHandler&gt;</span><br><span class="line">            &lt;TestState/&gt;</span><br><span class="line">        &lt;/ErrorHandler&gt;</span><br><span class="line">    &lt;/div&gt;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;Com/&gt;, document.getElementById(&apos;root&apos;));</span><br><span class="line"></span><br><span class="line">class ErrorHandler extends React.Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.state = &#123; hasError: false &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidCatch(error, info) &#123;</span><br><span class="line">        console.log(&apos;err.&apos;, error);</span><br><span class="line">        this.setState(&#123; hasError: true &#125;);</span><br><span class="line">        // report(error, info);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        if (this.state.hasError) &#123;</span><br><span class="line">            return &lt;h1&gt;è¿™æ˜¯æŠ¥é”™é¡µé¢&lt;/h1&gt;;</span><br><span class="line">        &#125;</span><br><span class="line">        return this.props.children;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//åœ¨å­ç»„ä»¶ä¸­</span><br><span class="line">//throw Error(&apos;æˆ‘é”™å•¦&apos;);</span><br></pre></td></tr></table></figure>
<h2 id="å®šä½é”™è¯¯"><a href="#å®šä½é”™è¯¯" class="headerlink" title="å®šä½é”™è¯¯"></a>å®šä½é”™è¯¯</h2><p>æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç ç»webpackã€gulpç­‰æ‰“åŒ…å‹ç¼©åäº§ç”Ÿå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!function(n)&#123;function t(e)&#123;if(r[e])return r[e].exports;var o=r[e]=&#123;i:e,l:!1,exports:&#123;&#125;&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ§åˆ¶å°ä¼šçœ‹åˆ°å¯¹åº”çš„æ•°æ®ï¼š<br>ä»£ç å¦‚æœŸæŠ¥é”™ï¼Œå¹¶ä¸ŠæŠ¥ç›¸å…³ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; msg: &apos;Uncaught ReferenceError: xxx is not defined&apos;,</span><br><span class="line">  url: &apos;http://xxx/xxx.min.js&apos;,</span><br><span class="line">  row: &apos;10&apos;,</span><br><span class="line">  col: &apos;1000&apos; &#125;</span><br></pre></td></tr></table></figure>
<p>ç»“åˆå‹ç¼©åçš„ä»£ç ï¼Œè‚‰çœ¼è§‚å¯Ÿå¾ˆéš¾å®šä½å‡ºå…·ä½“é—®é¢˜</p>
<p>é‚£æˆ‘ä»¬å¦‚ä½•å®šä½åˆ°é”™è¯¯å‘¢ï¼Ÿ</p>
<p>æ–¹æ³•ä¸€ï¼šä¸å‹ç¼© js ä»£ç </p>
<p>æ–¹æ³•äºŒï¼šå°†å‹ç¼©ä»£ç ä¸­åˆ†å·å˜æˆæ¢è¡Œ</p>
<p>æ–¹æ¡ˆä¸‰ï¼šjs ä»£ç åŠå‹ç¼©(ä¿ç•™ç©ºæ ¼å’Œæ¢è¡Œ)</p>
<p>uglifyjs çš„å¦ä¸€é…ç½®å‚æ•° beautify è®¾ç½®ä¸º true æ—¶ï¼Œæœ€ç»ˆä»£ç å°†å‘ˆç°å‹ç¼©åè¿›è¡Œæ ¼å¼åŒ–çš„æ•ˆæœï¼ˆä¿ç•™ç©ºæ ¼å’Œæ¢è¡Œï¼‰ï¼Œå¦‚</p>
<p>æ–¹æ¡ˆå››ï¼šSourceMap å¿«é€Ÿå®šä½</p>
<blockquote>
<p>æˆ‘ä»¬ç›®å‰çš„åŠæ³•æ˜¯ç”¨chromeçš„DevToolsè¿™æ ·çš„è¾…åŠ©å·¥å…·ã€‚è€Œä¸”å¹¶ä¸æ˜¯æ¯ä¸ªçº¿ä¸Šèµ„æºéƒ½ä¼šæ·»åŠ  sourceMap æ–‡ä»¶</p>
</blockquote>
<h5 id="sourceMap"><a href="#sourceMap" class="headerlink" title="sourceMap"></a>sourceMap</h5><p>SourceMap æ˜¯ä¸€ä¸ªä¿¡æ¯æ–‡ä»¶ï¼Œå­˜å‚¨ç€æºæ–‡ä»¶çš„ä¿¡æ¯åŠæºæ–‡ä»¶ä¸å¤„ç†åæ–‡ä»¶çš„æ˜ å°„å…³ç³»ã€‚ é‡Œé¢å‚¨å­˜ç€ä½ç½®ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè½¬æ¢åçš„ä»£ç çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œæ‰€å¯¹åº”çš„è½¬æ¢å‰çš„ä½ç½®ã€‚</p>
<p>æˆ‘ä»¬åœ¨å®šä½å‹ç¼©ä»£ç çš„æŠ¥é”™æ—¶ï¼Œå¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯çš„è¡Œåˆ—æ•°ä¸å¯¹åº”çš„ SourceMap æ–‡ä»¶ï¼Œå¤„ç†åå¾—åˆ°æºæ–‡ä»¶çš„å…·ä½“é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>æ‰“å¼€Source mapæ–‡ä»¶ï¼Œå®ƒå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	version : 3,</span><br><span class="line">ã€€ã€€file: &quot;out.js&quot;,</span><br><span class="line">ã€€ã€€sourceRoot : &quot;&quot;,</span><br><span class="line">ã€€ã€€sources: [&quot;a.js&quot;, &quot;b.js&quot;],</span><br><span class="line">ã€€ã€€names: [&quot;src&quot;, &quot;maps&quot;, &quot;are&quot;, &quot;fun&quot;],</span><br><span class="line">ã€€ã€€mappings: &quot;AAgBC,SAAQ,CAAEA&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>versionï¼šSource mapçš„ç‰ˆæœ¬ï¼Œç›®å‰ä¸º3ã€‚</li>
<li>fileï¼šè½¬æ¢åçš„æ–‡ä»¶åã€‚</li>
<li>sourceRootï¼šè½¬æ¢å‰çš„æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚å¦‚æœä¸è½¬æ¢å‰çš„æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ï¼Œè¯¥é¡¹ä¸ºç©ºã€‚</li>
<li>sourcesï¼šè½¬æ¢å‰çš„æ–‡ä»¶ã€‚è¯¥é¡¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºå¯èƒ½å­˜åœ¨å¤šä¸ªæ–‡ä»¶åˆå¹¶ã€‚</li>
<li>namesï¼šè½¬æ¢å‰çš„æ‰€æœ‰å˜é‡åå’Œå±æ€§åã€‚</li>
<li>mappingsï¼šè®°å½•ä½ç½®ä¿¡æ¯çš„å­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>åº”ç”¨ä¸¾ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&apos;fs&apos;);</span><br><span class="line">var sourceMap = require(&apos;source-map&apos;);</span><br><span class="line"></span><br><span class="line">// mapæ–‡ä»¶</span><br><span class="line">var rawSourceMapJsonData = fs.readFileSync(&apos;./index.min.js.map&apos;, &apos;utf-8&apos;)</span><br><span class="line">rawSourceMapJsonData = JSON.parse(rawSourceMapJsonData)</span><br><span class="line"></span><br><span class="line">var consumer = new sourceMap.SourceMapConsumer(rawSourceMapJsonData);</span><br><span class="line"></span><br><span class="line">// å¾—åˆ°çœŸå®é”™è¯¯ä½ç½®</span><br><span class="line">console.log(consumer.originalPositionFor(&#123;line: 1, column: 100&#125;))</span><br></pre></td></tr></table></figure>
<p><a href="http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html" target="_blank" rel="noopener">é˜®ä¸€å³°JavaScript Source Map è¯¦è§£</a></p>
<p><a href="https://github.com/swingboy/errorMonitor" target="_blank" rel="noopener">ç¤ºä¾‹ä»£ç </a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/06/15/å‰ç«¯å¼‚å¸¸ç›‘æ§/" data-id="cka3kmld000177zo7kkzb9klo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/12/å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹/" class="article-date">
  <time datetime="2018-04-12T12:18:56.000Z" itemprop="datePublished">2018-04-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/12/å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹/">å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹</p>
<h3 id="è·¯ç”±å®ç°"><a href="#è·¯ç”±å®ç°" class="headerlink" title="è·¯ç”±å®ç°"></a>è·¯ç”±å®ç°</h3><h4 id="ä¸€ã€hashchange"><a href="#ä¸€ã€hashchange" class="headerlink" title="ä¸€ã€hashchange"></a>ä¸€ã€hashchange</h4><p>å›å¿†åŸºç¡€çŸ¥è¯†ï¼š<br></p>
<p>1ã€hashå³URLä¸­â€#â€å­—ç¬¦åé¢çš„éƒ¨åˆ†ã€‚(location.hash çœ‹ä¸‹)</p>
<p>ã€€ã€€â‘ ä½¿ç”¨æµè§ˆå™¨è®¿é—®ç½‘é¡µæ—¶ï¼Œå¦‚æœç½‘é¡µURLä¸­å¸¦æœ‰hashï¼Œé¡µé¢å°±ä¼šå®šä½åˆ°idï¼ˆæˆ–nameï¼‰ä¸hashå€¼ä¸€æ ·çš„å…ƒç´ çš„ä½ç½®ï¼›</p>
<p>ã€€ã€€â‘¡hashè¿˜æœ‰å¦ä¸€ä¸ªç‰¹ç‚¹ï¼Œå®ƒçš„æ”¹å˜ä¸ä¼šå¯¼è‡´é¡µé¢é‡æ–°åŠ è½½ï¼›</p>
<p>ã€€ã€€â‘¢hashå€¼æµè§ˆå™¨æ˜¯ä¸ä¼šéšè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ç«¯çš„ï¼›</p>
<p>ã€€ã€€â‘£é€šè¿‡window.location.hashå±æ€§è·å–å’Œè®¾ç½®hashå€¼ã€‚</p>
<blockquote>
<p>window.location.hashå€¼çš„å˜åŒ–ä¼šç›´æ¥ååº”åˆ°æµè§ˆå™¨åœ°å€æ ï¼ˆ#åé¢çš„éƒ¨åˆ†ä¼šå‘ç”Ÿå˜åŒ–ï¼‰ï¼ŒåŒæ—¶ï¼Œæµè§ˆå™¨åœ°å€æ hashå€¼çš„å˜åŒ–ä¹Ÿä¼šè§¦å‘window.location.hashå€¼çš„å˜åŒ–ï¼Œä»è€Œè§¦å‘onhashchangeäº‹ä»¶ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">//å®ç°å®ä¾‹</span><br><span class="line">&lt;div class=&quot;main&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;menu&quot;&gt;</span><br><span class="line">            &lt;a href=&quot;/&quot;&gt;é¦–é¡µ&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;/profile&quot;&gt;ä¸ªäººä¸­å¿ƒ&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;/articles&quot;&gt;æ–‡ç« åˆ—è¡¨&lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;content&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        const $ = (selector) =&gt; document.querySelector(selector);</span><br><span class="line">        const routeMap = &#123;</span><br><span class="line">            &apos;/&apos;: () =&gt; &#123;</span><br><span class="line">                const content = $(&apos;.content&apos;);</span><br><span class="line">                content.innerHTML = &apos;&lt;div&gt;the Home Page&lt;/div&gt;&apos;;</span><br><span class="line">            &#125;,</span><br><span class="line">            &apos;/profile&apos;: () =&gt; &#123;</span><br><span class="line">                const content = $(&apos;.content&apos;);</span><br><span class="line">                content.innerHTML = &apos;&lt;div&gt;the Profile Page&lt;/div&gt;&apos;;</span><br><span class="line">            &#125;,</span><br><span class="line">            &apos;/articles&apos;: () =&gt; &#123;</span><br><span class="line">                const content = $(&apos;.content&apos;);</span><br><span class="line">                content.innerHTML = `&lt;div&gt;</span><br><span class="line">                    &lt;p&gt;the Article Page&lt;/p&gt;</span><br><span class="line">                    &lt;ul&gt;</span><br><span class="line">                        &lt;li&gt;æ–‡ç« 1&lt;/li&gt;</span><br><span class="line">                        &lt;li&gt;æ–‡ç« 2&lt;/li&gt;</span><br><span class="line">                        &lt;li&gt;æ–‡ç« 3&lt;/li&gt;</span><br><span class="line">                    &lt;/ul&gt;</span><br><span class="line">                &lt;/div&gt;`;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        class Route &#123;</span><br><span class="line">            constructor(routeMap) &#123;</span><br><span class="line">                this.routeMap = routeMap;</span><br><span class="line">                this._bindPopState();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            init(path) &#123;</span><br><span class="line">                path = Route.correctPath(path);</span><br><span class="line">                history.replaceState(&#123; path: path &#125;, &apos;&apos;, path);</span><br><span class="line">                this.routeMap[path] &amp;&amp; this.routeMap[path]();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            go(path) &#123;</span><br><span class="line">                path = Route.correctPath(path);</span><br><span class="line">                history.pushState(&#123; path: path &#125;, &apos;&apos;, path);</span><br><span class="line">                this.routeMap[path] &amp;&amp; this.routeMap[path]();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            _bindPopState() &#123;</span><br><span class="line">                window.addEventListener(&apos;popstate&apos;, (e) =&gt; &#123;</span><br><span class="line">                    const path = e.state &amp;&amp; e.state.path;</span><br><span class="line">                    this.routeMap[path] &amp;&amp; this.routeMap[path]();</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            static correctPath(path) &#123;</span><br><span class="line">                if(path !== &apos;/&apos; &amp;&amp; path.slice(-1) === &apos;/&apos;)&#123;</span><br><span class="line">                    path = path.match(/(.+)\/$/)[1];</span><br><span class="line">                &#125;</span><br><span class="line">                return path;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        const router = new Route(routeMap);</span><br><span class="line">        router.init(location.pathname);</span><br><span class="line">        </span><br><span class="line">        $(&apos;.menu&apos;).addEventListener(&apos;click&apos;, (e) =&gt; &#123;</span><br><span class="line">            if (e.target.tagName === &apos;A&apos;) &#123;</span><br><span class="line">                e.preventDefault();</span><br><span class="line">                router.go(e.target.getAttribute(&apos;href&apos;))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>2ã€hashchangeäº‹ä»¶ï¼ˆIE8å·²æ”¯æŒè¯¥äº‹ä»¶ï¼‰</p>
<p>ã€€ã€€â‘ å½“URLçš„ç‰‡æ®µæ ‡è¯†ç¬¦æ›´æ”¹æ—¶ï¼Œå°†è§¦å‘hashchangeäº‹ä»¶ï¼ˆè·Ÿåœ¨#ç¬¦å·åé¢çš„URLéƒ¨åˆ†ï¼ŒåŒ…æ‹¬#ç¬¦å·ï¼‰</p>
<p>ã€€ã€€â‘¡hashchangeäº‹ä»¶è§¦å‘æ—¶ï¼Œäº‹ä»¶å¯¹è±¡ä¼šæœ‰hashæ”¹å˜å‰çš„URLï¼ˆoldURLï¼‰å’Œhashæ”¹å˜åçš„URLï¼ˆnewURLï¼‰ä¸¤ä¸ªå±æ€§ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&apos;hashchange&apos;, function(e) &#123;</span><br><span class="line">	console.log(e.oldURL); </span><br><span class="line">	console.log(e.newURL);</span><br><span class="line">&#125;, false);</span><br></pre></td></tr></table></figure>
<h4 id="äºŒã€é€šè¿‡history"><a href="#äºŒã€é€šè¿‡history" class="headerlink" title="äºŒã€é€šè¿‡history"></a>äºŒã€é€šè¿‡history</h4><p>å›å¿†:<br></p>
<p>historyæ˜¯HTML5æ–°å¢çš„ä¸€ä¸ªapiã€‚</p>
<blockquote>
<p>å…¶ä¸­åŒ…æ‹¬2ä¸ªæ–¹æ³•ï¼š<br><br>history.pushState() <br><br>history.replaceState() <br><br>1ä¸ªäº‹ä»¶ï¼šwindow.onpopstateã€‚</p>
</blockquote>
<p>####è¯´æ˜:</p>
<h5 id="pushState"><a href="#pushState" class="headerlink" title="pushState"></a>pushState</h5><p>å‡½æ•°å‘æµè§ˆå™¨çš„å†å²å †æ ˆå‹å…¥ä¸€ä¸ªurlä¸ºè®¾å®šå€¼çš„è®°å½•ï¼Œå¹¶æ”¹å˜å†å²å †æ ˆçš„å½“å‰æŒ‡é’ˆè‡³æ ˆé¡¶ã€‚</p>
<p>history.pushState(stateObject, title, url)ï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå‚æ•°ã€‚</p>
<blockquote>
<p>stateObjï¼Œä¸€ä¸ªæ™®é€šçš„jså¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ï¼Œå®ƒåŒ…å«åœ¨æ–°çš„hsitoryå®ä½“çš„stateå±æ€§ä¸­ã€‚å½“ç”¨æˆ·å¯¼èˆªåˆ°è¯¥çŠ¶æ€æ—¶ï¼Œä¸€ä¸ªpopstateäº‹ä»¶å°†ä¼šè¢«è§¦å‘ï¼Œå¹¶ä¸”åœ¨è¯¥äº‹ä»¶çš„e.stateä¸­ä¼šåŒ…å«è¿™ä¸ªstateObjã€‚</p>
</blockquote>
<blockquote>
<p>titleï¼Œç›®å‰æ²¡ä»€ä¹ˆç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…ä¸€ä¸ªè¡¨ç¤ºæ–°historyçŠ¶æ€çš„å­—ç¬¦ä¸²ã€‚</p>
</blockquote>
<blockquote>
<p>URLï¼Œå¯é€‰å‚æ•°ï¼Œè¿™å°†ä¼šæ”¹å˜æµè§ˆå™¨å½“å‰çš„urlï¼Œä½†æ˜¯æ–°çš„urlå¹¶ä¸ä¼šç«‹åˆ»åŠ è½½ã€‚å½“æ—¶ç”¨æˆ·æ­¤æ—¶è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢ï¼Œç„¶åå†ç‚¹å‡»åé€€ï¼Œè¯¥urlä¼šåŠ è½½ï¼Œå¹¶ä¸”è§¦å‘popstateäº‹ä»¶ã€‚</p>
</blockquote>
<p>ç¤ºä¾‹ï¼š </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">history.pushState(&#123;name: &apos;xwj&apos;, age: 22&#125;, &apos;&apos;, &apos;/profile&apos;);</span><br><span class="line"></span><br><span class="line">// æµè§ˆå™¨åœ°å€ä¼šå˜ä¸ºhttp://www.example.com/profileï¼Œä½†å¹¶ä¸ä¼šåŠ è½½ã€‚åŒæ—¶historyçš„lengthä¼šåŠ 1ï¼Œstateä¼šå˜ä¸ºä¼ å…¥çš„stateObj</span><br></pre></td></tr></table></figure>
<h5 id="replaceState"><a href="#replaceState" class="headerlink" title="replaceState"></a>replaceState</h5><p>è¯¥æ¥å£ä¸pushStateå‚æ•°ç›¸åŒï¼Œå«ä¹‰ä¹Ÿç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«åœ¨äºreplaceStateæ˜¯æ›¿æ¢æµè§ˆå™¨å†å²å †æ ˆçš„å½“å‰å†å²è®°å½•ä¸ºè®¾å®šçš„urlã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒreplaceStateä¸ä¼šæ”¹åŠ¨æµè§ˆå™¨å†å²å †æ ˆçš„å½“å‰æŒ‡é’ˆã€‚lengthä¸ä¼šå˜ã€‚</p>
<h5 id="onpopstate"><a href="#onpopstate" class="headerlink" title="onpopstate"></a>onpopstate</h5><p>è¯¥äº‹ä»¶æ˜¯windowçš„å±æ€§ã€‚è¯¥äº‹ä»¶ä¼šåœ¨è°ƒç”¨æµè§ˆå™¨çš„å‰è¿›ã€åé€€ä»¥åŠæ‰§è¡Œhistory.forwardã€history.backã€å’Œhistory.goè§¦å‘ï¼Œå› ä¸ºè¿™äº›æ“ä½œæœ‰ä¸€ä¸ªå…±æ€§ï¼Œå³ä¿®æ”¹äº†å†å²å †æ ˆçš„å½“å‰æŒ‡é’ˆã€‚åœ¨ä¸æ”¹å˜documentçš„å‰æä¸‹ï¼Œä¸€æ—¦å½“å‰æŒ‡é’ˆæ”¹å˜åˆ™ä¼šè§¦å‘onpopstateäº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href=&quot;#/&quot;&gt;turn white&lt;/a&gt;&lt;/li&gt; </span><br><span class="line">            &lt;li&gt;&lt;a href=&quot;#/blue&quot;&gt;turn blue&lt;/a&gt;&lt;/li&gt; </span><br><span class="line">            &lt;li&gt;&lt;a href=&quot;#/green&quot;&gt;turn green&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt; </span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function Router() &#123;</span><br><span class="line">        this.routes = &#123;&#125;;</span><br><span class="line">        this.currentUrl = &apos;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    Router.prototype.addRoute = function(path, callback) &#123;</span><br><span class="line">        this.routes[path] = callback || function()&#123;&#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    Router.prototype.refresh = function(e) &#123;</span><br><span class="line">        this.currentUrl = location.hash.slice(1) || &apos;/&apos;;</span><br><span class="line">        console.log(e.oldURL , e.newURL);</span><br><span class="line">        this.routes[this.currentUrl]();</span><br><span class="line">    &#125;;</span><br><span class="line">    Router.prototype.init = function() &#123;</span><br><span class="line">        window.addEventListener(&apos;load&apos;, this.refresh.bind(this), false);</span><br><span class="line">        window.addEventListener(&apos;hashchange&apos;, this.refresh.bind(this), false);</span><br><span class="line">    &#125;</span><br><span class="line">    window.Router = new Router();</span><br><span class="line">    window.Router.init();</span><br><span class="line">    let content = document.querySelector(&apos;div&apos;);</span><br><span class="line">    </span><br><span class="line">    function changeBgColor(color) &#123;</span><br><span class="line">        content.style.backgroundColor = color;</span><br><span class="line">    &#125;</span><br><span class="line">    Router.addRoute(&apos;/&apos;, function() &#123;</span><br><span class="line">        changeBgColor(&apos;white&apos;);</span><br><span class="line">    &#125;);</span><br><span class="line">    Router.addRoute(&apos;/blue&apos;, function() &#123;</span><br><span class="line">        changeBgColor(&apos;blue&apos;);</span><br><span class="line">    &#125;);</span><br><span class="line">    Router.addRoute(&apos;/green&apos;, function() &#123;</span><br><span class="line">        changeBgColor(&apos;green&apos;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h3 id="React-Router"><a href="#React-Router" class="headerlink" title="React Router ?"></a>React Router ?</h3><p>å®Œæ•´çš„ React è·¯ç”±è§£å†³æ–¹æ¡ˆ</p>
<h4 id="React-Router-ç®€ä»‹ç›¸å…³"><a href="#React-Router-ç®€ä»‹ç›¸å…³" class="headerlink" title="React Router ç®€ä»‹ç›¸å…³"></a>React Router ç®€ä»‹ç›¸å…³</h4><p>æ©ï¼Œæ˜¯v4</p>
<ul>
<li>3.x ç‰ˆæœ¬ç›¸æ¯”äº 2.x å¹¶æ²¡æœ‰å¼•å…¥ä»»ä½•æ–°çš„ç‰¹æ€§ï¼Œåªæ˜¯å°† 2.x ç‰ˆæœ¬ä¸­éƒ¨åˆ†åºŸå¼ƒ API çš„ warning ç§»é™¤æ‰è€Œå·²ã€‚V4ç‰ˆæœ¬ç›¸å¯¹V2/V3å‡ ä¹å®Œå…¨é‡å†™äº†ï¼Œéµå¾ª Just Component çš„ API è®¾è®¡ç†å¿µã€‚</li>
</ul>
<ul>
<li>React Router ä¿æŒ UI ä¸ URL åŒæ­¥ã€‚å®ƒæ‹¥æœ‰ç®€å•çš„ API ä¸å¼ºå¤§çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ä»£ç ç¼“å†²åŠ è½½ã€åŠ¨æ€è·¯ç”±åŒ¹é…ã€ä»¥åŠå»ºç«‹æ­£ç¡®çš„ä½ç½®è¿‡æ¸¡å¤„ç†ã€‚</li>
</ul>
<p>react-router V4 åˆ†æˆäº†ä¸‰ä¸ªåŒ…ï¼šreact-router-dom(for web)ã€react-router-native(for #native)ã€react-router(core)ã€‚react-routeræä¾›æ ¸å¿ƒçš„è·¯ç”±ç»„ä»¶ä¸å‡½æ•°ã€‚å…¶ä½™ä¸¤ä¸ªåˆ™æä¾›è¿è¡Œç¯å¢ƒï¼ˆå³æµè§ˆå™¨ä¸react-nativeï¼‰æ‰€éœ€çš„ç‰¹å®šç»„ä»¶ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬åªéœ€ä½¿ç”¨react-router-domã€‚</p>
<p>###ä¸»è¦ç»„ä»¶</p>
<h4 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h4><p>åœ¨4.0ä¹‹å‰ç‰ˆæœ¬çš„ API ä¸­ï¼ŒRouter ç»„ä»¶çš„ children åªèƒ½æ˜¯ React Router æä¾›çš„å„ç§ç»„ä»¶ï¼Œå¦‚Routeã€IndexRouteã€Redirectç­‰ã€‚è€Œåœ¨ React Router 4 ä¸­ï¼Œä½ å¯ä»¥å°†å„ç§ç»„ä»¶åŠæ ‡ç­¾æ”¾è¿› Routerç»„ä»¶ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// ç¤ºä¾‹1</span><br><span class="line">&lt;Router&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &lt;li&gt;&lt;Link to=&quot;/&quot;&gt;é¦–é¡µ&lt;/Link&gt;&lt;/li&gt;</span><br><span class="line">        &lt;li&gt;&lt;Link to=&quot;/about&quot;&gt;å…³äº&lt;/Link&gt;&lt;/li&gt;</span><br><span class="line">        &lt;li&gt;&lt;Link to=&quot;/topics&quot;&gt;ä¸»é¢˜åˆ—è¡¨&lt;/Link&gt;&lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">      &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125;/&gt;</span><br><span class="line">      &lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class="line">      &lt;Route path=&quot;/topics&quot; component=&#123;Topics&#125;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/Router&gt;</span><br></pre></td></tr></table></figure>
<p>Routeræ˜¯æ‰€æœ‰è·¯ç”±ç»„ä»¶å…±ç”¨çš„åº•å±‚æ¥å£ï¼Œä¸€èˆ¬æˆ‘ä»¬çš„åº”ç”¨å¹¶ä¸ä¼šä½¿ç”¨è¿™ä¸ªæ¥å£ï¼Œè€Œæ˜¯ä½¿ç”¨é«˜çº§çš„è·¯ç”±ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;BrowserRouter&gt;ï¼šä½¿ç”¨ HTML5 æä¾›çš„ history API æ¥ä¿æŒ UI å’Œ URL çš„åŒæ­¥ï¼›</span><br><span class="line">&lt;HashRouter&gt;ï¼šä½¿ç”¨ URL çš„ hash (ä¾‹å¦‚ï¼šwindow.location.hash) æ¥ä¿æŒ UI å’Œ URL çš„åŒæ­¥ï¼›</span><br><span class="line">&lt;MemoryRouter&gt;ï¼šèƒ½åœ¨å†…å­˜ä¿å­˜ä½  â€œURLâ€ çš„å†å²çºªå½•(å¹¶æ²¡æœ‰å¯¹åœ°å€æ è¯»å†™)ï¼›</span><br><span class="line">&lt;NativeRouter&gt;ï¼šä¸ºä½¿ç”¨React Nativeæä¾›è·¯ç”±æ”¯æŒï¼›</span><br><span class="line">&lt;StaticRouter&gt;ï¼šä»ä¸ä¼šæ”¹å˜åœ°å€ï¼›</span><br></pre></td></tr></table></figure>
<p>TIPSï¼šå’Œä¹‹å‰çš„Routerä¸ä¸€æ ·ï¼Œè¿™é‡Œ<router>ç»„ä»¶ä¸‹åªå…è®¸å­˜åœ¨ä¸€ä¸ªå­å…ƒç´ </router></p>
<h3 id="Route"><a href="#Route" class="headerlink" title="Route"></a>Route</h3><p>Routeç»„ä»¶ä¸»è¦çš„ä½œç”¨å°±æ˜¯å½“ä¸€ä¸ªlocationåŒ¹é…è·¯ç”±çš„pathæ—¶ï¼Œæ¸²æŸ“æŸäº›UIã€‚å¦‚æœä¸åŒ¹é…ï¼Œè·¯ç”±ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œã€‚<br><br></p>
<p>Route ç»„ä»¶æœ‰å¦‚ä¸‹å±æ€§ï¼š</p>
<blockquote>
</blockquote>
<p>pathï¼ˆstringï¼‰: è·¯ç”±åŒ¹é…è·¯å¾„ã€‚ï¼ˆæ²¡æœ‰pathå±æ€§çš„Route æ€»æ˜¯ä¼š åŒ¹é…ï¼‰ï¼›<br>exactï¼ˆboolï¼‰ï¼šä¸ºtrueæ—¶ï¼Œåˆ™è¦æ±‚è·¯å¾„ä¸location.pathnameå¿…é¡»å®Œå…¨åŒ¹é…ï¼›<br>strictï¼ˆboolï¼‰ï¼štrueçš„æ—¶å€™ï¼Œæœ‰ç»“å°¾æ–œçº¿çš„è·¯å¾„åªèƒ½åŒ¹é…æœ‰æ–œçº¿çš„location.pathnameï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=&quot;/hello/:name&quot;&gt;</span><br><span class="line">// åŒ¹é… /hello/michael</span><br><span class="line">// åŒ¹é… /hello/ryan</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/hello(/:name)&quot;&gt;</span><br><span class="line">// åŒ¹é… /hello</span><br><span class="line">// åŒ¹é… /hello/michael</span><br><span class="line">// åŒ¹é… /hello/ryan</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/files/*.*&quot;&gt;</span><br><span class="line">// åŒ¹é… /files/hello.jpg</span><br><span class="line">// åŒ¹é… /files/hello.html</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/files/*&quot;&gt;</span><br><span class="line">// åŒ¹é… /files/ </span><br><span class="line">// åŒ¹é… /files/a</span><br><span class="line">// åŒ¹é… /files/a/b</span><br><span class="line"></span><br><span class="line">&lt;Route path=&quot;/**/*.jpg&quot;&gt;</span><br><span class="line">// åŒ¹é… /files/hello.jpg</span><br><span class="line">// åŒ¹é… /files/path/to/file.jpg</span><br></pre></td></tr></table></figure>
<p><img src="/imgs/å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹/pipeiguize.png" alt></p>
<h5 id="åŒ¹é…è·¯å¾„"><a href="#åŒ¹é…è·¯å¾„" class="headerlink" title="åŒ¹é…è·¯å¾„"></a>åŒ¹é…è·¯å¾„</h5><p>path-to-regexpåŒ…ç”¨æ¥å†³å®šrouteå…ƒç´ çš„pathå‚æ•°ä¸å½“å‰locationæ˜¯å¦åŒ¹é…ã€‚å®ƒå°†è·¯å¾„å­—ç¬¦ä¸²ç¼–è¯‘æˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸å½“å‰locationçš„è·¯å¾„åè¿›è¡ŒåŒ¹é…æ¯”è¾ƒã€‚<br>å½“è·¯ç”±åœ°å€åŒ¹é…æˆåŠŸåï¼Œä¼šåˆ›å»ºä¸€ä¸ªå«æœ‰ä»¥ä¸‹å±æ€§çš„matchå¯¹è±¡ï¼š</p>
<ul>
<li><p>url ï¼šä¸å½“å‰locationè·¯å¾„åæ‰€åŒ¹é…éƒ¨åˆ†</p>
</li>
<li><p>pathâ€Šï¼šè·¯ç”±çš„åœ°å€</p>
</li>
<li><p>isExact ï¼špath æ˜¯å¦ç­‰äº pathname</p>
</li>
<li><p>paramsâ€Šï¼šä»path-to-regexpè·å–çš„è·¯å¾„ä¸­å–å‡ºçš„å€¼éƒ½è¢«åŒ…å«åœ¨è¿™ä¸ªå¯¹è±¡ä¸­</p>
</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=&apos;/roster&apos;/&gt;</span><br><span class="line">// å½“è·¯å¾„åä¸º&apos;/&apos;æ—¶, pathä¸åŒ¹é…</span><br><span class="line">// å½“è·¯å¾„åä¸º&apos;/roster&apos;æˆ–&apos;/roster/2&apos;æ—¶, pathåŒ¹é…</span><br><span class="line">// å½“ä½ åªæƒ³åŒ¹é…&apos;/roster&apos;æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨&quot;exact&quot;å‚æ•°</span><br><span class="line">// åˆ™è·¯ç”±ä»…åŒ¹é…&apos;/roster&apos;è€Œä¸ä¼šåŒ¹é…&apos;/roster/2&apos;</span><br><span class="line">&lt;Route exact path=&apos;/roster&apos;/&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šåœ¨åŒ¹é…è·¯ç”±æ—¶ï¼ŒReact Routeråªå…³æ³¨locationçš„è·¯å¾„åã€‚å½“URLå¦‚ä¸‹æ—¶ï¼š<br>http:/xxx/xx/x/a?extra=false<br>React Routerå»åŒ¹é…çš„åªæ˜¯â€™/xxx/xx/x/aâ€™è¿™ä¸€éƒ¨åˆ†ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;Router&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125;/&gt;</span><br><span class="line">    &lt;Route path=&quot;/news&quot; component=&#123;News&#125;/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/Router&gt;</span><br><span class="line"></span><br><span class="line">// å¦‚æœåº”ç”¨çš„åœ°å€æ˜¯/,é‚£ä¹ˆç›¸åº”çš„UIä¼šç±»ä¼¼è¿™ä¸ªæ ·å­ï¼š</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;Home/&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">// å¦‚æœåº”ç”¨çš„åœ°å€æ˜¯/news,é‚£ä¹ˆç›¸åº”çš„UIå°±ä¼šæˆä¸ºè¿™ä¸ªæ ·å­ï¼š</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;News/&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>æ–°ç‰ˆçš„è·¯ç”±ä¸ºRouteæä¾›äº†ä¸‰ç§æ¸²æŸ“å†…å®¹çš„æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route component&gt;ï¼šåœ¨åœ°å€åŒ¹é…çš„æ—¶å€™Reactçš„ç»„ä»¶æ‰ä¼šè¢«æ¸²æŸ“ï¼Œroute propsä¹Ÿä¼šéšç€ä¸€èµ·è¢«æ¸²æŸ“ï¼›</span><br><span class="line">&lt;Route render&gt;ï¼šè¿™ç§æ–¹å¼å¯¹äºå†…è”æ¸²æŸ“å’ŒåŒ…è£…ç»„ä»¶å´ä¸å¼•èµ·æ„æ–™ä¹‹å¤–çš„é‡æ–°æŒ‚è½½ç‰¹åˆ«æ–¹ä¾¿ï¼›</span><br><span class="line">&lt;Route children&gt;ï¼šä¸renderå±æ€§çš„å·¥ä½œæ–¹å¼åŸºæœ¬ä¸€æ ·ï¼Œé™¤äº†å®ƒæ˜¯ä¸ç®¡åœ°å€åŒ¹é…ä¸å¦éƒ½ä¼šè¢«è°ƒç”¨ï¼›</span><br><span class="line">?</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// è¡Œå†…æ¸²æŸ“ç¤ºä¾‹</span><br><span class="line">&lt;Route path=&quot;/home&quot; render=&#123;() =&gt; &lt;div&gt;Home&lt;/div&gt;&#125;/&gt;</span><br><span class="line"></span><br><span class="line">// åŒ…è£…/åˆæˆ</span><br><span class="line">const FadingRoute = (&#123; component: Component, ...rest &#125;) =&gt; (</span><br><span class="line">  &lt;Route &#123;...rest&#125; render=&#123;props =&gt; (</span><br><span class="line">    &lt;FadeIn&gt;</span><br><span class="line">      &lt;Component &#123;...props&#125;/&gt;</span><br><span class="line">    &lt;/FadeIn&gt;</span><br><span class="line">  )&#125;/&gt;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">&lt;FadingRoute path=&quot;/cool&quot; component=&#123;Something&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>Route component çš„ä¼˜å…ˆçº§è¦æ¯” Route renderé«˜ï¼Œæ‰€ä»¥ä¸è¦åœ¨åŒä¸€ä¸ªRouteä¸­åŒæ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªå±æ€§ã€‚</p>
<ul>
<li>æœ€åï¼šä½ å¯ä»¥æŠŠRouteç»„ä»¶æ”¾åœ¨ä»»æ„ä½ æƒ³è¦è·¯ç”±æ¸²æŸ“çš„åœ°æ–¹</li>
</ul>
<p>###Link<br>é‡ç‚¹çœ‹ä¸‹ç»„ä»¶å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">toï¼ˆstring/objectï¼‰ï¼šè¦è·³è½¬çš„è·¯å¾„æˆ–åœ°å€ï¼›</span><br><span class="line">replaceï¼ˆboolï¼‰ï¼šä¸º true æ—¶ï¼Œç‚¹å‡»é“¾æ¥åå°†ä½¿ç”¨æ–°åœ°å€æ›¿æ¢æ‰è®¿é—®å†å²è®°å½•é‡Œé¢çš„åŸåœ°å€ï¼›ä¸º false æ—¶ï¼Œç‚¹å‡»é“¾æ¥åå°†åœ¨åŸæœ‰è®¿é—®å†å²è®°å½•çš„åŸºç¡€ä¸Šæ·»åŠ ä¸€ä¸ªæ–°çš„çºªå½•ã€‚é»˜è®¤ä¸º falseï¼›</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// Linkç»„ä»¶ç¤ºä¾‹</span><br><span class="line"></span><br><span class="line">// toä¸ºstring</span><br><span class="line">&lt;Link to=&quot;/about&quot;&gt;å…³äº&lt;/Link&gt;</span><br><span class="line"></span><br><span class="line">// toä¸ºobj</span><br><span class="line">&lt;Link to=&#123;&#123;</span><br><span class="line">  pathname: &apos;/courses&apos;,</span><br><span class="line">  search: &apos;?sort=name&apos;,</span><br><span class="line">  hash: &apos;#the-hash&apos;,</span><br><span class="line">  state: &#123; fromDashboard: true &#125;</span><br><span class="line">&#125;&#125;/&gt;</span><br><span class="line"></span><br><span class="line">// replace </span><br><span class="line">&lt;Link to=&quot;/courses&quot; replace /&gt;</span><br></pre></td></tr></table></figure>
<p>###NavLink<br>NavLinkæ˜¯Linkçš„ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬, ä¼šåœ¨åŒ¹é…ä¸Šå½“å‰ URL çš„æ—¶å€™ä¼šç»™å·²ç»æ¸²æŸ“çš„å…ƒç´ æ·»åŠ æ ·å¼å‚æ•°ï¼Œç»„ä»¶å±æ€§ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">activeClassNameï¼ˆstringï¼‰ï¼šè®¾ç½®é€‰ä¸­æ ·å¼ï¼Œé»˜è®¤å€¼ä¸º activeï¼›</span><br><span class="line">activeStyleï¼ˆobjectï¼‰ï¼šå½“å…ƒç´ è¢«é€‰ä¸­æ—¶, ä¸ºæ­¤å…ƒç´ æ·»åŠ æ ·å¼ï¼›</span><br><span class="line">exactï¼ˆboolï¼‰ï¼šä¸º true æ—¶, åªæœ‰å½“åœ°å€å®Œå…¨åŒ¹é… class å’Œ style æ‰ä¼šåº”ç”¨ï¼›</span><br><span class="line">strictï¼ˆboolï¼‰ï¼šä¸º true æ—¶ï¼Œåœ¨ç¡®å®šä½ç½®æ˜¯å¦ä¸å½“å‰ URL åŒ¹é…æ—¶ï¼Œå°†è€ƒè™‘ä½ç½® pathname åçš„æ–œçº¿ï¼›</span><br><span class="line">isActiveï¼ˆfuncï¼‰ï¼šåˆ¤æ–­é“¾æ¥æ˜¯å¦æ¿€æ´»çš„é¢å¤–é€»è¾‘çš„åŠŸèƒ½ï¼›</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// activeClassNameé€‰ä¸­æ—¶æ ·å¼ä¸ºselected</span><br><span class="line">&lt;NavLink</span><br><span class="line">  to=&quot;/faq&quot;</span><br><span class="line">  activeClassName=&quot;selected&quot;</span><br><span class="line">&gt;FAQs&lt;/NavLink&gt;</span><br><span class="line"></span><br><span class="line">// é€‰ä¸­æ—¶æ ·å¼ä¸ºactiveStyleçš„æ ·å¼è®¾ç½®</span><br><span class="line">&lt;NavLink</span><br><span class="line">  to=&quot;/faq&quot;</span><br><span class="line">  activeStyle=&#123;&#123;</span><br><span class="line">    fontWeight: &apos;bold&apos;,</span><br><span class="line">    color: &apos;red&apos;</span><br><span class="line">   &#125;&#125;</span><br><span class="line">&gt;FAQs&lt;/NavLink&gt;</span><br><span class="line"></span><br><span class="line">// å½“event idä¸ºå¥‡æ•°çš„æ—¶å€™ï¼Œæ¿€æ´»é“¾æ¥</span><br><span class="line">const oddEvent = (match, location) =&gt; &#123;</span><br><span class="line">  if (!match) &#123;</span><br><span class="line">    return false</span><br><span class="line">  &#125;</span><br><span class="line">  const eventID = parseInt(match.params.eventID)</span><br><span class="line">  return !isNaN(eventID) &amp;&amp; eventID % 2 === 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;NavLink</span><br><span class="line">  to=&quot;/events/123&quot;</span><br><span class="line">  isActive=&#123;oddEvent&#125;</span><br><span class="line">&gt;Event 123&lt;/NavLink&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Switch"><a href="#Switch" class="headerlink" title="Switch"></a>Switch</h3><p>è¯¥ç»„ä»¶ç”¨æ¥æ¸²æŸ“åŒ¹é…åœ°å€çš„ç¬¬ä¸€ä¸ªRouteæˆ–è€…Redirectã€‚é‚£ä¹ˆå®ƒä¸ä½¿ç”¨ä¸€å †routeåˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>
<p>Switchçš„ç‹¬ç‰¹ä¹‹å¤„æ˜¯ç‹¬å®ƒä»…ä»…æ¸²æŸ“ä¸€ä¸ªè·¯ç”±ã€‚ç›¸ååœ°ï¼Œæ¯ä¸€ä¸ªåŒ…å«åŒ¹é…åœ°å€(location)çš„ Routeéƒ½ä¼šè¢«æ¸²æŸ“ã€‚æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class="line">&lt;Route path=&quot;/:user&quot; component=&#123;User&#125;/&gt;</span><br><span class="line">&lt;Route component=&#123;NoMatch&#125;/&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¦‚æœç°åœ¨çš„URLæ˜¯/aboutï¼Œé‚£ä¹ˆ About,  User, è¿˜æœ‰ NoMatchéƒ½ä¼šè¢«æ¸²æŸ“ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä¸è·¯å¾„(path)åŒ¹é…ã€‚è¿™ç§è®¾è®¡ï¼Œå…è®¸æˆ‘ä»¬ä»¥å¤šç§æ–¹å¼å°†å¤šä¸ª Routeç»„åˆåˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œä¾‹å¦‚ä¾§æ (sidebars)ï¼Œé¢åŒ…å±‘(breadcrumbs)ï¼Œbootstrap tabsç­‰ç­‰ã€‚ ç„¶è€Œï¼Œå¶å°”æˆ‘ä»¬åªæƒ³é€‰æ‹©ä¸€ä¸ªRouteæ¥æ¸²æŸ“ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨å¤„äº/aboutï¼Œæˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›åŒ¹é…/:userï¼ˆæˆ–è€…æ˜¾ç¤ºæˆ‘ä»¬çš„ â€œ404â€ é¡µé¢ ï¼‰ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Switch çš„æ–¹æ³•æ¥å®ç°ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Route exact path=&quot;/&quot; component=&#123;Home&#125;/&gt;</span><br><span class="line">  &lt;Route path=&quot;/about&quot; component=&#123;About&#125;/&gt;</span><br><span class="line">  &lt;Route path=&quot;/:user&quot; component=&#123;User&#125;/&gt;</span><br><span class="line">  &lt;Route component=&#123;NoMatch&#125;/&gt;</span><br><span class="line">&lt;/Switch&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å¤„äº/aboutï¼ŒSwitchå°†å¼€å§‹å¯»æ‰¾åŒ¹é…çš„Routeã€‚Route path=â€/aboutâ€  å°†è¢«åŒ¹é…ï¼Œ Switchå°†åœæ­¢å¯»æ‰¾åŒ¹é…å¹¶æ¸²æŸ“Aboutã€‚åŒæ ·ï¼Œå¦‚æœæˆ‘ä»¬å¤„äº/michaelï¼ŒUserå°†è¢«æ¸²æŸ“ã€‚</li>
</ul>
<ul>
<li>é€šè¿‡Routeè·¯ç”±çš„ç»„ä»¶ï¼Œå¯ä»¥æ‹¿åˆ°ä¸€ä¸ªmatchå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«å‡ ä¸ªæ•°æ®ï¼š<br><br>isExactï¼šåˆšæ‰å·²ç»è¯´è¿‡è¿™ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºæ˜¯ä¸ºä½œå…¨ç­‰åŒ¹é…<br>paramsï¼špathä¸­åŒ…å«çš„ä¸€äº›é¢å¤–æ•°æ®<br>pathï¼šRouteç»„ä»¶pathå±æ€§çš„å€¼<br>urlï¼šå®é™…urlçš„hashå€¼</li>
</ul>
<p><img src="/imgs/å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹/match.png" alt></p>
<p><br></p>
<p>###v3 ä¸ v4 çš„ä¸€äº›åŒºåˆ«<br>åœ¨react-router v3ä¸­ï¼Œä»…æœ‰ä¸€ä¸ªRouter ç»„ä»¶ï¼Œéœ€è¦æä¾› history å¯¹è±¡ä½œä¸ºä»–çš„å±æ€§ (prop)ã€‚</p>
<p>æ­¤å¤–ï¼Œå¯ä»¥ä½¿ç”¨ routes ä½œä¸º Router çš„å±æ€§ (prop) æˆ–è€…ä½œä¸º children çš„æ–¹å¼æ¥å®šä¹‰ç¨‹åºçš„è·¯ç”±ç»“æ„ã€‚</p>
<p>åœ¨v4ä¸­ï¼Œæ²¡æœ‰é›†ä¸­çš„è·¯ç”±é…ç½®ã€‚ä»»ä½•éœ€è¦æ ¹æ®è·¯ç”±æ¸²æŸ“å†…å®¹çš„åœ°æ–¹ï¼Œåªéœ€æ¸²æŸ“ä¸€ä¸ª Route ç»„ä»¶  router ç»„ä»¶åªèƒ½è¢«èµ‹äºˆä¸€ä¸ªå­å…ƒç´ </p>
<p>react-router v3 æä¾› onEnter, onUpdate, and onLeave æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯é‡å†™ï¼ˆè¦†ç›–ï¼‰äº† react ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ä½¿ç”¨ v4ï¼Œä½ å°†ä¼šä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³• é€šè¿‡ Route æ¸²æŸ“çš„ç»„ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ componentDidMount æˆ– componentWillMount ä»£æ›¿ onEnterï¼Œä½ å¯ä»¥ä½¿ç”¨ componentDidUpdate æˆ–è€… componentWillUpdate (æ›´æˆ–è€… componentWillReceiveProps) ä»£æ›¿ onUpdateï¼Œä½ å¯ä»¥ä½¿ç”¨ componentWillUnmount ä»£æ›¿ onLeaveã€‚</p>
<p>v4 çš„Switchç»„ä»¶ï¼Œå½“ Switch è¢«æ¸²æŸ“æ—¶ï¼Œå®ƒä»…ä¼šæ¸²æŸ“ä¸å½“å‰è·¯å¾„åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ Routeã€‚</p>
<p>â€¦<br>è¿˜æœ‰å¾ˆå¤šåŒºåˆ«</p>
<h3 id="and"><a href="#and" class="headerlink" title="and"></a>and</h3><p><a href="http://www.baidu.com/link?url=iUqZ8qoki-EPuX4LUXguiJ148mao0sYdb0qjVExb8eHXw_LtydvYYEMBWSzuLuLtupDvzONFn7YlZyyKNLJ8Aq" target="_blank" rel="noopener">éº»çƒ¦çš„æŒ‰éœ€åŠ è½½</a></p>
<p><a href="https://github.com/cheft/minrouter" target="_blank" rel="noopener">minrouter</a> ç”¨äºåŒæ„javaScript Webåº”ç”¨ç¨‹åºçš„å¾®å‹ä¸­é—´ä»¶è·¯ç”±å™¨</p>
<p><a href="https://react-guide.github.io/react-router-cn/" target="_blank" rel="noopener">React Router ä¸­æ–‡</a></p>
<p><a href="https://www.zcfy.cc/article/react-router-v4-the-complete-guide-mdash-sitepoint-4448.html" target="_blank" rel="noopener">React Router v4 ç‰ˆæœ¬ å®Œå…¨æŒ‡åŒ—</a></p>
<p><a href="https://github.com/YutHelloWorld/Blog/issues/4" target="_blank" rel="noopener">v2 v3 åˆ° v4 ç‰ˆæœ¬çš„è¿ç§»</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/04/12/å…³äºå‰ç«¯è·¯ç”±çš„ä¸€äº›äº‹/" data-id="cka3kmld9001h7zo77drxqzfe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-visual-dom" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/05/visual-dom/" class="article-date">
  <time datetime="2018-03-05T15:48:14.000Z" itemprop="datePublished">2018-03-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/05/visual-dom/">visual dom</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>####å¼•è¨€<br>æˆ‘ä»¬çŸ¥é“ï¼ŒDOM æ“ä½œçœŸæ­£çš„é—®é¢˜åœ¨äºæ¯æ¬¡æ“ä½œéƒ½ä¼šè§¦å‘å¸ƒå±€çš„æ”¹å˜ã€DOMæ ‘çš„ä¿®æ”¹å’Œæ¸²æŸ“ã€‚æ‰€ä»¥ï¼Œå½“ä½ ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å»ä¿®æ”¹30ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå°±ä¼šå¼•èµ·Næ¬¡ï¼ˆæ½œåœ¨çš„ï¼‰å¸ƒå±€é‡ç®—ï¼ŒNæ¬¡ï¼ˆæ½œåœ¨çš„ï¼‰é‡ç»˜ï¼Œç­‰ç­‰ã€‚</p>
<h4 id="äºŒã€ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ"><a href="#äºŒã€ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ" class="headerlink" title="äºŒã€ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ"></a>äºŒã€ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ</h4><p>è™šæ‹ŸDOMæ˜¯åœ¨DOMçš„åŸºç¡€ä¸Šå»ºç«‹äº†ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå¯¹æ•°æ®å’ŒçŠ¶æ€æ‰€åšçš„ä»»ä½•æ”¹åŠ¨ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨ä¸”é«˜æ•ˆçš„åŒæ­¥åˆ°è™šæ‹ŸDOMï¼Œæœ€åå†æ‰¹é‡åŒæ­¥åˆ°DOMä¸­ã€‚</p>
<p>Virtual DOM å®é™…ä¸Šæ²¡æœ‰ä½¿ç”¨ä»€ä¹ˆå…¨æ–°çš„æŠ€æœ¯ï¼Œä»…ä»…æ˜¯æŠŠ â€œ åŒç¼“å†²ï¼ˆdouble bufferingï¼‰â€ æŠ€æœ¯åº”ç”¨åˆ°äº†DOMä¸Šé¢ã€‚<br>è¿™æ ·ä¸€æ¥ï¼Œå½“ä½ åœ¨è¿™ä¸ªå•ç‹¬çš„è™šæ‹Ÿçš„DOMæ ‘ä¸Šä¹Ÿä¸€ä¸ªæ¥ä¸€ä¸ªåœ°ä¿®æ”¹30ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå®ƒä¸ä¼šæ¯æ¬¡éƒ½å»è§¦å‘é‡ç»˜ï¼Œæ‰€ä»¥ä¿®æ”¹èŠ‚ç‚¹çš„å¼€é”€å°±å˜å°äº†ã€‚<br>ä¹‹åï¼Œä¸€æ—¦ä½ è¦æŠŠè¿™äº›æ”¹åŠ¨ä¼ é€’ç»™çœŸå®DOMï¼Œä¹‹å‰æ‰€æœ‰çš„æ”¹åŠ¨å°±ä¼šæ•´åˆæˆä¸€æ¬¡DOMæ“ä½œã€‚è¿™ä¸€æ¬¡DOMæ“ä½œå¼•èµ·çš„å¸ƒå±€è®¡ç®—å’Œé‡ç»˜å¯èƒ½ä¼šæ›´å¤§ï¼Œä½†æ˜¯ç›¸æ¯”è€Œè¨€ï¼Œæ•´åˆèµ·æ¥çš„æ”¹åŠ¨åªåšä¸€æ¬¡ï¼Œå‡å°‘äº†ï¼ˆå¤šæ¬¡ï¼‰è®¡ç®—ã€‚</p>
<p>è™šæ‹ŸDOMæ˜¯Reactç­‰çš„ä¸€å¤§äº®ç‚¹ï¼Œå…·æœ‰batching(æ‰¹å¤„ç†)å’Œé«˜æ•ˆçš„Diffç®—æ³•ã€‚è¿™è®©æˆ‘ä»¬å¯ä»¥æ— éœ€æ‹…å¿ƒæ€§èƒ½é—®é¢˜è€Œâ€æ¯«æ— é¡¾å¿Œâ€çš„éšæ—¶â€œåˆ·æ–°â€æ•´ä¸ªé¡µé¢ï¼Œç”±è™šæ‹ŸDOMæ¥ç¡®ä¿åªå¯¹ç•Œé¢ä¸ŠçœŸæ­£å˜åŒ–çš„éƒ¨åˆ†è¿›è¡Œå®é™…çš„DOMæ“ä½œã€‚</p>
<p><img src="/imgs/visualdom/20170504161311010.png" alt><br><br><br><br><br><img src="/imgs/visualdom/20170504161319670.png" alt></p>
<p><br></p>
<p>innerHTMLï¼šrender htmlå­—ç¬¦ä¸² + é‡æ–°åˆ›å»ºæ‰€æœ‰ DOM å…ƒç´ </p>
<p>è™šæ‹ŸDOMï¼šrender è™šæ‹ŸDOM + diff + æ›´æ–°å¿…è¦çš„ DOM å…ƒç´ </p>
<p><br></p>
<h4 id="è™šæ‹ŸDOMçš„ä¼˜ç‚¹ï¼š"><a href="#è™šæ‹ŸDOMçš„ä¼˜ç‚¹ï¼š" class="headerlink" title="è™šæ‹ŸDOMçš„ä¼˜ç‚¹ï¼š"></a>è™šæ‹ŸDOMçš„ä¼˜ç‚¹ï¼š</h4><p>æœ€ç»ˆè¡¨ç°åœ¨DOMä¸Šçš„ä¿®æ”¹åªæ˜¯å˜æ›´çš„éƒ¨åˆ†ï¼Œå¯ä»¥ä¿è¯éå¸¸é«˜æ•ˆçš„æ¸²æŸ“ã€‚</p>
<p>####è™šæ‹ŸDOMçš„ç¼ºç‚¹ï¼š<br>é¦–æ¬¡æ¸²æŸ“å¤§é‡DOMæ—¶ï¼Œç”±äºå¤šäº†ä¸€å±‚è™šæ‹ŸDOMçš„è®¡ç®—ï¼Œä¼šæ¯”innerHTMLæ’å…¥æ…¢ã€‚</p>
<h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†:"></a>åŸç†:</h4><p>Reactä¼šåœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªè™šæ‹ŸDOMæ ‘ï¼Œå¯¹è¿™ä¸ªæ ‘è¿›è¡Œè¯»æˆ–å†™ï¼Œå®é™…ä¸Šæ˜¯å¯¹è™šæ‹ŸDOMè¿›è¡Œã€‚å½“æ•°æ®å˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–°è™šæ‹ŸDOMï¼Œç„¶åå°†æ–°çš„è™šæ‹ŸDOMå’Œæ—§çš„è™šæ‹ŸDOMè¿›è¡Œå¯¹æ¯”ï¼Œæ‰¾åˆ°å˜æ›´çš„éƒ¨åˆ†ï¼Œå¾—å‡ºä¸€ä¸ªdiffï¼Œç„¶åå°†diffæ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œæœ€ç»ˆæ‰¹é‡æ›´æ–°è¿™äº›diffåˆ°DOMä¸­ã€‚</p>
<h6 id="æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘"><a href="#æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘" class="headerlink" title="æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘ "></a>æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘ <br></h6><h6 id="æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚"><a href="#æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚" class="headerlink" title="æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚"></a>æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚<br></h6><h6 id="æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š"><a href="#æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š" class="headerlink" title="æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š "></a>æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š <br></h6><p><img src="/imgs/visualdom/20170504161331322.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//æ¨¡æ‹Ÿdom</span><br><span class="line">function Element(tagName, props, children) &#123;</span><br><span class="line">  this.tagName = tagName</span><br><span class="line">  this.props = props</span><br><span class="line">  this.children = children</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = function (tagName, props, children) &#123;</span><br><span class="line">  return new Element(tagName, props, children)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ¸²æŸ“</span><br><span class="line">Element.prototype.render = function () &#123;</span><br><span class="line">  var el = document.createElement(this.tagName) // æ ¹æ®tagNameæ„å»º</span><br><span class="line">  var props = this.props</span><br><span class="line"></span><br><span class="line">  for (var propName in props) &#123; // è®¾ç½®èŠ‚ç‚¹çš„DOMå±æ€§</span><br><span class="line">    var propValue = props[propName]</span><br><span class="line">    el.setAttribute(propName, propValue)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var children = this.children || []</span><br><span class="line"></span><br><span class="line">  children.forEach(function (child) &#123;</span><br><span class="line">    var childEl = (child instanceof Element)</span><br><span class="line">      ? child.render() // å¦‚æœå­èŠ‚ç‚¹ä¹Ÿæ˜¯è™šæ‹ŸDOMï¼Œé€’å½’æ„å»ºDOMèŠ‚ç‚¹</span><br><span class="line">      : document.createTextNode(child) // å¦‚æœå­—ç¬¦ä¸²ï¼Œåªæ„å»ºæ–‡æœ¬èŠ‚ç‚¹</span><br><span class="line">    el.appendChild(childEl)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  return el</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p></p><p style="color:blue;">ä¾‹å¦‚ä¸Šé¢çš„ DOM ç»“æ„å°±å¯ä»¥ç®€å•çš„è¡¨ç¤ºï¼š</p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var el = require(&apos;./element&apos;);</span><br><span class="line">var ul = el(&apos;ul&apos;, &#123;id: &apos;list&apos;&#125;, [</span><br><span class="line">  el(&apos;li&apos;, &#123;class: &apos;item&apos;&#125;, [&apos;Item 1&apos;]),</span><br><span class="line">  el(&apos;li&apos;, &#123;class: &apos;item&apos;&#125;, [&apos;Item 2&apos;]),</span><br><span class="line">  el(&apos;li&apos;, &#123;class: &apos;item&apos;&#125;, [&apos;Item 3&apos;])</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p></p>
<p>æ³¨ï¼šåœ¨å‰ç«¯å½“ä¸­ï¼Œä½ å¾ˆå°‘ä¼šè·¨è¶Šå±‚çº§åœ°ç§»åŠ¨DOMå…ƒç´ ã€‚æ‰€ä»¥ Virtual DOM åªä¼šå¯¹åŒä¸€ä¸ªå±‚çº§çš„å…ƒç´ è¿›è¡Œå¯¹æ¯”ï¼Œä¸Šé¢çš„divåªä¼šå’ŒåŒä¸€å±‚çº§çš„divå¯¹æ¯”ï¼Œç¬¬äºŒå±‚çº§çš„åªä¼šè·Ÿç¬¬äºŒå±‚çº§å¯¹æ¯”ã€‚è¿™æ ·ç®—æ³•å¤æ‚åº¦å°±å¯ä»¥è¾¾åˆ° O(n)ã€‚</p>
<p><img src="/imgs/visualdom/6d64b0b7889e7f020bb020aea5947a09_hd.jpg" alt></p>
<h4 id="1-æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚"><a href="#1-æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚" class="headerlink" title="(1)æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚"></a>(1)æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚</h4><p><img src="/imgs/visualdom/c4ba535164d29fd46383d19512c37349_hd.jpg" alt></p>
<p>åœ¨æ·±åº¦ä¼˜å…ˆéå†çš„æ—¶å€™ï¼Œæ¯éå†åˆ°ä¸€ä¸ªèŠ‚ç‚¹å°±æŠŠè¯¥èŠ‚ç‚¹å’Œæ–°çš„çš„æ ‘è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœæœ‰å·®å¼‚çš„è¯å°±è®°å½•åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">// diff å‡½æ•°ï¼Œå¯¹æ¯”ä¸¤æ£µæ ‘</span><br><span class="line">function diff (oldTree, newTree) &#123;</span><br><span class="line">  var index = 0 // å½“å‰èŠ‚ç‚¹çš„æ ‡å¿—</span><br><span class="line">  var patches = &#123;&#125; // ç”¨æ¥è®°å½•æ¯ä¸ªèŠ‚ç‚¹å·®å¼‚çš„å¯¹è±¡</span><br><span class="line">  dfsWalk(oldTree, newTree, index, patches)</span><br><span class="line">  return patches</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¯¹ä¸¤æ£µæ ‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†</span><br><span class="line">function dfsWalk (oldNode, newNode, index, patches) &#123;</span><br><span class="line">  // å¯¹æ¯”oldNodeå’ŒnewNodeçš„ä¸åŒï¼Œè®°å½•ä¸‹æ¥</span><br><span class="line">  patches[index] = [...]</span><br><span class="line"></span><br><span class="line">  diffChildren(oldNode.children, newNode.children, index, patches)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// éå†å­èŠ‚ç‚¹</span><br><span class="line">function diffChildren (oldChildren, newChildren, index, patches) &#123;</span><br><span class="line">  var leftNode = null</span><br><span class="line">  var currentNodeIndex = index</span><br><span class="line">  oldChildren.forEach(function (child, i) &#123;</span><br><span class="line">    var newChild = newChildren[i]</span><br><span class="line">    currentNodeIndex = (leftNode &amp;&amp; leftNode.count) // è®¡ç®—èŠ‚ç‚¹çš„æ ‡è¯†</span><br><span class="line">      ? currentNodeIndex + leftNode.count + 1</span><br><span class="line">      : currentNodeIndex + 1</span><br><span class="line">    dfsWalk(child, newChild, currentNodeIndex, patches) // æ·±åº¦éå†å­èŠ‚ç‚¹</span><br><span class="line">    leftNode = child</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>#####(2)å·®å¼‚ç±»å‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//æ›¿æ¢</span><br><span class="line">var REPLACE = 0;</span><br><span class="line">//æ’åº</span><br><span class="line">var REORDER = 1;</span><br><span class="line">//å±æ€§å˜åŒ–</span><br><span class="line">var PROPS = 2;</span><br><span class="line">//æ–‡æœ¬</span><br><span class="line">var TEXT = 3;</span><br></pre></td></tr></table></figure></p>
<p>#####(3)åˆ—è¡¨å¯¹æ¯”ç®—æ³•</p>
<p>ç–‘é—®ï¼šä»€ä¹ˆæ˜¯DOM Diffç®—æ³• ï¼Ÿ<br>Webç•Œé¢ç”±DOMæ ‘æ¥æ„æˆï¼Œå½“å…¶ä¸­æŸä¸€éƒ¨åˆ†å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶å®å°±æ˜¯å¯¹åº”çš„æŸä¸ªDOMèŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–ã€‚åœ¨Reactä¸­ï¼Œæ„å»ºUIç•Œé¢çš„æ€è·¯æ˜¯ç”±å½“å‰çŠ¶æ€å†³å®šç•Œé¢ã€‚å‰åä¸¤ä¸ªçŠ¶æ€å°±å¯¹åº”ä¸¤å¥—ç•Œé¢ï¼Œç„¶åç”±Reactæ¥æ¯”è¾ƒä¸¤ä¸ªç•Œé¢çš„åŒºåˆ«ï¼Œè¿™å°±éœ€è¦å¯¹DOMæ ‘è¿›è¡ŒDiffç®—æ³•åˆ†æã€‚</p>
<p>å³ç»™å®šä»»æ„ä¸¤æ£µæ ‘ï¼Œæ‰¾åˆ°æœ€å°‘çš„è½¬æ¢æ­¥éª¤ã€‚ä½†æ˜¯æ ‡å‡†çš„çš„Diffç®—æ³•å¤æ‚åº¦éœ€è¦O(n^3)ï¼Œè¿™æ˜¾ç„¶æ— æ³•æ»¡è¶³æ€§èƒ½è¦æ±‚ã€‚è¦è¾¾åˆ°æ¯æ¬¡ç•Œé¢éƒ½å¯ä»¥æ•´ä½“åˆ·æ–°ç•Œé¢çš„ç›®çš„ï¼ŒåŠ¿å¿…éœ€è¦å¯¹ç®—æ³•è¿›è¡Œä¼˜åŒ–ã€‚è¿™çœ‹ä¸Šå»éå¸¸æœ‰éš¾åº¦ï¼Œç„¶è€ŒFacebookå·¥ç¨‹å¸ˆå´åšåˆ°äº†ï¼Œä»–ä»¬ç»“åˆWebç•Œé¢çš„ç‰¹ç‚¹åšå‡ºäº†ä¸¤ä¸ªç®€å•çš„å‡è®¾ï¼Œä½¿å¾—Diffç®—æ³•å¤æ‚åº¦ç›´æ¥é™ä½åˆ°O(n)</p>
<p>1ã€ä¸¤ä¸ªç›¸åŒç»„ä»¶äº§ç”Ÿç±»ä¼¼çš„DOMç»“æ„ï¼Œä¸åŒçš„ç»„ä»¶äº§ç”Ÿä¸åŒçš„DOMç»“æ„ï¼›<br>2ã€å¯¹äºåŒä¸€å±‚æ¬¡çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡å”¯ä¸€çš„idè¿›è¡ŒåŒºåˆ†ã€‚</p>
<p></p><h4>é€å±‚è¿›è¡ŒèŠ‚ç‚¹æ¯”è¾ƒ</h4><br>åœ¨Reactä¸­ï¼Œæ ‘çš„ç®—æ³•å…¶å®éå¸¸ç®€å•ï¼Œé‚£å°±æ˜¯ä¸¤æ£µæ ‘åªä¼šå¯¹åŒä¸€å±‚æ¬¡çš„èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒ.<br><img src="/imgs/visualdom/0909000.png" alt><p></p>
<p>Reactåªä¼šå¯¹ç›¸åŒé¢œè‰²æ–¹æ¡†å†…çš„DOMèŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå³åŒä¸€ä¸ªçˆ¶èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚å½“å‘ç°èŠ‚ç‚¹å·²ç»ä¸å­˜åœ¨ï¼Œåˆ™è¯¥èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ä¼šè¢«å®Œå…¨åˆ é™¤æ‰ï¼Œä¸ä¼šç”¨äºè¿›ä¸€æ­¥çš„æ¯”è¾ƒã€‚è¿™æ ·åªéœ€è¦å¯¹æ ‘è¿›è¡Œä¸€æ¬¡éå†ï¼Œä¾¿èƒ½å®Œæˆæ•´ä¸ªDOMæ ‘çš„æ¯”è¾ƒã€‚</p>
<h3>ä¾‹å¦‚ï¼š</h3>

<p><img src="/imgs/visualdom/0909001.png" alt></p>
<p>AèŠ‚ç‚¹è¢«æ•´ä¸ªç§»åŠ¨åˆ°DèŠ‚ç‚¹ä¸‹ï¼Œç›´è§‚çš„è€ƒè™‘DOM Diffæ“ä½œåº”è¯¥æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A.parent.remove(A); </span><br><span class="line">D.append(A);</span><br></pre></td></tr></table></figure>
<p>ä½†å› ä¸ºReactåªä¼šç®€å•çš„è€ƒè™‘åŒå±‚èŠ‚ç‚¹çš„ä½ç½®å˜æ¢ï¼Œå¯¹äºä¸åŒå±‚çš„èŠ‚ç‚¹ï¼Œåªæœ‰ç®€å•çš„åˆ›å»ºå’Œåˆ é™¤ã€‚å½“æ ¹èŠ‚ç‚¹å‘ç°å­èŠ‚ç‚¹ä¸­Aä¸è§äº†ï¼Œå°±ä¼šç›´æ¥é”€æ¯Aï¼›è€Œå½“Då‘ç°è‡ªå·±å¤šäº†ä¸€ä¸ªå­èŠ‚ç‚¹Aï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Aä½œä¸ºå­èŠ‚ç‚¹ã€‚å› æ­¤å¯¹äºè¿™ç§ç»“æ„çš„è½¬å˜çš„å®é™…æ“ä½œæ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A.destroy();</span><br><span class="line">A = new A();</span><br><span class="line">A.append(new B());</span><br><span class="line">A.append(new C());</span><br><span class="line">D.append(A);</span><br></pre></td></tr></table></figure>
<h3>list-diff2ç®—æ³• ç®€ä»‹</h3>

<pre><code>oldList = [{id: 1}, {id: 2}, {id: 3}, {id: 4}, {id: 5}, {id: 6}];
newList = [{id: 2}, {id: 3}, {id: 1},];

var moves = diff(oldList, newList, &quot;id&quot;);

// children æ˜¯æºåˆ—è¡¨ æ ¹æ® æ–°åˆ—è¡¨è¿”å› ç§»åŠ¨æˆ–æ–°å¢çš„æ•°æ®ã€‚
// children = [
//     {id: 1},
//     {id: 2},
//     {id: 3},
//     null,
//     null,
//     null
// ]
// moves æ˜¯æºåˆ—è¡¨oldList æ ¹æ®æ–°åˆ—è¡¨newList è¿”å›çš„æ“ä½œï¼Œchildrenä¸ºnullçš„è¯ï¼Œä¾æ¬¡åˆ é™¤æ‰æ‰ï¼Œå› æ­¤è¿”å›çš„æ˜¯
// type = 0 æ˜¯åˆ é™¤æ“ä½œï¼Œ type = 1 æ˜¯æ–°å¢æ“ä½œ
// moves = [
//     {type: 0, index:3},
//     {type: 0, index: 3},
//     {type: 0, index: 3},
//     {type: 0, index: 0},
//     {type: 1, index: 2, item: {id: 1}}
// ]
</code></pre><p><a href="https://www.npmjs.com/package/list-diff2" target="_blank" rel="noopener">npm åº“</a></p>
<p>#####ï¼ˆ4ï¼‰æŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š<br>è§ä»£ç </p>
<p><br><br><br><br><br></p>
<h4 id="å¯¹è™šæ‹ŸDOMçš„è¯¯è§£"><a href="#å¯¹è™šæ‹ŸDOMçš„è¯¯è§£" class="headerlink" title="å¯¹è™šæ‹ŸDOMçš„è¯¯è§£"></a>å¯¹è™šæ‹ŸDOMçš„è¯¯è§£</h4><p>Reactç­‰ä»æ¥æ²¡æœ‰è¯´è¿‡ â€œReact æ¯”åŸç”Ÿæ“ä½œDOMå¿«â€ã€‚Reactç»™æˆ‘ä»¬çš„ä¿è¯æ˜¯ï¼Œåœ¨ä¸éœ€è¦æ‰‹åŠ¨ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œå®ƒä¾ç„¶å¯ä»¥ç»™æˆ‘ä»¬æä¾›è¿‡å¾—å»çš„æ€§èƒ½ã€‚</p>
<p>Reactæ©ç›–äº†åº•å±‚çš„DOMæ“ä½œï¼Œå¯ä»¥ç”¨æ›´å£°æ˜å¼çš„æ–¹å¼æ¥æè¿°æˆ‘ä»¬ç›®çš„ï¼Œä»è€Œè®©ä»£ç æ›´å®¹æ˜“ç»´æŠ¤ã€‚</p>
<p>æ²¡æœ‰ä»»ä½•æ¡†æ¶å¯ä»¥æ¯”çº¯æ‰‹åŠ¨çš„ä¼˜åŒ– DOM æ“ä½œæ›´å¿«ï¼Œå› ä¸ºæ¡†æ¶çš„ DOM æ“ä½œå±‚éœ€è¦åº”å¯¹ä»»ä½•ä¸Šå±‚ API å¯èƒ½äº§ç”Ÿçš„æ“ä½œï¼Œå®ƒçš„å®ç°å¿…é¡»æ˜¯æ™®é€‚çš„ã€‚é’ˆå¯¹ä»»ä½•ä¸€ä¸ª benchmarkï¼Œæˆ‘éƒ½å¯ä»¥å†™å‡ºæ¯”ä»»ä½•æ¡†æ¶æ›´å¿«çš„æ‰‹åŠ¨ä¼˜åŒ–ï¼Œä½†æ˜¯é‚£æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿåœ¨æ„å»ºä¸€ä¸ªå®é™…åº”ç”¨çš„æ—¶å€™ï¼Œä½ éš¾é“ä¸ºæ¯ä¸€ä¸ªåœ°æ–¹éƒ½å»åšæ‰‹åŠ¨ä¼˜åŒ–å—ï¼Ÿå‡ºäºå¯ç»´æŠ¤æ€§çš„è€ƒè™‘ï¼Œè¿™æ˜¾ç„¶ä¸å¯èƒ½ã€‚</p>
<p>####è¿˜æœ‰<br>è™šæ‹Ÿdomå¹¶æ²¡æœ‰æ¯”ç›´æ¥åŸç”Ÿæ“ä½œæ›´å¿«, æ‰€è°“â€å¿«â€æ˜¯æœ‰æ¡ä»¶çš„<br>æ¯”å¦‚æ”¹å˜ä¸ªé¢œè‰², ç›´æ¥æ“ä½œdomä¼šæ›´å¿«.å¦‚æœæ¯æ¬¡éƒ½æ˜¯æ”¹å˜è¯¥æ”¹å˜çš„ã€‚é‚£domæ“ä½œæ°¸è¿œæ¯”è™šæ‹Ÿdomå¿«.ä½†å¦‚æœä½ çš„æ”¹åŠ¨çš„åœ°æ–¹å¾ˆå¤š, è€Œä¸”è¦ä¿æŒçŠ¶æ€, é‚£è™šæ‹Ÿdomçš„è‡ªåŠ¨diffæ— ç–‘ä¼šçœå¿ƒ.<br>å¦‚æœæœ‰å¾ˆå¤šå¤æ‚çš„æ“ä½œï¼ŒA+B+C, è¿™æ—¶å€™ä½ è¦ç›´æ¥æ“ä½œdomä¼šå¾ˆç¹ç.<br>è€Œä¸”è™šæ‹Ÿdomçš„æ ¸å¿ƒåœ¨äºdiff, å®ƒè‡ªåŠ¨å¸®ä½ è®¡ç®—é‚£äº›åº”è¯¥è°ƒæ•´, ç„¶ååªä¿®æ”¹è¯¥ä¿®æ”¹çš„åŒºåŸŸ, çœä¸‹çš„ä¸æ˜¯è¿è¡Œé€Ÿåº¦è¿™ç§é€Ÿåº¦, è€Œä¸”æˆ‘ä»¬å¼€å‘æ–¹é¢çš„ä¸€äº›é€Ÿåº¦ã€‚ä»¥åŠè¿ç»´çš„é€Ÿåº¦ã€‚å…¶æ¬¡ï¼Œå¦‚æœä»»ä½•ä¸€ç‚¹çš„å˜åŒ–éƒ½éœ€è¦é‡æ–°æ¸²æŸ“æ•´ä¸ªåº”ç”¨ï¼Œå¦‚æœæ˜¯çœŸå®DOMçš„è¯ï¼Œè¿™æ ·çš„æ€§èƒ½æ˜¯ä¸èƒ½æ¥å—çš„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/03/05/visual-dom/" data-id="cka3kmlcx00117zo7w16voijm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-å‡ ä¸ªç®€å•æ’åº" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/01/å‡ ä¸ªç®€å•æ’åº/" class="article-date">
  <time datetime="2018-03-01T04:12:00.000Z" itemprop="datePublished">2018-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/01/å‡ ä¸ªç®€å•æ’åº/">å‡ ä¸ªç®€å•æ’åº</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>####1.å¿«é€Ÿæ’åº</p>
<p>åŸºæœ¬æ€æƒ³ï¼š<br>1ï¼‰é€‰æ‹©ä¸€ä¸ªåŸºå‡†å…ƒç´ ,é€šå¸¸é€‰æ‹©ç¬¬ä¸€ä¸ªå…ƒç´ æˆ–è€…æœ€åä¸€ä¸ªå…ƒç´ ,<br>2ï¼‰é€šè¿‡ä¸€è¶Ÿæ’åºè®²å¾…æ’åºçš„è®°å½•åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†è®°å½•çš„å…ƒç´ å€¼å‡æ¯”åŸºå‡†å…ƒç´ å€¼å°ã€‚å¦ä¸€éƒ¨åˆ†è®°å½•çš„ å…ƒç´ å€¼æ¯”åŸºå‡†å€¼å¤§ã€‚<br>3ï¼‰æ­¤æ—¶åŸºå‡†å…ƒç´ åœ¨å…¶æ’å¥½åºåçš„æ­£ç¡®ä½ç½®<br>4ï¼‰ç„¶ååˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†è®°å½•ç”¨åŒæ ·çš„æ–¹æ³•ç»§ç»­è¿›è¡Œæ’åºï¼Œç›´åˆ°æ•´ä¸ªåºåˆ—æœ‰åºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function quickSort(arr) &#123;</span><br><span class="line">    //å¦‚æœæ•°ç»„&lt;=1,åˆ™ç›´æ¥è¿”å›</span><br><span class="line">    if (arr.length &lt;= 1) &#123; return arr; &#125;</span><br><span class="line">    var pivotIndex = Math.floor(arr.length / 2);</span><br><span class="line">    //æ‰¾åŸºå‡†ï¼Œå¹¶æŠŠåŸºå‡†ä»åŸæ•°ç»„åˆ é™¤</span><br><span class="line">    var pivot = arr.splice(pivotIndex, 1)[0];</span><br><span class="line">    //å®šä¹‰å·¦å³æ•°ç»„</span><br><span class="line">    var left = [];</span><br><span class="line">    var right = [];</span><br><span class="line"></span><br><span class="line">    //æ¯”åŸºå‡†å°çš„æ”¾åœ¨leftï¼Œæ¯”åŸºå‡†å¤§çš„æ”¾åœ¨right</span><br><span class="line">    for (var i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">        if (arr[i] &lt;= pivot) &#123;</span><br><span class="line">            left.push(arr[i]);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            right.push(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //é€’å½’</span><br><span class="line">    return quickSort(left).concat([pivot], quickSort(right));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var a = quickSort([0, 33, 43, 32, 39, 2]);</span><br><span class="line">// console.log(a);</span><br></pre></td></tr></table></figure>
<p>2 æ’å…¥æ’åº<br>åŸºæœ¬æ€æƒ³:<br>å°†ä¸€ä¸ªè®°å½•æ’å…¥åˆ°å·²æ’åºå¥½çš„æœ‰åºè¡¨ä¸­ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªæ–°ï¼Œè®°å½•æ•°å¢1çš„æœ‰åºè¡¨ã€‚å³ï¼šå…ˆå°†åºåˆ—çš„ç¬¬1ä¸ªè®°å½•çœ‹æˆæ˜¯ä¸€ä¸ªæœ‰åºçš„å­åºåˆ—ï¼Œç„¶åä»ç¬¬2ä¸ªè®°å½•é€ä¸ªè¿›è¡Œæ’å…¥ï¼Œç›´è‡³æ•´ä¸ªåºåˆ—æœ‰åºä¸ºæ­¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">function sort(elements) &#123;</span><br><span class="line">    //å‡è®¾ç¬¬0ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªæœ‰åºçš„æ•°åˆ—ï¼Œç¬¬1ä¸ªä»¥åçš„æ˜¯æ— åºçš„åºåˆ—ï¼Œ</span><br><span class="line">    //æ‰€ä»¥ä»ç¬¬1ä¸ªå…ƒç´ å¼€å§‹å°†æ— åºæ•°åˆ—çš„å…ƒç´ æ’å…¥åˆ°æœ‰åºæ•°åˆ—ä¸­</span><br><span class="line">    for (var i = 1; i &lt; elements.length; i++) &#123;</span><br><span class="line">        //å‡åº</span><br><span class="line">        if (elements[i] &lt; elements[i - 1]) &#123;</span><br><span class="line">            //å–å‡ºæ— åºæ•°åˆ—ä¸­çš„ç¬¬iä¸ªä½œä¸ºè¢«æ’å…¥å…ƒç´ </span><br><span class="line">            var guard = elements[i];</span><br><span class="line">            //è®°ä½æœ‰åºæ•°åˆ—çš„æœ€åä¸€ä¸ªä½ç½®ï¼Œå¹¶ä¸”å°†æœ‰åºæ•°åˆ—ä½ç½®æ‰©å¤§ä¸€ä¸ª</span><br><span class="line">            var j = i - 1;</span><br><span class="line">            elements[i] = elements[j];</span><br><span class="line"></span><br><span class="line">            //æ¯”å¤§å°ï¼Œæ‰¾åˆ°è¢«æ’å…¥å…ƒç´ æ‰€åœ¨çš„ä½ç½®</span><br><span class="line">            while (j &gt;= 0 &amp;&amp; guard &lt; elements[j]) &#123;</span><br><span class="line">                elements[j + 1] = elements[j];</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            // console.log(j + 1, &apos;ssss&apos;)</span><br><span class="line">            //æ’å…¥</span><br><span class="line">            elements[j + 1] = guard;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var elements = [10, 9, 8, 7, 6, 5];</span><br><span class="line"></span><br><span class="line">// 8 9 10   9</span><br><span class="line">// 8 9 10 10</span><br><span class="line">// console.log(&apos;before: &apos; + elements);</span><br><span class="line">// sort(elements);</span><br><span class="line">// console.log(&apos; after: &apos; + elements);</span><br></pre></td></tr></table></figure>
<p>####3.é€‰æ‹©æ’åº<br>é€‰æ‹©æ’åºï¼ˆSelection sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯æ¯ä¸€æ¬¡ä»å¾…æ’åºçš„æ•°æ®å…ƒç´ ä¸­é€‰å‡ºæœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰çš„ä¸€ä¸ªå…ƒç´ ï¼Œå­˜æ”¾åœ¨åºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œç›´åˆ°å…¨éƒ¨å¾…æ’åºçš„æ•°æ®å…ƒç´ æ’å®Œã€‚ é€‰æ‹©æ’åºæ˜¯ä¸ç¨³å®šçš„æ’åºæ–¹æ³•ï¼ˆæ¯”å¦‚åºåˆ—[5ï¼Œ 5ï¼Œ 3]ç¬¬ä¸€æ¬¡å°±å°†ç¬¬ä¸€ä¸ª[5]ä¸[3]äº¤æ¢ï¼Œå¯¼è‡´ç¬¬ä¸€ä¸ª5æŒªåŠ¨åˆ°ç¬¬äºŒä¸ª5åé¢ï¼‰ã€‚</p>
<p><code></code><br>var example = [8, 94, 15, 88, 55, 76, 21, 39];<br>function selectSort(arr) {<br>    var len = arr.length;<br>    var minIndex, temp;<br>    // console.time(â€˜é€‰æ‹©æ’åºè€—æ—¶â€™);<br>    for (i = 0; i &lt; len - 1; i++) {<br>        minIndex = i;<br>        for (j = i + 1; j &lt; len; j++) {<br>            if (arr[j] &lt; arr[minIndex]) {<br>                minIndex = j;<br>            }<br>        }<br>        temp = arr[i];<br>        arr[i] = arr[minIndex];<br>        arr[minIndex] = temp;<br>    }<br>    // console.timeEnd(â€˜é€‰æ‹©æ’åºè€—æ—¶â€™);<br>    return arr;<br>}<br>// console.log(selectSort(example));<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">####4.å¸Œå°”æ’åº</span><br><span class="line">å¸Œå°”(Shell)æ’åºåˆç§°ä¸ºç¼©å°å¢é‡æ’åºï¼Œå®ƒæ˜¯ä¸€ç§æ’å…¥æ’åºã€‚å®ƒæ˜¯ç›´æ¥æ’å…¥æ’åºç®—æ³•çš„åŠ å¼ºç‰ˆã€‚</span><br><span class="line">å¸Œå°”æ’åºçš„åŸºæœ¬æ€æƒ³ï¼š</span><br><span class="line">æŠŠè®°å½•æŒ‰æ­¥é•¿ gap åˆ†ç»„ï¼Œå¯¹æ¯ç»„è®°å½•é‡‡ç”¨ç›´æ¥æ’å…¥æ’åºæ–¹æ³•è¿›è¡Œæ’åºã€‚</span><br><span class="line">éšç€æ­¥é•¿é€æ¸å‡å°ï¼Œæ‰€åˆ†æˆçš„ç»„åŒ…å«çš„è®°å½•è¶Šæ¥è¶Šå¤šï¼Œå½“æ­¥é•¿çš„å€¼å‡å°åˆ° 1 æ—¶ï¼Œæ•´ä¸ªæ•°æ®åˆæˆä¸ºä¸€ç»„ï¼Œæ„æˆä¸€ç»„æœ‰åºè®°å½•ï¼Œåˆ™å®Œæˆæ’åºã€‚</span><br><span class="line"></span><br><span class="line">å¸Œå°”æ’åºï¼šhttp://blog.csdn.net/morewindows/article/details/6668714</span><br></pre></td></tr></table></figure></p>
<p>var arr1 = [2, 5, 1, 9, 0];<br>function shellSort(arr) {<br>    var gap = Math.floor(arr.length / 2);<br>    while (gap &gt;= 1) {<br>        for (var i = gap; i &lt; arr.length; i++) {<br>            var j, temp = arr[i];<br>            for (j = i - gap; j &gt;= 0 &amp;&amp; temp &lt; arr[j]; j = j - gap) {<br>                arr[j + gap] = arr[j];<br>            }<br>            arr[j + gap] = temp;<br>        }<br>        // console.log(â€œgap=â€ + gap);<br>        // console.log(arr);<br>        gap = Math.floor(gap / 2);<br>    }<br>}<br>shellSort(arr1);</p>
<p>var arr1 = [2, 5, 1, 9, 0, 10];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 5.å½’å¹¶æ’åº</span><br><span class="line">å½’å¹¶æ“ä½œ(merge)ï¼Œä¹Ÿå«å½’å¹¶ç®—æ³•ï¼ŒæŒ‡çš„æ˜¯å°†ä¸¤ä¸ªé¡ºåºåºåˆ—åˆå¹¶æˆä¸€ä¸ªé¡ºåºåºåˆ—çš„æ–¹æ³•ã€‚</span><br><span class="line">å¦‚ã€€è®¾æœ‰æ•°åˆ—&#123;6ï¼Œ202ï¼Œ100ï¼Œ301ï¼Œ38ï¼Œ8ï¼Œ1&#125;</span><br><span class="line">åˆå§‹çŠ¶æ€ï¼š6,202,100,301,38,8,1</span><br><span class="line">ç¬¬ä¸€æ¬¡å½’å¹¶åï¼š&#123;6,202&#125;,&#123;100,301&#125;,&#123;8,38&#125;,&#123;1&#125;ï¼Œæ¯”è¾ƒæ¬¡æ•°ï¼š3ï¼›</span><br><span class="line">ç¬¬äºŒæ¬¡å½’å¹¶åï¼š&#123;6,100,202,301&#125;ï¼Œ&#123;1,8,38&#125;ï¼Œæ¯”è¾ƒæ¬¡æ•°ï¼š4ï¼›</span><br><span class="line">ç¬¬ä¸‰æ¬¡å½’å¹¶åï¼š&#123;1,6,8,38,100,202,301&#125;,æ¯”è¾ƒæ¬¡æ•°ï¼š4ï¼›</span><br><span class="line">æ€»çš„æ¯”è¾ƒæ¬¡æ•°ä¸ºï¼š3+4+4=11,ï¼›</span><br><span class="line">é€†åºæ•°ä¸º14ï¼›</span><br></pre></td></tr></table></figure></p>
<p>function mergeSort(arr) {  //é‡‡ç”¨è‡ªä¸Šè€Œä¸‹çš„é€’å½’æ–¹æ³•<br>    var len = arr.length;<br>    if(len &lt; 2) {<br>        return arr;<br>    }<br>    var middle = Math.floor(len / 2),<br>        left = arr.slice(0, middle),<br>        right = arr.slice(middle);<br>    return merge(mergeSort(left), mergeSort(right));<br>}</p>
<p>function merge(left, right){<br>    var result = [];<br>    while (left.length&gt;0 &amp;&amp; right.length&gt;0) {<br>        if (left[0] &lt;= right[0]) {<br>            result.push(left.shift());<br>        } else {<br>            result.push(right.shift());<br>        }<br>    }<br>    // console.log(left.length, â€˜leftâ€™)<br>    console.log(right.length, â€˜rightâ€™)<br>    while (left.length)<br>        result.push(left.shift());</p>
<pre><code>while (right.length)
    result.push(right.shift());

return result;
</code></pre><p>}<br>var a = mergeSort(arr1);<br>console.log(â€˜aâ€™, a)<br><code>`</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/03/01/å‡ ä¸ªç®€å•æ’åº/" data-id="cka3kmlc500097zo7fu1h0bqq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-æ•°ç»„æ’åºå‡ ç§æ–¹æ³•" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/27/æ•°ç»„æ’åºå‡ ç§æ–¹æ³•/" class="article-date">
  <time datetime="2018-02-27T11:20:47.000Z" itemprop="datePublished">2018-02-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/27/æ•°ç»„æ’åºå‡ ç§æ–¹æ³•/">æ•°ç»„æ’åºå‡ ç§æ–¹æ³•</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##<br>1.éå†æ•°ç»„æ³•<br>æœ€ç®€å•çš„å»é‡æ–¹æ³•.<br>å®ç°æ€è·¯ï¼šæ–°å»ºä¸€æ•°ç»„ï¼Œéå†ä¼ å…¥æ•°ç»„ï¼Œå€¼ä¸åœ¨æ–°æ•°ç»„å°±åŠ å…¥è¯¥æ–°æ•°ç»„ä¸­ï¼›<br>æ³¨æ„ç‚¹ï¼šåˆ¤æ–­å€¼æ˜¯å¦åœ¨æ•°ç»„çš„æ–¹æ³•â€œindexOfâ€æ˜¯ECMAScript5 æ–¹æ³•ï¼ŒIE8ä»¥ä¸‹ä¸æ”¯æŒï¼Œéœ€å¤šå†™ä¸€äº›å…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨ä»£ç </p>
<h3 id="æœ€ç®€å•æ•°ç»„å»é‡æ³•"><a href="#æœ€ç®€å•æ•°ç»„å»é‡æ³•" class="headerlink" title="æœ€ç®€å•æ•°ç»„å»é‡æ³•"></a>æœ€ç®€å•æ•°ç»„å»é‡æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function unique1(array)&#123; </span><br><span class="line">	var n = [];</span><br><span class="line">	for(var i = 0; i &lt; array.length; i++)&#123; </span><br><span class="line">		if (n.indexOf(array[i]) == -1) </span><br><span class="line">			n.push(array[i]);</span><br><span class="line">	&#125; </span><br><span class="line">	return n; </span><br><span class="line">&#125; </span><br><span class="line">var a = [2,3,4,3,5,3];</span><br><span class="line">var b = unique1(a);</span><br></pre></td></tr></table></figure>
<p>2.å¯¹è±¡é”®å€¼å¯¹æ³•<br>è¯¥æ–¹æ³•æ‰§è¡Œçš„é€Ÿåº¦æ¯”å…¶ä»–ä»»ä½•æ–¹æ³•éƒ½å¿«ï¼Œå°±æ˜¯å ç”¨çš„å†…å­˜å¤§ä¸€äº›ã€‚<br>å®ç°æ€è·¯ï¼šæ–°å»ºä¸€jså¯¹è±¡ä»¥åŠæ–°æ•°ç»„ï¼Œéå†ä¼ å…¥æ•°ç»„æ—¶ï¼Œåˆ¤æ–­å€¼æ˜¯å¦ä¸ºjså¯¹è±¡çš„é”®ï¼Œä¸æ˜¯çš„è¯ç»™å¯¹è±¡æ–°å¢è¯¥é”®å¹¶æ”¾å…¥æ–°æ•°ç»„ã€‚<br>æ³¨æ„ç‚¹ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºjså¯¹è±¡é”®æ—¶ï¼Œä¼šè‡ªåŠ¨å¯¹ä¼ å…¥çš„é”®æ‰§è¡Œâ€œtoString()â€ï¼Œä¸åŒçš„é”®å¯èƒ½ä¼šè¢«è¯¯è®¤ä¸ºä¸€æ ·ï¼›ä¾‹å¦‚ï¼š a[1]ã€a[â€œ1â€] ã€‚è§£å†³ä¸Šè¿°é—®é¢˜è¿˜æ˜¯å¾—è°ƒç”¨â€œindexOfâ€ã€‚</p>
<p>###é€Ÿåº¦æœ€å¿«ï¼Œå ç©ºé—´æœ€å¤šï¼ˆç©ºé—´æ¢æ—¶é—´ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function unique2(array)&#123;</span><br><span class="line">	var n = &#123;&#125;, r = [], len = array.length, val, type;</span><br><span class="line">	for (var i = 0; i &lt; array.length; i++) &#123;</span><br><span class="line">		val = array[i]; </span><br><span class="line">		type = typeof val; </span><br><span class="line">		if (!n[val]) &#123;</span><br><span class="line">			n[val] = [type];</span><br><span class="line">			r.push(val);</span><br><span class="line">		&#125; else if (n[val].indexOf(type) &lt; 0) &#123; </span><br><span class="line">			n[val].push(type); </span><br><span class="line">			r.push(val); </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	return r; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var a = [&#123;a:1,b:2&#125;,&#123;a:1,b:2&#125;,2,&apos;2&apos;,3,4,3,5,3];</span><br><span class="line">var b = unique2(a);</span><br></pre></td></tr></table></figure></p>
<p>3.æ•°ç»„ä¸‹æ ‡åˆ¤æ–­æ³•<br>è¿˜æ˜¯å¾—è°ƒç”¨â€œindexOfâ€æ€§èƒ½è·Ÿæ–¹æ³•1å·®ä¸å¤šï¼Œ<br>å®ç°æ€è·¯ï¼šå¦‚æœå½“å‰æ•°ç»„çš„ç¬¬ié¡¹åœ¨å½“å‰æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸æ˜¯iï¼Œé‚£ä¹ˆè¡¨ç¤ºç¬¬ié¡¹æ˜¯é‡å¤çš„ï¼Œå¿½ç•¥æ‰ã€‚å¦åˆ™å­˜å…¥ç»“æœæ•°ç»„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function unique3(array)&#123; </span><br><span class="line">	var n = [array[0]]; //ç»“æœæ•°ç»„ </span><br><span class="line">	//ä»ç¬¬äºŒé¡¹å¼€å§‹éå† </span><br><span class="line">	for(var i = 1; i &lt; array.length; i++) &#123; </span><br><span class="line">		//å¦‚æœå½“å‰æ•°ç»„çš„ç¬¬ié¡¹åœ¨å½“å‰æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸æ˜¯iï¼Œ </span><br><span class="line">		//é‚£ä¹ˆè¡¨ç¤ºç¬¬ié¡¹æ˜¯é‡å¤çš„ï¼Œå¿½ç•¥æ‰ã€‚å¦åˆ™å­˜å…¥ç»“æœæ•°ç»„ </span><br><span class="line">		if (array.indexOf(array[i]) == i) &#123;</span><br><span class="line">			n.push(array[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	return n; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">var a = [2,3,4,3,5,3];</span><br><span class="line">var b = unique3(a);</span><br><span class="line">// console.log(&apos;three:&apos; + b);</span><br></pre></td></tr></table></figure>
<p>4.æ’åºåç›¸é‚»å»é™¤æ³•<br>åŸç”Ÿæ•°ç»„çš„â€sortâ€æ–¹æ³•æ’åºç»“æœä¸æ€ä¹ˆé è°±ï¼Œå¯¹äºä¸è¦æ±‚é¡ºåºçš„å»é‡éœ€æ±‚æ²¡ä»€ä¹ˆé—®é¢˜ã€‚<br>å®ç°æ€è·¯ï¼šç»™ä¼ å…¥æ•°ç»„æ’åºï¼Œæ’åºåç›¸åŒå€¼ç›¸é‚»ï¼Œç„¶åéå†æ—¶æ–°æ•°ç»„åªåŠ å…¥ä¸ä¸å‰ä¸€å€¼é‡å¤çš„å€¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// å°†ç›¸åŒçš„å€¼ç›¸é‚»ï¼Œç„¶åéå†å»é™¤é‡å¤å€¼</span><br><span class="line">function unique4(array)&#123;</span><br><span class="line">	array.sort();</span><br><span class="line">	var re=[array[0]];</span><br><span class="line">	for(var i = 1; i &lt; array.length; i++)&#123; </span><br><span class="line">		if( array[i] !== re[re.length-1])&#123; </span><br><span class="line">			re.push(array[i]); </span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	return re; </span><br><span class="line">&#125;</span><br><span class="line">var a = [2,3,4,3,3,5,3];</span><br><span class="line">var b = unique4(a);</span><br><span class="line">// console.log(b);</span><br></pre></td></tr></table></figure></p>
<p>5.ä¼˜åŒ–éå†æ•°ç»„æ³•<br>å®ç°æ€è·¯ï¼šè·å–æ²¡é‡å¤çš„æœ€å³ä¸€å€¼æ”¾å…¥æ–°æ•°ç»„ã€‚ï¼ˆæ£€æµ‹åˆ°æœ‰é‡å¤å€¼æ—¶ç»ˆæ­¢å½“å‰å¾ªç¯åŒæ—¶è¿›å…¥é¡¶å±‚å¾ªç¯çš„ä¸‹ä¸€è½®åˆ¤æ–­ï¼‰<br>ç®€å•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function unique5(array)&#123;</span><br><span class="line">	var r = [];</span><br><span class="line">	for(var i = 0, l = array.length; i &lt; l; i++) &#123;</span><br><span class="line">		// console.log(i);</span><br><span class="line">		for(var j = i + 1; j &lt; l; j++) &#123;</span><br><span class="line">			// console.log(i+&apos;-----&apos;+j);</span><br><span class="line">			if (array[i] === array[j]) &#123;</span><br><span class="line">				i++;</span><br><span class="line">				j = i;</span><br><span class="line">				// j = ++i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		console.log(array[i]);</span><br><span class="line">		r.push(array[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	return r;</span><br><span class="line">&#125;</span><br><span class="line">var a = [2,3,4,3,2,3,5,3];</span><br><span class="line">var b = unique5(a);</span><br><span class="line">console.log(&apos;unique5:&apos;+b);</span><br></pre></td></tr></table></figure></p>
<p>6.åˆ é™¤æœ‰é‡å¤çš„å…ƒç´ æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function unique6(array)&#123;</span><br><span class="line">	var arrayN = array.slice();</span><br><span class="line">	for(var i = 0 ; i &lt; arrayN.length; i++) &#123;</span><br><span class="line">		for(var j = i + 1; j &lt; arrayN.length; j++) &#123;</span><br><span class="line">			if (arrayN[i] === arrayN[j]) &#123;</span><br><span class="line">				arrayN.splice(j,1);</span><br><span class="line">				i-- ; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return arrayN; </span><br><span class="line">&#125;</span><br><span class="line">var a = [2,3,4,3,2,3,3,5,3];</span><br><span class="line">var b = unique6(a);</span><br><span class="line">// console.log(&apos;unique6:&apos;+b);</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>$.unique([2,3,4,3,2,3,5,3]);<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// var a = [2,3,4,3,2,3,3,5,3];</span><br><span class="line">// var b = $.unique([2,3,4,3,2,3,5,3]);</span><br><span class="line">// console.log(&apos;last:&apos; + b);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>8æ­£åˆ™åŒ¹é…ï¼Œä¸é€‚ç”¨å¤æ‚çš„æ•°æ®ç»“æ„<br>åŸç†åŸºæœ¬å·®ä¸å¤šï¼Œæ•ˆç‡æˆ‘è¿˜æ²¡æœ‰éªŒè¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function unique7(array)&#123;</span><br><span class="line">	var rArr = [];</span><br><span class="line">	for(var i = 0,len = array.length;i &lt; len; i++)&#123; </span><br><span class="line">		!RegExp(array[i],&quot;g&quot;).test(rArr.join(&quot;,&quot;)) &amp;&amp; (rArr.push(array[i])); </span><br><span class="line">	&#125;</span><br><span class="line">	return rArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var a = [2,3,4,3,2,3,3,5,3,&apos;3&apos;];</span><br><span class="line">var b = unique7(a);</span><br><span class="line">// console.log(&apos;unique7: &apos;+ b);</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/02/27/æ•°ç»„æ’åºå‡ ç§æ–¹æ³•/" data-id="cka3kmlc6000b7zo7pcdng0b1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-å…³äºæ•°ç»„" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/27/å…³äºæ•°ç»„/" class="article-date">
  <time datetime="2018-02-27T09:02:57.000Z" itemprop="datePublished">2018-02-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/27/å…³äºæ•°ç»„/">å…³äºæ•°ç»„Array</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#ABOUT ARRAY</p>
<h4 id="Arrayæ„é€ å™¨"><a href="#Arrayæ„é€ å™¨" class="headerlink" title="Arrayæ„é€ å™¨"></a>Arrayæ„é€ å™¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨Arrayæ„é€ å™¨</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="built_in">Array</span>(<span class="number">8</span>); <span class="comment">// [undefined Ã— 8]</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨å¯¹è±¡å­—é¢é‡</span></span><br><span class="line"><span class="keyword">var</span> b = [];</span><br><span class="line">b.length = <span class="number">8</span>; <span class="comment">// [undefined Ã— 8]</span></span><br></pre></td></tr></table></figure>
<h4 id="ES6æ–°å¢çš„æ„é€ å‡½æ•°æ–¹æ³•"><a href="#ES6æ–°å¢çš„æ„é€ å‡½æ•°æ–¹æ³•" class="headerlink" title="ES6æ–°å¢çš„æ„é€ å‡½æ•°æ–¹æ³•"></a>ES6æ–°å¢çš„æ„é€ å‡½æ•°æ–¹æ³•</h4><p>ES6ä¸“é—¨æ‰©å±•äº†æ•°ç»„æ„é€ å™¨Array ï¼Œæ–°å¢2ä¸ªæ–¹æ³•ï¼šArray.ofã€Array.fromã€‚</p>
<h5 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of"></a>Array.of</h5><p>Array.ofåŸºæœ¬ä¸Šå¯ä»¥ç”¨æ¥æ›¿ä»£Array()æˆ–new Array()ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ç”±äºå‚æ•°ä¸åŒè€Œå¯¼è‡´çš„é‡è½½ã€‚å®ƒçš„è¡Œä¸ºéå¸¸ç»Ÿä¸€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Array.of() // []</span><br><span class="line">Array.of(undefined) // [undefined]</span><br><span class="line">Array.of(1) // [1]</span><br><span class="line">Array.of(1, 2) // [1, 2]</span><br></pre></td></tr></table></figure>
<p>#####Array.from</p>
<p>Array.fromæ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼š<br>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡  å’Œå¯éå†ï¼ˆiterableï¼‰çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ES6æ–°å¢çš„æ•°æ®ç»“æ„Setå’ŒMapï¼‰ã€‚</p>
<p>Array.fromçš„è®¾è®¡åˆè¡·æ˜¯å¿«é€Ÿä¾¿æ·çš„åŸºäºå…¶ä»–å¯¹è±¡åˆ›å»ºæ–°æ•°ç»„ï¼Œå‡†ç¡®æ¥è¯´å°±æ˜¯ä»ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å®ä¾‹ï¼Œåªè¦ä¸€ä¸ªå¯¹è±¡æœ‰è¿­ä»£å™¨ï¼ŒArray.fromå°±èƒ½æŠŠå®ƒå˜æˆä¸€ä¸ªæ•°ç»„ï¼ˆå½“ç„¶ï¼Œæ˜¯è¿”å›æ–°çš„æ•°ç»„ï¼Œä¸æ”¹å˜åŸå¯¹è±¡ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">let arrayLike = &#123;</span><br><span class="line">    &apos;0&apos;: &apos;a&apos;,</span><br><span class="line">    &apos;1&apos;: &apos;b&apos;,</span><br><span class="line">    &apos;2&apos;: &apos;c&apos;,</span><br><span class="line">    length: 3</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// ES5çš„å†™æ³•</span><br><span class="line">var arr1 = [].slice.call(arrayLike); // [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]</span><br><span class="line"></span><br><span class="line">// ES6çš„å†™æ³•</span><br><span class="line">let arr2 = Array.from(arrayLike); // [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;0: &apos;a&apos;, 1: &apos;b&apos;, 2:&apos;c&apos;, length: 3&#125;;</span><br><span class="line">Array.from(obj, (value) =&gt; value.repeat(3));</span><br></pre></td></tr></table></figure>
<h5 id="Array-isArray"><a href="#Array-isArray" class="headerlink" title="Array.isArray"></a>Array.isArray</h5><p>Array.isArrayç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ•°ç»„ç±»å‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array.isArray([]);</span><br></pre></td></tr></table></figure></p>
<h4 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><p>æ•°ç»„åŸå‹æä¾›çš„æ–¹æ³•éå¸¸å¤šï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼Œä¸€ç§æ˜¯ä¼šæ”¹å˜è‡ªèº«å€¼çš„ï¼Œä¸€ç§æ˜¯ä¸ä¼šæ”¹å˜è‡ªèº«å€¼çš„ï¼Œè¿˜æœ‰å°±æ˜¯éå†æ–¹æ³•ã€‚<br>ç”±äº Array.prototype çš„æŸäº›å±æ€§è¢«è®¾ç½®ä¸º[[DontEnum]]ï¼Œå› æ­¤ä¸èƒ½ç”¨ä¸€èˆ¬çš„æ–¹æ³•è¿›è¡Œéå†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å– Array.prototype çš„æ‰€æœ‰æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Array.prototy;</span><br><span class="line"></span><br><span class="line">Object.getOwnPropertyNames(Array.prototype);</span><br></pre></td></tr></table></figure>
<p>#####æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•(9ä¸ª)<br>æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•ä¸€å…±æœ‰9ä¸ªï¼Œåˆ†åˆ«ä¸ºpopã€pushã€reverseã€shiftã€sortã€spliceã€unshiftï¼Œä»¥åŠä¸¤ä¸ªES6æ–°å¢çš„æ–¹æ³•copyWithin å’Œ fillã€‚</p>
<p>#####pop<br>pop()æ–¹æ³•åˆ é™¤ä¸€ä¸ªæ•°ç»„ä¸­çš„æœ€åçš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¿”å›è¿™ä¸ªå…ƒç´ ã€‚å¦‚æœæ˜¯æ ˆçš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ ˆé¡¶å¼¹å‡ºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;cat&quot;, &quot;dog&quot;, &quot;cow&quot;, &quot;chicken&quot;, &quot;mouse&quot;];</span><br><span class="line">var item = array.pop();</span><br><span class="line">console.log(array); // [&quot;cat&quot;, &quot;dog&quot;, &quot;cow&quot;, &quot;chicken&quot;]</span><br><span class="line">console.log(item); // mouse</span><br></pre></td></tr></table></figure>
<p>#####push<br>push()æ–¹æ³•æ·»åŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ åˆ°æ•°ç»„æœ«å°¾ï¼Œå¹¶ä¸”è¿”å›æ•°ç»„æ–°çš„é•¿åº¦ã€‚å¦‚æœæ˜¯æ ˆçš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ ˆé¡¶å‹å…¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;football&quot;, &quot;basketball&quot;, &quot;volleyball&quot;, &quot;Table tennis&quot;, &quot;badminton&quot;];</span><br><span class="line">var i = array.push(&quot;golfball&quot;);</span><br><span class="line">console.log(array); // [&quot;football&quot;, &quot;basketball&quot;, &quot;volleyball&quot;, &quot;Table tennis&quot;, &quot;badminton&quot;, &quot;golfball&quot;]</span><br><span class="line">console.log(i); // 6</span><br></pre></td></tr></table></figure>
<p>#####reverse<br>reverse()æ–¹æ³•é¢ å€’æ•°ç»„ä¸­å…ƒç´ çš„ä½ç½®ï¼Œç¬¬ä¸€ä¸ªä¼šæˆä¸ºæœ€åä¸€ä¸ªï¼Œæœ€åä¸€ä¸ªä¼šæˆä¸ºç¬¬ä¸€ä¸ªï¼Œè¯¥æ–¹æ³•è¿”å›å¯¹æ•°ç»„çš„å¼•ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [1,2,3,4,5];</span><br><span class="line">var array2 = array.reverse();</span><br><span class="line">console.log(array); // [5,4,3,2,1]</span><br><span class="line">console.log(array2===array); // true</span><br></pre></td></tr></table></figure>
<p>#####shift<br>shift()æ–¹æ³•åˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [1,2,3,4,5];</span><br><span class="line">var item = array.shift();</span><br><span class="line">console.log(array); // [2,3,4,5]</span><br><span class="line">console.log(item); //</span><br></pre></td></tr></table></figure>
<p>#####sort<br>sort()æ–¹æ³•å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åºï¼Œå¹¶è¿”å›è¿™ä¸ªæ•°ç»„ã€‚</p>
<p>å‚æ•°å¯é€‰ï¼Œå¦‚æœçœç•¥ï¼Œæ•°ç»„å…ƒç´ å°†æŒ‰ç…§å„è‡ªè½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„Unicodeä½ç‚¹é¡ºåºæ’åºï¼Œä¾‹å¦‚â€Boyâ€å°†æ’åˆ°â€appleâ€ä¹‹å‰ã€‚å½“å¯¹æ•°å­—æ’åºçš„æ—¶å€™ï¼Œ25å°†ä¼šæ’åˆ°8ä¹‹å‰ï¼Œå› ä¸ºè½¬æ¢ä¸ºå­—ç¬¦ä¸²åï¼Œâ€25â€å°†æ¯”â€8â€é å‰ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;apple&quot;,&quot;Boy&quot;,&quot;Cat&quot;,&quot;dog&quot;];</span><br><span class="line">var array2 = array.sort();</span><br><span class="line">console.log(array); // [&quot;Boy&quot;, &quot;Cat&quot;, &quot;apple&quot;, &quot;dog&quot;]</span><br><span class="line">console.log(array2 == array); // true</span><br><span class="line">array = [10, 1, 3, 20];</span><br><span class="line">var array3 = array.sort();</span><br><span class="line">console.log(array3); // [1, 10, 20, 3]</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæŒ‡æ˜äº†comparefnï¼Œæ•°ç»„å°†æŒ‰ç…§è°ƒç”¨è¯¥å‡½æ•°çš„è¿”å›å€¼æ¥æ’åºã€‚è‹¥ a å’Œ b æ˜¯ä¸¤ä¸ªå°†è¦æ¯”è¾ƒçš„å…ƒç´ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è‹¥ comparefn(a, b) &lt; 0ï¼Œé‚£ä¹ˆaå°†æ’åˆ°bå‰é¢ï¼›</span><br><span class="line">è‹¥ comparefn(a, b) = 0ï¼Œé‚£ä¹ˆaå’Œbç›¸å¯¹ä½ç½®ä¸å˜ï¼›</span><br><span class="line">è‹¥ comparefn(a, b) &gt; 0ï¼Œé‚£ä¹ˆa,bå°†è°ƒæ¢ä½ç½®ï¼›</span><br></pre></td></tr></table></figure>
<p>#####splice<br>splice()æ–¹æ³•ç”¨æ–°å…ƒç´ æ›¿æ¢æ—§å…ƒç´ çš„æ–¹å¼æ¥ä¿®æ”¹æ•°ç»„ã€‚</p>
<p>è¯­æ³•ï¼šarr.splice(start,deleteCount[, item1[, item2[, â€¦]]])<br>startæŒ‡å®šä»å“ªä¸€ä½å¼€å§‹ä¿®æ”¹å†…å®¹ã€‚å¦‚æœè¶…è¿‡äº†æ•°ç»„é•¿åº¦ï¼Œåˆ™ä»æ•°ç»„æœ«å°¾å¼€å§‹æ·»åŠ å†…å®¹ï¼›å¦‚æœæ˜¯è´Ÿå€¼ï¼Œåˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäºlength+startï¼Œè¡¨ç¤ºä»æ•°ç»„æœ«å°¾å¼€å§‹çš„ç¬¬ -start ä½ã€‚</p>
<p>deleteCount:æŒ‡å®šè¦åˆ é™¤çš„å…ƒç´ ä¸ªæ•°ï¼Œè‹¥ç­‰äº0ï¼Œåˆ™ä¸åˆ é™¤ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè‡³å°‘åº”è¯¥æ·»åŠ ä¸€ä½æ–°å…ƒç´ ï¼Œè‹¥å¤§äºstartä¹‹åçš„å…ƒç´ æ€»å’Œï¼Œåˆ™startåŠä¹‹åçš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ã€‚</p>
<p>itemN: æŒ‡å®šæ–°å¢çš„å…ƒç´ ï¼Œå¦‚æœç¼ºçœï¼Œåˆ™è¯¥æ–¹æ³•åªåˆ é™¤æ•°ç»„å…ƒç´ ã€‚</p>
<p>è¿”å›å€¼: ç”±åŸæ•°ç»„ä¸­è¢«åˆ é™¤å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰åˆ é™¤ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;apple&quot;,&quot;boy&quot;, &quot;girl&quot;];</span><br><span class="line">var splices = array.splice(1,1);</span><br><span class="line">console.log(array); //  [&quot;apple&quot;, &quot;girl&quot;]</span><br><span class="line">console.log(splices); // [&quot;boy&quot;] å¯è§æ˜¯ä»æ•°ç»„ä¸‹æ ‡ä¸º1çš„å…ƒç´ å¼€å§‹åˆ é™¤,å¹¶ä¸”åˆ é™¤ä¸€ä¸ªå…ƒç´ ,ç”±äºitemNç¼ºçœ,æ•…æ­¤æ—¶è¯¥æ–¹æ³•åªåˆ é™¤å…ƒç´ </span><br><span class="line"></span><br><span class="line">array = [&quot;apple&quot;,&quot;boy&quot;];</span><br><span class="line">splices = array.splice(2,1,&quot;cat&quot;);</span><br><span class="line">console.log(array); // [&quot;apple&quot;, &quot;boy&quot;, &quot;cat&quot;]</span><br><span class="line">console.log(splices); // [], å¯è§ç”±äºstartè¶…è¿‡æ•°ç»„é•¿åº¦,æ­¤æ—¶ä»æ•°ç»„æœ«å°¾å¼€å§‹æ·»åŠ å…ƒç´ ,å¹¶ä¸”åŸæ•°ç»„ä¸ä¼šå‘ç”Ÿåˆ é™¤è¡Œä¸º</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦åˆ é™¤æ•°ç»„ä¸­ä¸€ä¸ªå·²å­˜åœ¨çš„å…ƒç´ ï¼Œå¯å‚è€ƒ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var array = [&apos;a&apos;,&apos;b&apos;,&apos;c&apos;];</span><br><span class="line">array.splice(array.indexOf(&apos;b&apos;),1);</span><br></pre></td></tr></table></figure>
<p>#####unshift</p>
<p>unshift() æ–¹æ³•ç”¨äºåœ¨æ•°ç»„å¼€å§‹å¤„æ’å…¥ä¸€äº›å…ƒç´ ï¼Œå¹¶è¿”å›æ•°ç»„æ–°çš„é•¿åº¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;];</span><br><span class="line">var length = array.unshift(&quot;yellow&quot;);</span><br><span class="line">console.log(array); // [&quot;yellow&quot;, &quot;red&quot;, &quot;green&quot;, &quot;blue&quot;]</span><br><span class="line">console.log(length); // 4</span><br></pre></td></tr></table></figure>
<p>#####copyWithin(ES6)<br>åœ¨å½“å‰æ•°ç»„å†…éƒ¨ï¼Œå°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼ˆä¼šè¦†ç›–åŸæœ‰æˆå‘˜ï¼‰ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šä¿®æ”¹å½“å‰æ•°ç»„ã€‚</p>
<p>å®ƒæ¥å—ä¸‰ä¸ªå‚æ•°ã€‚<br>targetï¼ˆå¿…éœ€ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ã€‚<br>startï¼ˆå¯é€‰ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚<br>endï¼ˆå¯é€‰ï¼‰ï¼šåˆ°è¯¥ä½ç½®å‰åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°</p>
<p>ä»targetä½ç½®å¼€å§‹æ›¿æ¢æˆä»start åˆ°end çš„æ•°æ®ã€‚</p>
<p>Array.prototype.copyWithin(target, start = 0, end = this.length)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var array = [1,2,3,4,5]; </span><br><span class="line">var array2 = array.copyWithin(0,3);</span><br><span class="line">console.log(array===array2,array2); // true [4, 5, 3, 4, 5]</span><br><span class="line">var array = [1,2,3,4,5]; </span><br><span class="line">console.log(array.copyWithin(0,3,4)); // [4, 2, 3, 4, 5]</span><br><span class="line">var array = [1,2,3,4,5]; </span><br><span class="line">console.log(array.copyWithin(0,-2,-1)); // [4, 2, 3, 4, 5]</span><br></pre></td></tr></table></figure>
<p>#####fill(ES6)</p>
<p>fill()åŸºäºES6ï¼Œfillæ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚å®ƒåŒæ ·ç”¨äºæ•°ç»„å…ƒç´ æ›¿æ¢ï¼Œä½†ä¸copyWithinç•¥æœ‰ä¸åŒï¼Œå®ƒä¸»è¦ç”¨äºå°†æ•°ç»„æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ æ›¿æ¢ä¸ºæŸä¸ªå€¼ã€‚<br>è¯­æ³•ï¼šarr.fill(value, start[, end = this.length])<br>value æŒ‡å®šè¢«æ›¿æ¢çš„å€¼ï¼Œstart æŒ‡å®šæ›¿æ¢å…ƒç´ èµ·å§‹çš„ç´¢å¼•ï¼Œend å¯é€‰ï¼ŒæŒ‡çš„æ˜¯æ›¿æ¢å…ƒç´ ç»“æŸä½ç½®çš„ç´¢å¼•ã€‚<br>å¦‚æœstartä¸ºè´Ÿï¼Œåˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäºlength+startï¼Œlengthä¸ºæ•°ç»„çš„é•¿åº¦ã€‚endä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;].fill(7)</span><br><span class="line">// [7, 7, 7]</span><br><span class="line"></span><br><span class="line">new Array(3).fill(7)</span><br><span class="line">// [7, 7, 7]</span><br><span class="line"></span><br><span class="line">var array = [1,2,3,4,5];</span><br><span class="line">var array2 = array.fill(10,0,3);</span><br><span class="line">console.log(array===array2,array2); // true [10, 10, 10, 4, 5], å¯è§æ•°ç»„åŒºé—´[0,3]çš„å…ƒç´ å…¨éƒ¨æ›¿æ¢ä¸º10</span><br><span class="line">// å…¶ä»–çš„ä¸¾ä¾‹è¯·å‚è€ƒcopyWithin</span><br></pre></td></tr></table></figure>
<p>####ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•(9ä¸ª)<br>ä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•ä¸€å…±æœ‰9ä¸ªã€‚åˆ†åˆ«ä¸ºconcatã€joinã€sliceã€toStringã€toLocateStringã€indexOfã€lastIndexOfã€æœªæ ‡å‡†çš„toSourceä»¥åŠES7æ–°å¢çš„æ–¹æ³•includesã€‚</p>
<p>#####concat<br>concat() æ–¹æ³•å°†ä¼ å…¥çš„æ•°ç»„æˆ–è€…å…ƒç´ ä¸åŸæ•°ç»„åˆå¹¶ï¼Œç»„æˆä¸€ä¸ªæ–°çš„æ•°ç»„å¹¶è¿”å›ã€‚<br>è¯­æ³•ï¼šarr.concat(value1, value2, â€¦, valueN)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [1, 2, 3];</span><br><span class="line">var array2 = array.concat(4,[5,6],[7,8,9]);</span><br><span class="line">console.log(array2); // [1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">console.log(array); // [1, 2, 3], åŸæ•°ç»„å¹¶æœªè¢«ä¿®æ”¹</span><br></pre></td></tr></table></figure>
<p>å¤åˆ¶æ•°ç»„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var array = [&#123;a: 1&#125;];</span><br><span class="line">var array3 = array.concat();</span><br><span class="line">console.log(array3); // [&#123;a: 1&#125;]</span><br><span class="line">console.log(array3 === array); // false</span><br><span class="line">console.log(array[0] === array3[0]); // trueï¼Œæ–°æ—§æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ä¾æ—§å…±ç”¨ä¸€ä¸ªåŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨</span><br></pre></td></tr></table></figure></p>
<p>é“¾æ¥æ•°ç»„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a = [1,2], b = [3,4];</span><br><span class="line">[...a, ...b]</span><br></pre></td></tr></table></figure></p>
<p>#####join<br>join() æ–¹æ³•å°†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<br>è¯­æ³•ï¼šarr.join([separator = â€˜,â€™]) separatorå¯é€‰ï¼Œç¼ºçœé»˜è®¤ä¸ºé€—å·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];</span><br><span class="line">console.log(array.join()); // a,b,c</span><br><span class="line">console.log(array.join(&apos;+&apos;)); // a+b+c</span><br><span class="line">console.log(array.join(&apos;&apos;)); // abc</span><br></pre></td></tr></table></figure>
<p>####slice<br>slice() æ–¹æ³•å°†æ•°ç»„ä¸­ä¸€éƒ¨åˆ†å…ƒç´ æµ…å¤åˆ¶å­˜å…¥æ–°çš„æ•°ç»„å¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›è¿™ä¸ªæ•°ç»„å¯¹è±¡ã€‚<br>è¯­æ³•ï¼šarr.slice([start[, end]])<br>å‚æ•° start æŒ‡å®šå¤åˆ¶å¼€å§‹ä½ç½®çš„ç´¢å¼•ï¼Œendå¦‚æœæœ‰å€¼åˆ™è¡¨ç¤ºå¤åˆ¶ç»“æŸä½ç½®çš„ç´¢å¼•ï¼ˆä¸åŒ…æ‹¬æ­¤ä½ç½®ï¼‰ã€‚<br>å¦‚æœ start çš„å€¼ä¸ºè´Ÿæ•°ï¼Œå‡å¦‚æ•°ç»„é•¿åº¦ä¸º lengthï¼Œåˆ™è¡¨ç¤ºä» length+start çš„ä½ç½®å¼€å§‹å¤åˆ¶ï¼Œæ­¤æ—¶å‚æ•° end å¦‚æœæœ‰å€¼ï¼Œåªèƒ½æ˜¯æ¯” start å¤§çš„è´Ÿæ•°ï¼Œå¦åˆ™å°†è¿”å›ç©ºæ•°ç»„ã€‚<br>sliceæ–¹æ³•å‚æ•°ä¸ºç©ºæ—¶ï¼ŒåŒconcatæ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯æµ…å¤åˆ¶ç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;,&quot;four&quot;, &quot;five&quot;];</span><br><span class="line">console.log(array.slice()); // [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;,&quot;four&quot;, &quot;five&quot;]</span><br><span class="line">console.log(array.slice(2,3)); // [&quot;three&quot;]</span><br></pre></td></tr></table></figure></p>
<p>æµ…å¤åˆ¶æ˜¯æŒ‡å½“å¯¹è±¡çš„è¢«å¤åˆ¶æ—¶ï¼Œåªæ˜¯å¤åˆ¶äº†å¯¹è±¡çš„å¼•ç”¨ï¼ŒæŒ‡å‘çš„ä¾ç„¶æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚ä¸‹é¢æ¥è¯´æ˜sliceä¸ºä»€ä¹ˆæ˜¯æµ…å¤åˆ¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var array = [&#123;color:&quot;yellow&quot;&#125;, 2, 3];</span><br><span class="line">var array2 = array.slice(0,1);</span><br><span class="line">console.log(array2); // [&#123;color:&quot;yellow&quot;&#125;]</span><br><span class="line">array[0][&quot;color&quot;] = &quot;blue&quot;;</span><br><span class="line">console.log(array2); // [&#123;color:&quot;bule&quot;&#125;]</span><br></pre></td></tr></table></figure>
<p>#####toString<br>toString()æ–¹æ³•è¿”å›æ•°ç»„çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œè¯¥å­—ç¬¦ä¸²ç”±æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ toString() è¿”å›å€¼ç»è°ƒç”¨join()æ–¹æ³•è¿æ¥ï¼ˆç”±é€—å·éš”å¼€ï¼‰ç»„æˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var array = [&apos;Jan&apos;, &apos;Feb&apos;, &apos;Mar&apos;, &apos;Apr&apos;];</span><br><span class="line">var str = array.toString();</span><br><span class="line">console.log(str); // Jan,Feb,Mar,Apr</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šå½“æ•°ç»„ç›´æ¥å’Œå­—ç¬¦ä¸²ä½œè¿æ¥æ“ä½œæ—¶ï¼Œå°†ä¼šè‡ªåŠ¨è°ƒç”¨å…¶toString()æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var str = [&apos;Jan&apos;, &apos;Feb&apos;, &apos;Mar&apos;, &apos;Apr&apos;] + &apos;,May&apos;;</span><br><span class="line">console.log(str); // &quot;Jan,Feb,Mar,Apr,May&quot;</span><br></pre></td></tr></table></figure>
<p>#####toLocaleString<br>toLocaleString()ç±»ä¼¼toString()çš„å˜å‹ï¼Œè¯¥å­—ç¬¦ä¸²ç”±æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ toLocaleString()è¿”å›å€¼ç»è°ƒç”¨join()æ–¹æ³•è¿æ¥ï¼ˆç”±é€—å·éš”å¼€ï¼‰ç»„æˆã€‚</p>
<p>æ•°ç»„ä¸­çš„å…ƒç´ å°†è°ƒç”¨å„è‡ªçš„toLocaleStringæ–¹æ³•ï¼š<br>Objectï¼šObject.prototype.toLocaleString()<br>Numberï¼šNumber.prototype.toLocaleString()<br>Dateï¼šDate.prototype.toLocaleString()<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var array= [&#123;name:&apos;zz&apos;&#125;, 123, &quot;abc&quot;, new Date()];</span><br><span class="line">var str = array.toLocaleString();</span><br><span class="line">console.log(str); // [object Object],123,abc,2017/9/1 ä¸‹åˆ1:06:23</span><br></pre></td></tr></table></figure></p>
<p>#####indexOf<br>indexOf() æ–¹æ³•ç”¨äºæŸ¥æ‰¾å…ƒç´ åœ¨æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°æ—¶çš„ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿”å›-1ã€‚<br>è¯­æ³•ï¼šarr.indexOf(element, fromIndex=0)<br>element ä¸ºéœ€è¦æŸ¥æ‰¾çš„å…ƒç´ ã€‚<br>fromIndex ä¸ºå¼€å§‹æŸ¥æ‰¾çš„ä½ç½®ï¼Œç¼ºçœé»˜è®¤ä¸º0ã€‚å¦‚æœè¶…å‡ºæ•°ç»„é•¿åº¦ï¼Œåˆ™è¿”å›-1ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œå‡è®¾æ•°ç»„é•¿åº¦ä¸ºlengthï¼Œåˆ™ä»æ•°ç»„çš„ç¬¬ length + fromIndexé¡¹å¼€å§‹å¾€æ•°ç»„æœ«å°¾æŸ¥æ‰¾ï¼Œå¦‚æœlength + fromIndex&lt;0 åˆ™æ•´ä¸ªæ•°ç»„éƒ½ä¼šè¢«æŸ¥æ‰¾ã€‚</p>
<p>indexOfä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰ï¼ˆå³ä½¿ç”¨ === å»åŒ¹é…æ•°ç»„ä¸­çš„å…ƒç´ ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var array = [&apos;abc&apos;, &apos;def&apos;, &apos;ghi&apos;,&apos;123&apos;];</span><br><span class="line">console.log(array.indexOf(&apos;def&apos;)); // 1</span><br><span class="line">console.log(array.indexOf(&apos;def&apos;,-1)); // -1 æ­¤æ—¶è¡¨ç¤ºä»æœ€åä¸€ä¸ªå…ƒç´ å¾€åæŸ¥æ‰¾,å› æ­¤æŸ¥æ‰¾å¤±è´¥è¿”å›-1</span><br><span class="line">console.log(array.indexOf(&apos;def&apos;,-4)); // 1 ç”±äº4å¤§äºæ•°ç»„é•¿åº¦,æ­¤æ—¶å°†æŸ¥æ‰¾æ•´ä¸ªæ•°ç»„,å› æ­¤è¿”å›1</span><br><span class="line">console.log(array.indexOf(123)); // -1, ç”±äºæ˜¯ä¸¥æ ¼åŒ¹é…,å› æ­¤å¹¶ä¸ä¼šåŒ¹é…åˆ°å­—ç¬¦ä¸²&apos;123&apos;</span><br></pre></td></tr></table></figure>
<p>#####lastIndexOf<br>ç•¥</p>
<p>#####includes(ES7)<br>includes() æ–¹æ³•åŸºäºES7è§„èŒƒï¼Œå®ƒç”¨æ¥åˆ¤æ–­å½“å‰æ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªæŒ‡å®šçš„å€¼ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚<br>è¯­æ³•ï¼šarr.includes(element, fromIndex=0)<br>element ä¸ºéœ€è¦æŸ¥æ‰¾çš„å…ƒç´ ã€‚<br>fromIndex è¡¨ç¤ºä»è¯¥ç´¢å¼•ä½ç½®å¼€å§‹æŸ¥æ‰¾ elementï¼Œç¼ºçœä¸º0ï¼Œå®ƒæ˜¯æ­£å‘æŸ¥æ‰¾ï¼Œå³ä»ç´¢å¼•å¤„å¾€æ•°ç»„æœ«å°¾æŸ¥æ‰¾ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var array = [0, 1, 2];</span><br><span class="line">console.log(array.includes(0)); // true</span><br><span class="line">console.log(array.includes(1)); // true</span><br><span class="line"></span><br><span class="line">[1, 2, 3].includes(3, 3);  // false</span><br><span class="line">[1, 2, 3].includes(3, -1); // true</span><br><span class="line">[1, 2, NaN].includes(NaN) // true</span><br></pre></td></tr></table></figure>
<p>####éå†æ–¹æ³•(12ä¸ª)<br>åŸºäºES6ï¼Œä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•ä¸€å…±æœ‰12ä¸ªï¼Œåˆ†åˆ«ä¸ºforEachã€everyã€someã€filterã€mapã€reduceã€reduceRight ä»¥åŠES6æ–°å¢çš„æ–¹æ³•entriesã€findã€findIndexã€keysã€valuesã€‚</p>
<p>#####entries(ES6)</p>
<p>entries() æ–¹æ³•åŸºäºES6è§„èŒƒï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„é”®å€¼å¯¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];</span><br><span class="line">var iterator = array.entries();</span><br><span class="line">console.log(iterator.next().value); // [0, &quot;a&quot;]</span><br><span class="line">console.log(iterator.next().value); // [1, &quot;b&quot;]</span><br><span class="line">console.log(iterator.next().value); // [2, &quot;c&quot;]</span><br><span class="line">console.log(iterator.next().value); // undefined, è¿­ä»£å™¨å¤„äºæ•°ç»„æœ«å°¾æ—¶, å†è¿­ä»£å°±ä¼šè¿”å›undefined</span><br></pre></td></tr></table></figure>
<p>#####find &amp; findIndex(ES6)<br>find()æ–¹æ³•åŸºäºES6è§„èŒƒï¼Œè¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿”å›undefinedã€‚<br>findIndex() æ–¹æ³•ä¹ŸåŸºäºES6è§„èŒƒï¼Œå®ƒè¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å¦åˆ™è¿”å›-1ã€‚</p>
<p>è¯­æ³•ï¼šarr.find(fn, thisArg)ï¼Œarr.findIndex(fn, thisArg)<br>æˆ‘ä»¬å‘ç°å®ƒä»¬çš„è¯­æ³•ä¸forEachç­‰ååˆ†ç›¸ä¼¼ï¼Œå…¶å®ä¸å…‰è¯­æ³•ï¼Œfindï¼ˆæˆ–findIndexï¼‰åœ¨å‚æ•°åŠå…¶ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸Šï¼Œå‡ä¸forEachä¸€è‡´ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var array = [1, 3, 5, 7, 8, 9, 10];</span><br><span class="line">function f(value, index, array)&#123;</span><br><span class="line">  return value%2==0;</span><br><span class="line">&#125;</span><br><span class="line">function f2(value, index, array)&#123;</span><br><span class="line">  return value &gt; 20;</span><br><span class="line">&#125;</span><br><span class="line">console.log(array.find(f)); // 8</span><br><span class="line">console.log(array.find(f2)); // undefined</span><br><span class="line">console.log(array.findIndex(f)); // 4</span><br><span class="line">console.log(array.findIndex(f2)); // -1</span><br></pre></td></tr></table></figure>
<p>#####keys(ES6)<br>keys() æ–¹æ³•åŸºäºES6è§„èŒƒï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ç´¢å¼•çš„è¿­ä»£å™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;abc&quot;, &quot;xyz&quot;];</span><br><span class="line">var iterator = array.keys();</span><br><span class="line">console.log(iterator.next()); // Object &#123;value: 0, done: false&#125;</span><br><span class="line">console.log(iterator.next()); // Object &#123;value: 1, done: false&#125;</span><br><span class="line">console.log(iterator.next()); // Object &#123;value: undefined, done: false&#125;</span><br></pre></td></tr></table></figure>
<p>#####values(ES6)<br>values() æ–¹æ³•åŸºäºES6è§„èŒƒï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„å€¼ã€‚å…¶ç”¨æ³•åŸºæœ¬ä¸ä¸Šè¿° entries æ–¹æ³•ä¸€è‡´ã€‚</p>
<p>(é—æ†¾çš„æ˜¯ï¼Œç°åœ¨æ²¡æœ‰æµè§ˆå™¨å®ç°äº†è¯¥æ–¹æ³•)</p>
<p>#####Symbol.iterator(ES6)<br>è¯¥æ–¹æ³•åŸºäºES6è§„èŒƒï¼ŒåŒ values æ–¹æ³•åŠŸèƒ½ç›¸åŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var array = [&quot;abc&quot;, &quot;xyz&quot;];</span><br><span class="line">var iterator = array[Symbol.iterator]();</span><br><span class="line">console.log(iterator.next().value); // abc</span><br><span class="line">console.log(iterator.next().value); // xyz</span><br></pre></td></tr></table></figure>
<p>####jså°å®ä¾‹ä¹‹æ•°ç»„æ‰å¹³åŒ–<br>ï¼Ÿ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var arr = [1, [2, [3, 4]]];</span><br><span class="line">console.log(flatten(arr)) // [1, 2, 3, 4]</span><br></pre></td></tr></table></figure>
<p>æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³• 1 åœ°æŸœ</span><br><span class="line">var arr = [1, [2, [3, 4]]];</span><br><span class="line"></span><br><span class="line">function flatten(arr) &#123;</span><br><span class="line">    var result = [];</span><br><span class="line">    for (var i = 0, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">        if (Array.isArray(arr[i])) &#123;</span><br><span class="line">            result = result.concat(flatten(arr[i]))</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            result.push(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(flatten(arr))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•2 </span><br><span class="line">var arr = [1, [2, [3, 4]]];</span><br><span class="line"></span><br><span class="line">function flatten(arr) &#123;</span><br><span class="line">    return arr.toString().split(&apos;,&apos;).map(function(item)&#123;</span><br><span class="line">        return item;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(flatten(arr))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•3</span><br><span class="line">var arr = [1, [2, [3, 4]]];</span><br><span class="line"></span><br><span class="line">function flatten(arr) &#123;</span><br><span class="line">    return arr.reduce(function(prev, next)&#123;</span><br><span class="line">        return prev.concat(Array.isArray(next) ? flatten(next) : next)</span><br><span class="line">    &#125;, [])</span><br><span class="line">&#125;</span><br><span class="line">console.log(flatten(arr))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•4</span><br><span class="line">var arr = [1, [2, [3, 4]]];</span><br><span class="line"></span><br><span class="line">function flatten(arr) &#123;</span><br><span class="line"></span><br><span class="line">    while (arr.some(item =&gt; Array.isArray(item))) &#123;</span><br><span class="line">        arr = [].concat(...arr);</span><br><span class="line">    &#125;</span><br><span class="line">    return arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(flatten(arr))</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/jashkenas/underscore/blob/master/underscore.js#L528" target="_blank" rel="noopener">underscore</a></p>
<p>###JavaScriptä¹‹æ•°ç»„å»é‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨indexOf()éå†æ•°ç»„ï¼Œå¦‚æœä¸´æ—¶æ•°ç»„æ‰¾ä¸åˆ°è¯¥å…ƒç´ ï¼Œåˆ™pushåˆ°ä¸´æ—¶æ•°ç»„ï¼Œå¦åˆ™ä¸åšå¤„ç†</span><br><span class="line">function uniqArr1(arr) &#123;</span><br><span class="line">ã€€ã€€var res = [];</span><br><span class="line"> </span><br><span class="line">ã€€ã€€for (var i = 0,len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">        if (res.indexOf(arr[i]) == -1) &#123;</span><br><span class="line">          res.push(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">åŒæ ·åˆ©ç”¨indexOf()éå†æ•°ç»„ï¼Œå¦‚æœå…ƒç´ é¦–æ¬¡å‡ºç°ä½ç½®å’Œå®ƒçš„ç´¢å¼•ç›¸ç­‰ï¼Œåˆ™è¯´æ˜ä¸æ˜¯é‡å¤å…ƒç´ ï¼Œpushåˆ°ä¸´æ—¶æ•°ç»„ï¼Œå¦åˆ™ä¸åšå¤„ç†</span><br><span class="line"></span><br><span class="line">function uniqArr2(arr) &#123;</span><br><span class="line">ã€€ã€€var res = [arr[0]];</span><br><span class="line"> </span><br><span class="line">ã€€ã€€for (var i = 1,len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€if (arr.indexOf(arr[i]) == i) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€res.push(arr[i]);</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"> </span><br><span class="line">ã€€ã€€return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥æ‰¾ç¬¬ä¸€ä¸ªindexï¼Œæ˜¯å¦ç›¸åŒindex</span><br><span class="line">function removeRepeat(arr)&#123;</span><br><span class="line">  return arr.filter(function(elem, pos) &#123;</span><br><span class="line">    return arr.indexOf(elem) == pos;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var arr = new Array(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;4&quot;,&quot;4&quot;,&quot;4&quot;,&quot;5&quot;);</span><br><span class="line">var newArr = removeRepeat(arr);</span><br><span class="line">console.log(newArr); //1,2,3,4,5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨å¯¹è±¡é”®å€¼å”¯ä¸€æ€§ï¼Œå¦‚æœå¯¹è±¡æ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™æ·»åŠ è¯¥å±æ€§ï¼ŒåŒæ—¶å°†è¯¥å…ƒç´ pushåˆ°ä¸´æ—¶æ•°ç»„</span><br><span class="line">function uniqArr3(arr) &#123;</span><br><span class="line">ã€€ã€€var obj = &#123;&#125;,</span><br><span class="line">ã€€ã€€res = [];</span><br><span class="line"> </span><br><span class="line">ã€€ã€€for (var i = 1,len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€if (!obj[arr[i]]) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€obj[arr[i]] = true;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€res.push(arr[i]);</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"> </span><br><span class="line">ã€€ã€€return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åŒæ ·åˆ©ç”¨å¯¹è±¡é”®å€¼å”¯ä¸€æ€§ï¼Œå”¯ä¸€ä¸åŒçš„åœ°æ–¹æ˜¯è¿™é‡Œä¸å†ä½¿ç”¨ä¸´æ—¶æ•°ç»„å˜é‡ï¼Œè€Œæ˜¯åˆ©ç”¨Object.keys()æ–¹æ³•å°†å»é‡åçš„ç»“æœè¿”å›</span><br><span class="line">function uniqArr4(arr) &#123;</span><br><span class="line">ã€€ã€€var obj = &#123;&#125;;</span><br><span class="line">ã€€ã€€for (var i = 1,len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€if (!obj[arr[i]]) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€obj[arr[i]] = true;</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€return Object.keys(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å…ˆå¯¹åŸæ•°ç»„è¿›è¡Œæ’åºï¼Œä¸´æ—¶æ•°ç»„å…ˆå­˜å‚¨ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹å¾ªç¯åˆ¤æ–­æ’åºåçš„åŸæ•°ç»„(arr)æ˜¯å¦ä¸ä¸´æ—¶æ•°ç»„(res)çš„ç¬¬length-1ä¸ªå…ƒç´ (å³resçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå³resæ¯æ¬¡æ–°æ·»åŠ çš„å…ƒç´ )æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ä¸ç›¸ç­‰ï¼Œåˆ™pushåˆ°resï¼Œè¿™æ ·å°±ç¡®ä¿äº†æ¯æ¬¡pushåˆ°resä¸­çš„éƒ½æ˜¯ä¸é‡å¤çš„ã€‚</span><br><span class="line">function uniqArr5(arr) &#123;</span><br><span class="line">ã€€ã€€arr.sort();</span><br><span class="line">ã€€ã€€var res = [arr[0]];</span><br><span class="line"> </span><br><span class="line">ã€€ã€€for (var i = 1,len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€if (arr[i] !== res[res.length -1]) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€res.push(arr[i]);</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">åµŒå¥—å¾ªç¯ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™æˆªæ‰åé¢çš„ï¼Œè¿™é‡Œè¦æ³¨æ„spliceä¼šå½±å“åˆ°åŸæ•°ç»„ï¼Œæ‰€ä»¥è¿™é‡Œé‡æ–°è®¡ç®—äº†lenå€¼å’Œjå€¼ã€‚</span><br><span class="line">unction uniqArr6(arr) &#123;</span><br><span class="line">ã€€ã€€var len = arr.length;</span><br><span class="line"> </span><br><span class="line">ã€€ã€€for (var i = 0; i &lt; len; i++) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€for (var j = i + 1; j &lt; len; j++) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€if (arr[i] === arr[j]) &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€arr.splice(j, 1);</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€len = arr.length;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€j--;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"> </span><br><span class="line">ã€€ã€€return arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ES6æ–°çš„æ•°æ®ç»“æ„setï¼Œç±»ä¼¼æ•°ç»„ï¼Œä½†æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯ä»¥åšåˆ°æ•°ç»„å»é‡</span><br><span class="line"></span><br><span class="line">function uniqArr7(arr) &#123;</span><br><span class="line">ã€€ã€€var res = new Set(arr);</span><br><span class="line">ã€€ã€€return [...res];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function unique7 (arr) &#123;</span><br><span class="line">  return Array.from(new Set(arr))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// ES6</span><br><span class="line">function unique8 (arr) &#123;</span><br><span class="line">  const seen = new Map()</span><br><span class="line">  return arr.filter((a) =&gt; !seen.has(a) &amp;&amp; seen.set(a, 1))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2018/02/27/å…³äºæ•°ç»„/" data-id="cka3kmlda001j7zo72y42xtrs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jséšæœºæ•°ä¸ç®€å•æŠ½å¥–" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/10/jséšæœºæ•°ä¸ç®€å•æŠ½å¥–/" class="article-date">
  <time datetime="2017-12-10T02:23:57.000Z" itemprop="datePublished">2017-12-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/10/jséšæœºæ•°ä¸ç®€å•æŠ½å¥–/">jséšæœºæ•°ä¸ç®€å•æŠ½å¥–</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#####<br>éšæœºæ•°åˆ†ä¸ºä¸‰ç§ï¼šçœŸéšæœºæ•°ã€å‡†éšæœºæ•°ã€ä¼ªéšæœºæ•°ã€‚<br>çœŸéšæœºæ•°æ˜¯å±äºå¤§è‡ªç„¶çš„ï¼ŒçœŸéšæœºæ•°åªèƒ½é€šè¿‡éšæœºçš„ç‰©ç†è¿‡ç¨‹æ¥è·å–ï¼Œå®é™…ä¸­æ˜¯å¾ˆéš¾çš„ã€‚<br>å‡†éšæœºæ•°æ¥è‡ªäºä¸¥æ ¼çš„æ•°å­¦æ–¹æ³•ï¼Œç†è®ºä¸Šå¯è¡Œï¼Œä½†å®é™…ä¸Šä¸å¯è¡Œã€‚</p>
<p>ä¼ªéšæœºæ•°ï¼Œå°±æ˜¯å‡çš„éšæœºæ•°ã€‚å› ä¸ºå®ƒæ˜¯æ ¹æ®æŸç§å·²çŸ¥çš„æ–¹æ³•è·å–éšæœºæ•°ï¼Œæœ¬è´¨ä¸Šå·²ç»å»é™¤äº†çœŸæ­£éšæœºçš„å¯èƒ½ã€‚è¿™ç§æ–¹æ³•ä¸€æ—¦é‡å¤ï¼Œåˆ™è·å–åˆ°çš„éšæœºæ•°ä¹Ÿä¼šé‡å¤ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ˜¯ä¼ªéšæœºæ•°å‘¢ï¼Ÿå› ä¸ºé€šè¿‡è¿™ç§æ–¹å¼å¾—åˆ°çš„â€œéšæœºæ•°â€éƒ½æ˜¯ç³»ç»Ÿæ ¹æ®å…¬å¼ç®—å‡ºæ¥çš„ï¼æ—¢ç„¶æ˜¯ç®—å‡ºæ¥çš„ï¼Œé‚£ä¹ˆåªè¦è¾“å…¥çš„å‚æ•°ä¸€è‡´ï¼Œé‚£ä¹ˆæ¯æ¬¡è·å¾—çš„éšæœºæ•°å°±æ˜¯åŒä¸€ä¸ªã€‚è¾“å…¥çš„å‚æ•°æˆ‘ä»¬å«åšseedã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç¨‹åºè®¾è®¡è€…ä½¿ç”¨äº†ä¸€ä¸ªé¢„å…ˆç¡®å®šå¥½çš„seedæ¥ç”Ÿæˆéšæœºæ•°ï¼Œå¦‚æœæŠ½100æ¬¡å¥–ï¼Œé‚£ä¹ˆè¿™100æ¬¡ä¸­å¥–çš„éƒ½ä¼šæ˜¯åŒä¸€ä¸ªäººï¼Œæˆ–è€…åŒä¸€æ‰¹äººã€‚æ›´æœ‰ç”šè€…ï¼Œè™½ç„¶æ¯æ¬¡ä½¿ç”¨çš„seedçœ‹ä¼¼ä¸åŒï¼Œä½†è¿™æ‰¹seedä¼šè®©ç‰¹å®šçš„ä¸€éƒ¨åˆ†äººä¸­å¥–æ¦‚ç‡æ›´å¤§ï¼</p>
<p>çœŸéšæœºæ•°æ˜¯ç”µè„‘é€šè¿‡å¯¹ä¸€äº›æ²¡æœ‰è§„å¾‹çš„è‡ªç„¶ç°è±¡é‡åŒ–åå¾—åˆ°çš„ï¼Œæ¯”å¦‚çƒ­åŠ›å­¦å™ªå£°ã€é‡å­ç°è±¡ç­‰ã€‚è·å–è¿™äº›çœŸéšæœºæ•°çš„è·å–ä»£ä»·æ˜¾ç„¶æ¯”ç”¨æ—¶é—´åšä¸ªseedé«˜å¤šäº†ã€‚å¦‚æœå¤§å®¶è§‰å¾—å¹´ä¼šæŠ½å¥–çš„ç®—æ³•æœ‰å¿…è¦ä½¿ç”¨çœŸéšæœºæ•°ï¼Œä¹Ÿæœ‰åŠæ³•åšåˆ°ï¼Œrandom.orgè¿™ä¸ªç½‘ç«™å°±æä¾›äº†ä¸€ç³»åˆ—é€šè¿‡â€œå¤§æ°”å™ªå£°â€è·å–éšæœºæ•°åºåˆ—çš„åœ¨çº¿APIï¼Œé€šè¿‡è¿™äº›APIè·å–çš„éšæœºæ•°åºåˆ—éƒ½æ˜¯çœŸéšæœºæ•°ã€‚</p>
<p>å¦‚ä½•äº§ç”Ÿéšæœºæ•°ï¼šäº§ç”Ÿéšæœºæ•°çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä»€ä¹ˆæ–æ³¢é‚£å¥‘æ³•ã€çº¿æ€§åŒä½™æ³•ã€æ¢…æ£®æ—‹è½¬ç®—æ³•Mersenne twisterç­‰ã€‚</p>
<p>ä¸‹é¢ç®€å•ä»‹ç»ä¸‹ã€‚</p>
<p>è¯´åˆ°js çš„éšæœºæ•°ï¼Œä¸å¾—ä¸æçš„å°±æ˜¯Math.randomè¿™ä¸ªæ–¹æ³•äº†ã€‚<br>è¯¥æ–¹æ³•å¯è¿”å›ä»‹äº [0 ~ 1) ä¹‹é—´çš„ä¸€ä¸ªéšæœºæ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var r = Math.random(); //ç”Ÿæˆ0-1 çš„éšæœºæ•°ã€‚</span><br></pre></td></tr></table></figure></p>
<p>è¿˜æœ‰å…¶ä»–ç®€å•çš„æ–¹æ³•ï¼Œç®€å•å›é¡¾ä¸€ä¸‹ã€‚<br>Math.ceil  //å¯¹ä¸€ä¸ªæ•°è¿›è¡Œä¸Šå–æ•´ è¿”å›å€¼ï¼šè¿”å›å¤§äºæˆ–ç­‰äºxï¼Œå¹¶ä¸”ä¸ä¹‹æœ€æ¥è¿‘çš„æ•´æ•°ã€‚<br>æ³¨ï¼šå¦‚æœxæ˜¯æ­£æ•°ï¼Œåˆ™æŠŠå°æ•°â€œå…¥â€ï¼›å¦‚æœxæ˜¯è´Ÿæ•°ï¼Œåˆ™æŠŠå°æ•°â€œèˆâ€ã€‚</p>
<p>Math.floor<br>å¯¹ä¸€ä¸ªæ•°è¿›è¡Œä¸‹å–æ•´ã€‚ è¿”å›å€¼ï¼šè¿”å›å°äºæˆ–ç­‰äºxï¼Œå¹¶ä¸”ä¸ä¹‹æœ€æ¥è¿‘çš„æ•´æ•°ã€‚<br>æ³¨ï¼šå¦‚æœxæ˜¯æ­£æ•°ï¼Œåˆ™æŠŠå°æ•°â€œèˆâ€ï¼›å¦‚æœxæ˜¯è´Ÿæ•°ï¼Œåˆ™æŠŠå°æ•°â€œå…¥â€ã€‚</p>
<p>Math.round  å››èˆäº”å…¥å–æ•´ã€‚</p>
<p>é—®é¢˜: æƒ³æ±‚è§£1-xçš„éšæœºæ•°<br>var x = 100;<br>// 1.0-xä¹‹é—´çš„éšæœºæ•°ï¼š<br>Math.round(Math.random()*x);</p>
<p>é—®é¢˜ï¼šxè‡³yä¹‹é—´çš„éšæœºæ•°<br>var x = 100;<br>var y = 200;<br>Math.round(Math.random()*(y-x)+x);</p>
<p>è¿˜å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ç§æ–¹å¼äº§ç”Ÿï¼š<br>var r = +new Date();<br>var r = (new Date()-0) % 15;</p>
<p>é—®é¢˜ï¼šéšæœºäº§ç”Ÿå…­ä½æ•°å­—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var Num = &quot;&quot;; </span><br><span class="line">for(var i=0;i&lt;6;i++)&#123; </span><br><span class="line">    Num+= Math.floor(Math.random()*10); </span><br><span class="line">&#125;</span><br><span class="line">console.log(Num);</span><br></pre></td></tr></table></figure></p>
<p>é—®é¢˜ï¼šéšæœºçš„token ç”Ÿæˆæ–¹å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var r = Math.random().toString(36).slice(2); </span><br><span class="line">//æˆ–è€…</span><br><span class="line">var r = Math.random().toString(36).slice(7);</span><br><span class="line">console.log(r);</span><br></pre></td></tr></table></figure></p>
<p>butï¼Œè¿™æ ·æœ‰ä¸ªé—®é¢˜ã€‚<br>for(var i = 0; i&lt; 20; i++){<br>    console.log(Math.random().toString(36).slice(2));<br>}</p>
<p>for(var i = 0; i&lt; 20; i++){<br>    console.log((+new Date()).toString(36));<br>}</p>
<p>é—®é¢˜ï¼šå¦‚æœæƒ³ä¸è¦æ•°å­—å’Œå­—æ¯å‘¢ï¼Ÿ<br>å½“ç„¶æ˜¯æ­£åˆ™äº†ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var r = Math.random().toString(36).replace(/[^a-z]+/g, &apos;&apos;);</span><br><span class="line">//æˆ–è€…è¿™æ ·</span><br><span class="line">var r = Math.random().toString(36).slice(2).replace(/\d/g, &apos;&apos;);</span><br></pre></td></tr></table></figure>
<p>é—®é¢˜ï¼šä»æŒ‡å®šçš„å­—ç¬¦ä¸­ï¼ŒæŠ½å–æŸä¸€éƒ¨åˆ†å½“åšéšæœº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Array(20).fill().map(function () &#123;</span><br><span class="line">    return (function (str) &#123;</span><br><span class="line">        return str.charAt(Math.floor(Math.random() * str.length));</span><br><span class="line">    &#125;(&apos;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&apos;));</span><br><span class="line"></span><br><span class="line">&#125;).join(&apos;&apos;);</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function rand(length, current) &#123;</span><br><span class="line">    var str = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz&quot;;</span><br><span class="line">    current = current ? current : &apos;&apos;;</span><br><span class="line"></span><br><span class="line">    return length ? rand(--length, str.charAt(Math.floor(Math.random() * 60)) + current) : current;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å½“ç„¶ä¸Šé¢çš„åŠæ³•bijiaolow</p>
<p>è¿˜æœ‰ä¸‹é¢è¿™ç§åŠæ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">** randomWord äº§ç”Ÿä»»æ„é•¿åº¦éšæœºå­—æ¯æ•°å­—ç»„åˆ</span><br><span class="line">** randomFlag-æ˜¯å¦ä»»æ„é•¿åº¦ min-ä»»æ„é•¿åº¦æœ€å°ä½[å›ºå®šä½æ•°] max-ä»»æ„é•¿åº¦æœ€å¤§ä½</span><br><span class="line">*/</span><br><span class="line"> </span><br><span class="line">function randomWord(randomFlag, min, max)&#123;</span><br><span class="line">    var str = &quot;&quot;,</span><br><span class="line">        range = min,</span><br><span class="line">        arr = [&apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos;, &apos;4&apos;, &apos;5&apos;, &apos;6&apos;, &apos;7&apos;, &apos;8&apos;, &apos;9&apos;, &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;, &apos;h&apos;, &apos;i&apos;, &apos;j&apos;, &apos;k&apos;, &apos;l&apos;, &apos;m&apos;, &apos;n&apos;, &apos;o&apos;, &apos;p&apos;, &apos;q&apos;, &apos;r&apos;, &apos;s&apos;, &apos;t&apos;, &apos;u&apos;, &apos;v&apos;, &apos;w&apos;, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;, &apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;, &apos;E&apos;, &apos;F&apos;, &apos;G&apos;, &apos;H&apos;, &apos;I&apos;, &apos;J&apos;, &apos;K&apos;, &apos;L&apos;, &apos;M&apos;, &apos;N&apos;, &apos;O&apos;, &apos;P&apos;, &apos;Q&apos;, &apos;R&apos;, &apos;S&apos;, &apos;T&apos;, &apos;U&apos;, &apos;V&apos;, &apos;W&apos;, &apos;X&apos;, &apos;Y&apos;, &apos;Z&apos;];</span><br><span class="line"> </span><br><span class="line">    // éšæœºäº§ç”Ÿ</span><br><span class="line">    if(randomFlag)&#123;</span><br><span class="line">        range = Math.round(Math.random() * (max-min)) + min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for(var i=0; i&lt;range; i++)&#123;</span><br><span class="line">        pos = Math.round(Math.random() * (arr.length-1));</span><br><span class="line">        str += arr[pos];</span><br><span class="line">    &#125;</span><br><span class="line">    return str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var str = randomWord(true, 3, 32); //ç”Ÿæˆ3-32ä½éšæœºä¸²</span><br><span class="line">console.log(str)</span><br><span class="line">randomWord(false, 43); //ç”Ÿæˆ43ä½éšæœºä¸²</span><br></pre></td></tr></table></figure></p>
<p>é—®é¢˜ï¼šäº§ç”Ÿlené•¿åº¦çš„å­—ç¬¦ä¸²<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function generateRandomAlphaNum(len) &#123;</span><br><span class="line">    var rdmString = &quot;&quot;;</span><br><span class="line">    for (; rdmString.length &lt; len; rdmString += Math.random().toString(36).substr(2));</span><br><span class="line"></span><br><span class="line">    return rdmString.substr(0, len);</span><br><span class="line">&#125;</span><br><span class="line">var str = generateRandomAlphaNum(5);</span><br><span class="line">// console.log(str);</span><br></pre></td></tr></table></figure></p>
<p>çœ‹ä¸‹ç”ŸæˆGUIDçš„å‡½æ•°<br>ä»€ä¹ˆæ˜¯GUIDï¼š<br>å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGUIDï¼ŒGlobally Unique Identifierï¼‰ä¹Ÿç§°ä½œ UUID(Universally Unique IDentifier) ã€‚</p>
<p>GUIDæ˜¯ä¸€ç§ç”±ç®—æ³•ç”Ÿæˆçš„äºŒè¿›åˆ¶é•¿åº¦ä¸º128ä½çš„æ•°å­—æ ‡è¯†ç¬¦ã€‚GUID çš„æ ¼å¼ä¸ºâ€œxxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxâ€ï¼Œå…¶ä¸­çš„ x æ˜¯ 0-9 æˆ– a-f èŒƒå›´å†…çš„ä¸€ä¸ª32ä½åå…­è¿›åˆ¶æ•°ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œä»»ä½•è®¡ç®—æœºå’Œè®¡ç®—æœºé›†ç¾¤éƒ½ä¸ä¼šç”Ÿæˆä¸¤ä¸ªç›¸åŒçš„GUIDã€‚</p>
<p>ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function S4() &#123;</span><br><span class="line">    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);</span><br><span class="line">&#125;</span><br><span class="line">function NewGuid() &#123;</span><br><span class="line">    return (S4() + S4() + &quot;-&quot; + S4() + &quot;-&quot; + S4() + &quot;-&quot; + S4() + &quot;-&quot; + S4() + S4() + S4());</span><br><span class="line">&#125;</span><br><span class="line">console.log(NewGuid());</span><br></pre></td></tr></table></figure></p>
<p>é—®é¢˜ï¼šå¦‚æœæƒ³éšæœºä¸­æ–‡å‘¢ï¼Ÿ<br>æˆ‘ä»¬çŸ¥é“ï¼Œä¸­æ–‡å­—ç¬¦çš„èŒƒå›´æ˜¯[\u4e00-\u9fa5]</p>
<p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸å†™çš„åˆ¤æ–­æ˜¯å¦ä¸­æ–‡çš„æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (/^[\u4E00-\u9FA5]+$/.test(content)) &#123;</span><br><span class="line">    console.log(&apos;is chinese&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æˆ‘ä»¬è½¬åŒ–ä¸€ä¸‹ä¸º10è¿›åˆ¶æ•°å­—</span><br><span class="line">parseInt(&quot;4E00&quot;,16) //19968</span><br><span class="line">parseInt(&quot;9FA5&quot;,16) //40869</span><br><span class="line"></span><br><span class="line">40869-19968 = 20901 å¯ä»¥æœ‰è¿™ä¹ˆå¤šäº†ï¼ï¼ï¼ åŸºæœ¬ä¸Šå¤Ÿç”¨</span><br><span class="line"></span><br><span class="line">randomHz = function()&#123;</span><br><span class="line">    eval( &quot;var word=&quot; +  &apos;&quot;\\u&apos; + (Math.round(Math.random() * 20901) + 19968).toString(16)+&apos;&quot;&apos;);</span><br><span class="line">    return word;</span><br><span class="line">&#125;</span><br><span class="line">for(i=0;i&lt;100;i++)&#123;</span><br><span class="line">    console.log(randomHz());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é™„ï¼š<br>ä¸‹é¢ä¸Šå‡ ä¸ªéšæœºæŠ½å¥–çš„å°å®ä¾‹ï¼Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">let arr  = [</span><br><span class="line">    &#123;</span><br><span class="line">        name: &apos;å¥–å“1&apos;,</span><br><span class="line">        per: 10,</span><br><span class="line">        end: 0,</span><br><span class="line">        times: 0</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        name: &apos;å¥–å“2&apos;,</span><br><span class="line">        per: 20,</span><br><span class="line">        times: 0</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        name: &apos;å¥–å“3&apos;,</span><br><span class="line">        per: 30,</span><br><span class="line">        times: 0</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        name:&apos;è°¢è°¢&apos;,</span><br><span class="line">        per: 50,</span><br><span class="line">        times: 0</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">let len = 0;</span><br><span class="line">arr.forEach((item, index)=&gt;&#123;</span><br><span class="line">    len += item.per;</span><br><span class="line">    item.end =len;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function draw()&#123;</span><br><span class="line">    let random = parseInt(Math.random() * len);</span><br><span class="line">    for(let i = 0 ; i&lt; arr.length; i++)&#123;</span><br><span class="line">        if(random &lt; arr[i].end)&#123;</span><br><span class="line">            // console.log(arr[i].name);</span><br><span class="line">            arr[i].times ++ ;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// draw();</span><br><span class="line"></span><br><span class="line">for(var j = 0; j &lt; 100000; j++)&#123;</span><br><span class="line">    draw();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr.forEach(function(item)&#123;</span><br><span class="line">    console.log(item.name, item.times);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var gifts = [</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;name&quot;:&quot;å¥–å“1&quot;,</span><br><span class="line">        &quot;prop&quot;:5, </span><br><span class="line">        &quot;times&quot;: 0</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        &quot;name&quot;:&quot;å¥–å“2&quot;,</span><br><span class="line">        &quot;prop&quot;:10,</span><br><span class="line">        &quot;times&quot;: 0</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        &quot;name&quot;:&quot;å¥–å“3&quot;,</span><br><span class="line">        &quot;prop&quot;:40,</span><br><span class="line">        &quot;times&quot;: 0</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        &quot;name&quot;:&quot;å¥–å“4&quot;,</span><br><span class="line">        &quot;prop&quot;: 45,</span><br><span class="line">        &quot;times&quot;: 0</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line">//æŠ½å¥–ç»å…¸ç®—æ³•</span><br><span class="line">function getResult(arr)&#123;</span><br><span class="line">    var leng = 0;</span><br><span class="line">    for(var i=0; i&lt;arr.length; i++)&#123;</span><br><span class="line">        leng+=arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    for(var i=0; i&lt;arr.length; i++)&#123;</span><br><span class="line">        if(parseInt(Math.random()*leng)&lt;arr[i])&#123;</span><br><span class="line">            gifts[i].times ++;</span><br><span class="line">            return i;</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            leng -= arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var gArr = [];</span><br><span class="line">for(var i=0; i&lt; gifts.length; i++)&#123;</span><br><span class="line">    gArr.push(gifts[i][&apos;prop&apos;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for(var i =0 ; i&lt; 100000; i++)&#123;</span><br><span class="line">    getResult(gArr);</span><br><span class="line">&#125; </span><br><span class="line">gifts.forEach(function(item)&#123;</span><br><span class="line">    console.log(item.times);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// console.log(gifts[getResult(gArr)][&apos;name&apos;]);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">function draw(n = 1)&#123;</span><br><span class="line">    let cards = Array(20).fill().map((_, i)=&gt;i+1);</span><br><span class="line">    let ret = [];</span><br><span class="line">    for(let i = 0; i &lt; n; i++)&#123;</span><br><span class="line">        let idx = Math.floor(cards.length * Math.random());</span><br><span class="line">        ret.push(...cards.splice(idx, 1));</span><br><span class="line">    &#125;</span><br><span class="line">    return ret;</span><br><span class="line">&#125;</span><br><span class="line">console.log(draw(5));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function draw2(amount, n = 1)&#123;</span><br><span class="line">    const cards = Array(amount).fill().map((_, i)=&gt;i+1);</span><br><span class="line"></span><br><span class="line">    for(let i = amount - 1; i &gt;= 0; i--)&#123;</span><br><span class="line">        let rand = Math.floor((i + 1) * Math.random());</span><br><span class="line">        [cards[rand], cards[i]] = [cards[i], cards[rand]];</span><br><span class="line">    &#125;</span><br><span class="line">    return cards.slice(0, n);</span><br><span class="line">&#125;</span><br><span class="line">console.log(draw2(20, 5));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//-----------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">function * draw3(amount)&#123;</span><br><span class="line">    const cards = Array(amount).fill().map((_,i)=&gt;i+1);</span><br><span class="line">    for(let i = amount - 1; i &gt;= 0; i--)&#123;</span><br><span class="line">        let rand = Math.floor((i + 1) * Math.random());</span><br><span class="line">        [cards[rand], cards[i]] =  [cards[i], cards[rand]];</span><br><span class="line">        yield cards[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">var drawer = draw3(20);</span><br><span class="line">console.log(Array(5).fill().map(()=&gt;drawer.next().value));</span><br><span class="line"></span><br><span class="line">//------------------------------------------------</span><br><span class="line"></span><br><span class="line">//draw4</span><br><span class="line">function draw4(list = [], number = 0) &#123;</span><br><span class="line">    list = list.concat()</span><br><span class="line">    let result = []</span><br><span class="line">    while (number--) &#123;</span><br><span class="line">        result.push(list.splice(Math.floor(Math.random()*list.length), 1)[0]);</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line">console.log(draw4([1,2,3,4,5,6,7,8,9,10], 5));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//------------------------------------------------</span><br><span class="line"></span><br><span class="line">var arr = Array(20).join(&apos;,&apos;).replace(/\,/g, function(a, b, arr)&#123;</span><br><span class="line">    //a ï¼šå…ƒç´ ï¼Œbï¼šä¸‹æ ‡ï¼Œc:æ•°ç»„</span><br><span class="line">    var n = +b + 1;</span><br><span class="line">    var m = n + (n == arr.length ? &apos;&apos;: &apos;.&apos;);</span><br><span class="line"></span><br><span class="line">    return m;</span><br><span class="line">&#125;).split(&apos;.&apos;);</span><br><span class="line"></span><br><span class="line">function draw5()&#123;</span><br><span class="line">    var rst = function() &#123;</span><br><span class="line">        var r = Math.floor(Math.random() * arr.length);</span><br><span class="line">        return arr.splice(r, 1);</span><br><span class="line">    &#125;;</span><br><span class="line">    return rst;</span><br><span class="line">&#125;</span><br><span class="line">console.log(draw5()(), draw5()(), draw5()(), draw5()(), draw5()());</span><br></pre></td></tr></table></figure>
<div><br>å‚è§ï¼š <a href="https://aotu.io/notes/2016/04/14/math-random/" target="_blank" rel="noopener">https://aotu.io/notes/2016/04/14/math-random/&lt;/&gt;<br></a></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://swingboy.github.io/2017/12/10/jséšæœºæ•°ä¸ç®€å•æŠ½å¥–/" data-id="cka3kmlcv000v7zo7rqhtjgdt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; ä¸Šä¸€é¡µ</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">ä¸‹ä¸€é¡µ &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/éšç¬”/">éšç¬”</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/æŠ€æœ¯/" style="font-size: 20px;">æŠ€æœ¯</a> <a href="/tags/éšç¬”/" style="font-size: 10px;">éšç¬”</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">ä¸€æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">åäºŒæœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">ä¸‰æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">åä¸€æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">å…«æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">ä¸ƒæœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">å…­æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">å››æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">ä¸‰æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">äºŒæœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">åäºŒæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">åæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">ä¸ƒæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">åä¸€æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">å…­æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">äº”æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">å››æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">äºŒæœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">åæœˆ 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/24/reactæ€§èƒ½ä¼˜åŒ–/">reactæ€§èƒ½ä¼˜åŒ–</a>
          </li>
        
          <li>
            <a href="/2019/12/10/å…³äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›äº‹/">å…³äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›äº‹</a>
          </li>
        
          <li>
            <a href="/2019/03/29/webpackåŸç†/">webpackåŸç†</a>
          </li>
        
          <li>
            <a href="/2019/03/29/webpackPlugin/">webpackPlugin</a>
          </li>
        
          <li>
            <a href="/2019/03/29/webpackLoader/">webpackLoader</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 ç«æŸ´äºº<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>